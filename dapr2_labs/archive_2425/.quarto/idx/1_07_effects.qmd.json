{"title":"Effects Coding","markdown":{"yaml":{"title":"Effects Coding","link-citations":true,"params":{"SHOW_SOLS":true,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"headingText":"<i class=\"fa fa-graduation-cap\"></i> Learning Objectives","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nsource('assets/setup.R')\n\nset.seed(3)\n\nlibrary(DT)\nlibrary(pander)\nlibrary(sjPlot)\nlibrary(tidyverse)\n\n```\n\n:::lo\n\nAt the end of this lab, you will:\n\n1. Understand how to specify sum-to-zero coding\n2. Interpret the output from a model using sum-to-zero coding\n3. Understand how to specify contrasts to test specific effects\n\n### <i class=\"fa fa-check-square-o fa-2\"></i> What You Need\n\n1. Be up to date with lectures\n2. Have completed [Week 7](https://uoepsy.github.io/dapr2/2425/labs/1_06_dummy.html) lab exercises\n\n### <i class=\"fab fa-r-project\"></i> Required R Packages\nRemember to load all packages within a code chunk at the start of your RMarkdown file using `library()`. If you do not have a package and need to install, do so within the console using `install.packages(\" \")`. For further guidance on installing/updating packages, see Section C [here](https://uoepsy.github.io/files/install-update-r#update-pkgs). \n\nFor this lab, you will need to load the following package(s):\n\n* **tidyverse** \n* **psych** \n* **kableExtra**\n* **emmeans**\n\n### <i class=\"fa fa-pencil-square-o\" aria-hidden=\"true\"></i> Presenting Results\nAll results should be presented following [APA guidelines](https://apastyle.apa.org/instructional-aids/numbers-statistics-guide.pdf).If you need a reminder on how to hide code, format tables/plots, etc., make sure to review the [rmd bootcamp](https://uoepsy.github.io/scs/rmd-bootcamp/).\n\nThe example write-up sections included as part of the solutions are **not perfect** - they instead should give you a good example of what information you should include and how to structure this. Note that you must **not** copy any of the write-ups included below for future reports - if you do, you will be committing plagiarism, and this type of academic misconduct is taken very seriously by the University. You can find out more [here](https://www.ed.ac.uk/academic-services/students/conduct/academic-misconduct).\n\n### <i class=\"fa fa-file\"></i> Lab Data\nYou can download the data required for this lab [here](https://uoepsy.github.io/data/RestaurantSpending.csv) or read it in via this link https://uoepsy.github.io/data/RestaurantSpending.csv\n\n:::\n\n# Study Overview\n\n> **Research Question** \n>\n> Does background music in a restaurant influence the amount of money that diners spend on their meal?\n\nA group of researchers wanted to test the claims reported in [North, Shilcock, & Hargreaves (2003)](https://doi.org/10.1177/0013916503254749) on whether background music playing in a restaurant influences the amount of money diners spent on their meal.\n\nThe group of researchers got in touch with a local restaurant and asked them to alternate silence, popular music, and classical music on successive nights over 18 days. On those nights they recorded the average spend per person for each table.\n\nIn addition to the above research question, the researchers were also interested in the following:\n\n> **Comparisons** \n>\n> + Whether having some kind of music as opposed to no music (i.e., silence), resulted in a difference in the average amount of money spent by diners on their meal.\n\n`r optbegin(\"Restaurant Spending Codebook\", olabel=FALSE, toggle=params$TOGGLE)` \n\n__Data Dictionary__\n\nThe data in `RestaurantSpending.csv` contained three attributes collected from $n=360$ participants:\n\n```{r echo=FALSE, message=FALSE, warning=FALSE}\nrest_spend <- read_csv(\"https://uoepsy.github.io/data/RestaurantSpending.csv\")\ntibble(\nvariable = names(rest_spend),\ndescription = c(\"identifier for each diner\", \"which one of three types of music was played (classical, pop, or none)\", \"average restaurant spending per person (in pounds - £)\")\n) %>% gt::gt()\n```\n\n__Preview__\n\nThe first six rows of the data are:\n\n```{r echo=FALSE, message=FALSE}\nread_csv('https://uoepsy.github.io/data/RestaurantSpending.csv') %>% head %>% gt::gt()\n```\n\n`r optend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Setup\n\n`r qbegin(\"Setup\", qlabel = FALSE)` \n\n1. Create a new RMarkdown file\n2. Load the required package(s)\n3. Read the Restaurant Spending dataset into R, assigning it to an object named `rest_spend` \n \n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r message=FALSE}\n#Loading the required package(s)\nlibrary(tidyverse)\nlibrary(psych)\nlibrary(kableExtra)\nlibrary(emmeans)\n\n#Reading in data and storing in object named 'rest_spend'\nrest_spend <- read_csv('https://uoepsy.github.io/data/RestaurantSpending.csv')\n```\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Exercises \n\n## Study & Analysis Plan Overview \n\n`r qbegin(1)`\n\nExamine the dataset, and perform any necessary and appropriate data management steps.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n- The `str()` function will return the overall structure of the dataset, this can be quite handy to look at  \n- Convert categorical variables to factors, and if needed, provide better variable names*\n- Label factors appropriately to aid with your model interpretations if required*    \n- Check that the dataset is complete (i.e., are there any `NA` values?). We can check this using `is.na()`  \n- Are scores within possible ranges (e.g., if we recorded people's age, it would be impossible to have someone aged -31!)  \n\n*See the [Overview (numeric outcomes & categorical predictors) flashcard](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#numeric-outcomes-categorical-predictors).\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nLet's have a look at the data to see what we're working with:\n```{r}\n#first look at dataset structure\nstr(rest_spend)\n\n#now lets look at top 6 rows (or the head) of the dataset\nhead(rest_spend)\n\n#check for NAs - there are none - all FALSE\ntable(is.na(rest_spend))\n```\n\nLet's start with the music 'type' variable. This should be coded as factor (`<fctr>`), but can see from above it is currently coded as a character (`<chr>`). Let's fix this, and rename 'type' to 'music' and remove the word 'music' form the labels of the levels of the factor to avoid repetition whilst we're at it:\n\n```{r}\nrest_spend <- rest_spend %>%\n    mutate(\n        type = factor(type, \n                           levels = c(\"No Music\", \"Pop Music\", \"Classical Music\"),\n                           labels = c(\"None\", \"Pop\", \"Classical\"))) %>%\n        rename(music = type)\n```\n\nNext, let's look at the 'amount' variable. Here we want to check for impossible values - i.e., cannot have a negative £ per head.\n\n```{r}\n# all looks ok - min and max both positive values\ndescribe(rest_spend$amount)\n```\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\nAll participant data was complete (no missing values), with restaurant spending per person within possible ranges. Music type was coded as a factor with three levels (none, pop, and classical).\n\n:::\n\n`r solend()`\n\n<br>\n\n`r qbegin(2)`\n\nProvide a brief overview of the study design and data, before detailing your analysis plan to address the research question.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\n- Give the reader some background on the context of the study\n- State what type of analysis you will conduct in order to address the research question\n- Specify the model to be fitted to address the research question (note that you will need to specify the reference level of your categorical variable)\n- Specify your chosen significance ($\\alpha$) level\n- State your hypotheses\n\nMuch of the information required can be found in the [Study Overview] codebook. The [statistical models](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#statistical-models) flashcards may also be useful to refer to. \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nThe `rest_spend` dataset contained information on 360 hypothetical participants who took part in an experiment examining the effect of music on customer spending in a restaurant setting. Using a between-subjects design, the researchers had one of three types of music - classical, pop, or silence - played in a restaurant over 18 successive evenings. As well as recording the type of music played during the meal, the researchers also recorded the average spend per person (in £). \n\nAll participant data was complete (no missing values), with restaurant spending per person within possible ranges. Music type was coded as a factor with three levels (none, pop, and classical).\n\nBoxplots will be used to visualise the associations among spend per person and background music conditions. To address the research question of whether spend per person differs by background music condition, we can specify our model and coding scheme as follows:\n\n$$\n\\text{Restaurant Spending} = \\beta_0 + \\beta_1 \\cdot \\text{Effect Level 1} + \\beta_2 \\cdot \\text{Effect Level 2} + \\epsilon\n$$\n\nwhere:\n\n$$\n\\text{Effect Level 1} = \\begin{cases}\n1  & \\text{if observation is from category 1} \\\\\n0  & \\text{if observation is from category 2} \\\\\n-1 & \\text{otherwise}\n\\end{cases}\n$$\n\n$$\n\\text{Effect Level 2} = \\begin{cases}\n0  & \\text{if observation is from category 1} \\\\\n1  & \\text{if observation is from category 2} \\\\\n-1 & \\text{otherwise}\n\\end{cases}\n$$\n\nSchematically:\n\n$$\n\\begin{matrix}\n\\textbf{Level}           & \\textbf{Effect Level 1} & \\textbf{Effect Level 2} \\\\\n\\hline\n\\text{None}              & 1   & 0    \\\\\n\\text{Pop}               & 0   & 1    \\\\\n\\text{Classical}         & -1  & -1\n\\end{matrix}\n$$\n\nEffects will be considered statistically significant at $\\alpha=.05$\n\nOur hypotheses are:\n\n$H_0:$ All $\\beta_j = 0$ (for $j = 1, 2$)\n\nThere are no differences in average spend per person based on background music conditions.\n\n$H_1:$ At least one $\\beta_j \\neq  0$ (for $j = 1, 2$)\n\nThere are differences in average spend per person based on background music conditions. \n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Descriptive Statistics & Visualisations\n\n`r qbegin(3)`\n\nProvide a table of descriptive statistics and visualise your data.\n\nRemember to interpret your plot in the context of the study (i.e., comment on any observed differences among treatment groups). \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nReview the many ways to numerically and visually explore your data by reading over the [data exploration flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#data-exploration).\n\nFor examples, see flashcards on [descriptives statistics tables - categorical and numeric values examples](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#data-exploration) and [data visualisation - bivariate examples](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#visual-exploration), paying particular attention to the type of data that you're working with. \n\nA nice additional step you could take with your data visialisation would be to add a line representing the grand mean (the mean of all the observations). You can do this by specifying `geom_hline()`. Within this argument, you will need to specify where the horizontal line should cut the y-axis via `yintercept = `. You might want to specify line: type (via `lty = `), width (via `lwd = `), and colour (via `colour = `). Make sure to comment on any observed differences among the conditions in comparison to the grand mean.\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n::: {.panel-tabset}\n\n## Numeric\n\nDescriptive statistics presented in a well formatted table, grouped by music condition:\n\n```{r message=FALSE, warning=FALSE}\n#| label: tbl-music-descript\n#| tbl-cap: Restaurant Spending & Music Type Descriptive Statistics\nrest_spend %>% \n            group_by(music) %>%\n            summarise(n = n(),\n                      Mean = mean(amount),\n                      SD = sd(amount),\n                      Min = min(amount),\n                      Max = max(amount)) %>% \n            kable(caption = \"Restaurant Spending & Music Type Descriptive Statistics\", digits = 2) %>%\n            kable_styling()\n```\n\n## Visual \n\nSince we have a continuous outcome and a categorical predictor - a boxplot would be most appropriate for visualisations:\n\n```{r}\n#| label: fig-music-desc\n#| fig-cap: \"Associations between Restaurant Spending and Music Type\"\nggplot(data = rest_spend, aes(x = music, y = amount, fill = music)) +\n  geom_boxplot() +\n    geom_hline(yintercept = mean(rest_spend$amount), lty = 2, lwd = 1, colour = \"darkgrey\") +\n  labs(x = 'Background Music Type', y = 'Restaurant Spending (in GBP)')\n```\n\n:::\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\n+ There are three types of music groups ($g = 3$), where there is one group for each music type: “Classical,” “None,” “Pop\". Each group has 120 observations. \n+ It seems that customers in the None and Pop music conditions had a similar average restaurant spending\n+ The average restaurant spending seems to be higher for those who had in the Classical music condition in comparison to customers in both the None and Pop music type conditions. \n:::\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Model Fitting & Interpretation \n\n`r qbegin(4)`\n\nSet the sum to zero constraint for the factor of background music.\n\nFit the specified model, and assign it the name \"mdl_stz\".\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nWe can switch between side-constraints using the following code:\n\n```{r, eval = FALSE}\n#use dummy coding\ncontrasts(rest_spend$music) <- \"contr.treatment\"\n\n#use sum-to-zero coding\ncontrasts(rest_spend$music) <- \"contr.sum\"\n```\n\nFor more information, see the [dummy vs effects coding flashcard](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#numeric-outcomes-categorical-predictors).\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n::: {.panel-tabset}\n\n## Sum to Zero Constraint\n\n```{r}\ncontrasts(rest_spend$music) <- \"contr.sum\"\n\n#check coding matches our table above:\ncontrasts(rest_spend$music)\n```\n\n\n## Fit Model \n```{r}\nmdl_stz <- lm(amount ~ music, data = rest_spend)\n\n#check summary\nsummary(mdl_stz)\n```\n\n:::\n\n`r solend()`\n\n<br> \n\n`r qbegin(5)`\n\nInterpret your coefficients in the context of the study.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nRecall that under this constraint the interpretation of the coefficients becomes:\n\n- $\\beta_0$ represents the grand mean\n- $\\beta_i$ the effect due to group $i$ --- that is, the mean response in group $i$ minus the grand mean\n\nFor more information, see the [numeric outcomes & categorical predictors flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#numeric-outcomes-categorical-predictors).\n\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nLet's first map our coefficients and estimates:\n\n| Coefficient | Estimate | Relation between $\\beta$ and $\\mu$ |\n|:-:|:-:|:-:|\n| (Intercept)   |  22.7382 | $\\beta_0 = \\frac{\\mu_1 + \\mu_2 + \\mu_3}{3} = \\mu$\n| music1        | -0.5968  | $\\beta_1 = \\mu_1 - \\mu$|\n| music2        | -0.8392  | $\\beta_2 = \\mu_2 - \\mu$ |\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\n+ The estimate corresponding to `(Intercept)` contains $\\beta_0 = \\mu = 22.7382$. This value represents the grand mean of the data. The estimated average spending for customers across background music conditions is approximately £22.74.\n\n+ The next estimate corresponds to `music1` and is $\\hat \\beta_1 = -0.5968$. The difference in mean spending between `None` $(\\hat \\mu_1)$ and the grand mean $(\\hat \\mu_0)$ was estimated to be $-0.5968$. In other words, people with no music playing in the background seem to spend approximately £0.60 less than average, and spent $22.7382 + (-0.5968) = £22.14$ in total.  \n\n+ The estimate corresponding to `music2` is $\\hat \\beta_2 = -0.8392$. The difference in mean spending between `Pop` $(\\hat \\mu_2)$ and the grand mean $(\\hat \\mu_0)$ was estimated to be $-0.8392$.  In other words, customers with Pop music playing in the background seem to spend approximately £0.84 less than average, and spent $22.7382 + (-0.8392) = £21.90$ in total. \n\n+ The estimate for `music3`, representing the difference of “Classical” to the grand mean is *not shown* by `summary()`. Because of the side-constraint, we know that $\\mu_3 = \\beta_0 - (\\beta_1 + \\beta_2)$. The difference in mean spending between `Classical` and the grand mean was estimated to be $-(-0.5968 + -0.8392) = 1.436$. In other words, customers with Classical music playing in the background seem to spend approximately £1.44 more than average, and spent $22.7382 - (-0.5968 + -0.8392) = £24.17$ in total.\n\n:::\n\n`r solend()`\n\n<br>\n\n`r qbegin(6)`\n\nObtain the estimated (or predicted) group means for the “None,” “Pop,” and “Classical” background music conditions by using the `predict()` function.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nStep 1: Define a data frame via `tibble()` with a column having the same name as the factor in the fitted model (i.e., music). Then, specify all the groups (i.e., levels) for which you would like the predicted mean.\n\nStep 2: Pass the data frame to the predict function using the `newdata = ` argument. The `predict()` function will match the column named type with the predictor called type in the fitted model 'mdl_stz'.\n\nIf you're still not sure, it might be helpful to review the [predicted values flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#model-predicted-values-residuals).\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nStep 1:\n\n```{r}\nquery_groups <- tibble(music = c(\"None\", \"Pop\", \"Classical\"))\nquery_groups\n```\n\nStep 2:\n\n```{r}\npredict(mdl_stz, newdata = query_groups)\n```\n\n+ Predicted mean of \"None\" = $\\hat \\mu_\\text{None}$ = 22.14\n+ Predicted mean of \"Pop\" = $\\hat \\mu_\\text{Pop}$ = 21.90\n+ Predicted mean of \"Classical\" = $\\hat \\mu_\\text{Classical}$ = 24.17\n\nWe can see that these predicted means match our model estimates in Q5. \n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Planned Comparisons / Contrasts\n\n`r qbegin(7)`\n\nFormally state the planned comparison that the researchers were interested in as a testable hypothesis. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nSee the [manual contrasts flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#manual-contrasts). \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nRecall that the researchers were also interested in addressing the following question:\n\n> Whether having some kind of music playing (i.e., pop or classical), rather than no music (i.e., none), resulted in a difference in spending\n\nWe can specify the hypothesis as follows:\n\n$$\n\\begin{aligned}\n    \\quad H_0 &: \\mu_\\text{No Music} = \\mu_\\text{Music} \\\\\n    \\quad H_0 &: \\mu_\\text{None} = \\frac{1}{2} (\\mu_\\text{Pop} + \\mu_\\text{Classical}) \\\\\n\\\\\n    \\quad H_1 &: \\mu_\\text{No Music} \\neq \\mu_\\text{Music} \\\\\n    \\quad H_1 &: \\mu_\\text{No Music} \\neq \\frac{1}{2} (\\mu_\\text{Pop} + \\mu_\\text{Classical}) \\\\\n\\\\ \n\\end{aligned}\n$$\n\n`r solend()`\n\n<br> \n\n`r qbegin(8)`\n\nAfter checking the levels of the factor `music`, use `emmeans()` to obtain the estimated treatment means and uncertainties for your factor. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nSee the [manual contrasts flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#manual-contrasts). \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\nlevels(rest_spend$music)\n```\n\nUse the `emmeans()` to get the estimated means of our groups:\n\n```{r}\nmusic_mean <- emmeans(mdl_stz, ~ music)\nmusic_mean\nplot(music_mean)\n```\n\n`r solend()`\n\n<br>\n\n`r qbegin(9)`\n\nSpecify the coefficients of the comparisons and run the contrast analysis, obtaining 95% confidence intervals. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nSee the [manual contrasts flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#manual-contrasts).\n\nRemember that ordering matters here - look again at the output of `levels(rest_spend$music)` as this will help you when assigning your weights. \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nAs shown above via `levels()`, the ordering of the treatment factor is:\n\n1. None (no music)\n2. Pop (music)\n3. Classical (music)\n\nFrom this ordering, we can specify our weights - based on the hypothesis, lets assign positive values to the music conditions:\n\n```{r}\nmusic_comp <- list(\"No Music - Music\" = c(-1, 1/2, 1/2))\n```\n\nNow lets run our contrast analysis and get confidence intervals:\n\n```{r}\n#run contrast analysis\nmusic_comp_test <- contrast(music_mean, method = music_comp)\n\n#examine output\nmusic_comp_test\n\n#obtain confidence intervals\nconfint(music_comp_test)\n```\n\n`r solend()`\n\n<br>\n\n`r qbegin(10)`\n\nInterpret the results of the contrast analysis in the context of the researchers hypotheses.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nSee the [manual contrasts flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#manual-contrasts).\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\nWe performed a test against $H_0: \\mu_1 - \\frac{1}{2}(\\mu_2 + \\mu_3) = 0$. At the 5\\% significance level, there was evidence that restaurant spending per person for those who were in the no music condition was significantly different from those in a music condition ($t(357) = 2.82, p = .005, \\text{two-sided})$, and this difference was estimated to be 0.90. We are 95\\% confident that those who heard some form of background music spent on average, between £0.27 and £1.52 more per person on their meal than those who heard no background music $(CI_{95}[0.27, 1.52])$.\n\n:::\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Compile Report\n\n`r qbegin(\"Compile Report\", qlabel = FALSE)`  \n\nKnit your report to PDF, and check over your work. To do so, you should make sure:\n\n- Only the output you want your reader to see is visible (e.g., do you want to hide your code?)\n- Check that the **tinytex** package is installed\n- Ensure that the ‘yaml’ (bit at the very top of your document) looks something like this:\n\n```{}\n---\ntitle: \"this is my report title\"\nauthor: \"B1234506\"\ndate: \"07/09/2024\"\noutput: bookdown::pdf_document2\n---\n```\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n# What to do if you cannot knit to PDF\nIf you are having issues knitting directly to PDF, try the following:  \n\n- Knit to HTML file  \n- Open your HTML in a web-browser (e.g. Chrome, Firefox)  \n- Print to PDF (Ctrl+P, then choose to save to PDF)  \n- Open file to check formatting\n:::\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n# Hiding Code and/or Output\n\n:::{.panel-tabset}\n## Hiding R Code\n\nTo not show the code of an R code chunk, and only show the output, write:\n\n````\n```{{r, echo=FALSE}}\n# code goes here\n```\n````\n\n## Hiding R Output\n\nTo show the code of an R code chunk, but hide the output, write:\n\n````\n```{{r, results='hide'}}\n# code goes here\n```\n````\n\n## Hiding R Code and Output\n\nTo hide both code and output of an R code chunk, write:\n\n````\n```{{r, include=FALSE}}\n# code goes here\n```\n````\n:::\n\n:::\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Tinytex\nYou must make sure you have **tinytex** installed in R so that you can “Knit” your Rmd document to a PDF file:\n\n```{r eval = FALSE}\ninstall.packages(\"tinytex\")\ntinytex::install_tinytex()\n```\n\n:::\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\nYou should end up with a PDF file. If you have followed the above instructions and still have issues with knitting, speak with a Tutor. \n\n`r solend()`\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nsource('assets/setup.R')\n\nset.seed(3)\n\nlibrary(DT)\nlibrary(pander)\nlibrary(sjPlot)\nlibrary(tidyverse)\n\n```\n\n:::lo\n\n### <i class=\"fa fa-graduation-cap\"></i> Learning Objectives\nAt the end of this lab, you will:\n\n1. Understand how to specify sum-to-zero coding\n2. Interpret the output from a model using sum-to-zero coding\n3. Understand how to specify contrasts to test specific effects\n\n### <i class=\"fa fa-check-square-o fa-2\"></i> What You Need\n\n1. Be up to date with lectures\n2. Have completed [Week 7](https://uoepsy.github.io/dapr2/2425/labs/1_06_dummy.html) lab exercises\n\n### <i class=\"fab fa-r-project\"></i> Required R Packages\nRemember to load all packages within a code chunk at the start of your RMarkdown file using `library()`. If you do not have a package and need to install, do so within the console using `install.packages(\" \")`. For further guidance on installing/updating packages, see Section C [here](https://uoepsy.github.io/files/install-update-r#update-pkgs). \n\nFor this lab, you will need to load the following package(s):\n\n* **tidyverse** \n* **psych** \n* **kableExtra**\n* **emmeans**\n\n### <i class=\"fa fa-pencil-square-o\" aria-hidden=\"true\"></i> Presenting Results\nAll results should be presented following [APA guidelines](https://apastyle.apa.org/instructional-aids/numbers-statistics-guide.pdf).If you need a reminder on how to hide code, format tables/plots, etc., make sure to review the [rmd bootcamp](https://uoepsy.github.io/scs/rmd-bootcamp/).\n\nThe example write-up sections included as part of the solutions are **not perfect** - they instead should give you a good example of what information you should include and how to structure this. Note that you must **not** copy any of the write-ups included below for future reports - if you do, you will be committing plagiarism, and this type of academic misconduct is taken very seriously by the University. You can find out more [here](https://www.ed.ac.uk/academic-services/students/conduct/academic-misconduct).\n\n### <i class=\"fa fa-file\"></i> Lab Data\nYou can download the data required for this lab [here](https://uoepsy.github.io/data/RestaurantSpending.csv) or read it in via this link https://uoepsy.github.io/data/RestaurantSpending.csv\n\n:::\n\n# Study Overview\n\n> **Research Question** \n>\n> Does background music in a restaurant influence the amount of money that diners spend on their meal?\n\nA group of researchers wanted to test the claims reported in [North, Shilcock, & Hargreaves (2003)](https://doi.org/10.1177/0013916503254749) on whether background music playing in a restaurant influences the amount of money diners spent on their meal.\n\nThe group of researchers got in touch with a local restaurant and asked them to alternate silence, popular music, and classical music on successive nights over 18 days. On those nights they recorded the average spend per person for each table.\n\nIn addition to the above research question, the researchers were also interested in the following:\n\n> **Comparisons** \n>\n> + Whether having some kind of music as opposed to no music (i.e., silence), resulted in a difference in the average amount of money spent by diners on their meal.\n\n`r optbegin(\"Restaurant Spending Codebook\", olabel=FALSE, toggle=params$TOGGLE)` \n\n__Data Dictionary__\n\nThe data in `RestaurantSpending.csv` contained three attributes collected from $n=360$ participants:\n\n```{r echo=FALSE, message=FALSE, warning=FALSE}\nrest_spend <- read_csv(\"https://uoepsy.github.io/data/RestaurantSpending.csv\")\ntibble(\nvariable = names(rest_spend),\ndescription = c(\"identifier for each diner\", \"which one of three types of music was played (classical, pop, or none)\", \"average restaurant spending per person (in pounds - £)\")\n) %>% gt::gt()\n```\n\n__Preview__\n\nThe first six rows of the data are:\n\n```{r echo=FALSE, message=FALSE}\nread_csv('https://uoepsy.github.io/data/RestaurantSpending.csv') %>% head %>% gt::gt()\n```\n\n`r optend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Setup\n\n`r qbegin(\"Setup\", qlabel = FALSE)` \n\n1. Create a new RMarkdown file\n2. Load the required package(s)\n3. Read the Restaurant Spending dataset into R, assigning it to an object named `rest_spend` \n \n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r message=FALSE}\n#Loading the required package(s)\nlibrary(tidyverse)\nlibrary(psych)\nlibrary(kableExtra)\nlibrary(emmeans)\n\n#Reading in data and storing in object named 'rest_spend'\nrest_spend <- read_csv('https://uoepsy.github.io/data/RestaurantSpending.csv')\n```\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Exercises \n\n## Study & Analysis Plan Overview \n\n`r qbegin(1)`\n\nExamine the dataset, and perform any necessary and appropriate data management steps.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n- The `str()` function will return the overall structure of the dataset, this can be quite handy to look at  \n- Convert categorical variables to factors, and if needed, provide better variable names*\n- Label factors appropriately to aid with your model interpretations if required*    \n- Check that the dataset is complete (i.e., are there any `NA` values?). We can check this using `is.na()`  \n- Are scores within possible ranges (e.g., if we recorded people's age, it would be impossible to have someone aged -31!)  \n\n*See the [Overview (numeric outcomes & categorical predictors) flashcard](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#numeric-outcomes-categorical-predictors).\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nLet's have a look at the data to see what we're working with:\n```{r}\n#first look at dataset structure\nstr(rest_spend)\n\n#now lets look at top 6 rows (or the head) of the dataset\nhead(rest_spend)\n\n#check for NAs - there are none - all FALSE\ntable(is.na(rest_spend))\n```\n\nLet's start with the music 'type' variable. This should be coded as factor (`<fctr>`), but can see from above it is currently coded as a character (`<chr>`). Let's fix this, and rename 'type' to 'music' and remove the word 'music' form the labels of the levels of the factor to avoid repetition whilst we're at it:\n\n```{r}\nrest_spend <- rest_spend %>%\n    mutate(\n        type = factor(type, \n                           levels = c(\"No Music\", \"Pop Music\", \"Classical Music\"),\n                           labels = c(\"None\", \"Pop\", \"Classical\"))) %>%\n        rename(music = type)\n```\n\nNext, let's look at the 'amount' variable. Here we want to check for impossible values - i.e., cannot have a negative £ per head.\n\n```{r}\n# all looks ok - min and max both positive values\ndescribe(rest_spend$amount)\n```\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\nAll participant data was complete (no missing values), with restaurant spending per person within possible ranges. Music type was coded as a factor with three levels (none, pop, and classical).\n\n:::\n\n`r solend()`\n\n<br>\n\n`r qbegin(2)`\n\nProvide a brief overview of the study design and data, before detailing your analysis plan to address the research question.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\n- Give the reader some background on the context of the study\n- State what type of analysis you will conduct in order to address the research question\n- Specify the model to be fitted to address the research question (note that you will need to specify the reference level of your categorical variable)\n- Specify your chosen significance ($\\alpha$) level\n- State your hypotheses\n\nMuch of the information required can be found in the [Study Overview] codebook. The [statistical models](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#statistical-models) flashcards may also be useful to refer to. \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nThe `rest_spend` dataset contained information on 360 hypothetical participants who took part in an experiment examining the effect of music on customer spending in a restaurant setting. Using a between-subjects design, the researchers had one of three types of music - classical, pop, or silence - played in a restaurant over 18 successive evenings. As well as recording the type of music played during the meal, the researchers also recorded the average spend per person (in £). \n\nAll participant data was complete (no missing values), with restaurant spending per person within possible ranges. Music type was coded as a factor with three levels (none, pop, and classical).\n\nBoxplots will be used to visualise the associations among spend per person and background music conditions. To address the research question of whether spend per person differs by background music condition, we can specify our model and coding scheme as follows:\n\n$$\n\\text{Restaurant Spending} = \\beta_0 + \\beta_1 \\cdot \\text{Effect Level 1} + \\beta_2 \\cdot \\text{Effect Level 2} + \\epsilon\n$$\n\nwhere:\n\n$$\n\\text{Effect Level 1} = \\begin{cases}\n1  & \\text{if observation is from category 1} \\\\\n0  & \\text{if observation is from category 2} \\\\\n-1 & \\text{otherwise}\n\\end{cases}\n$$\n\n$$\n\\text{Effect Level 2} = \\begin{cases}\n0  & \\text{if observation is from category 1} \\\\\n1  & \\text{if observation is from category 2} \\\\\n-1 & \\text{otherwise}\n\\end{cases}\n$$\n\nSchematically:\n\n$$\n\\begin{matrix}\n\\textbf{Level}           & \\textbf{Effect Level 1} & \\textbf{Effect Level 2} \\\\\n\\hline\n\\text{None}              & 1   & 0    \\\\\n\\text{Pop}               & 0   & 1    \\\\\n\\text{Classical}         & -1  & -1\n\\end{matrix}\n$$\n\nEffects will be considered statistically significant at $\\alpha=.05$\n\nOur hypotheses are:\n\n$H_0:$ All $\\beta_j = 0$ (for $j = 1, 2$)\n\nThere are no differences in average spend per person based on background music conditions.\n\n$H_1:$ At least one $\\beta_j \\neq  0$ (for $j = 1, 2$)\n\nThere are differences in average spend per person based on background music conditions. \n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Descriptive Statistics & Visualisations\n\n`r qbegin(3)`\n\nProvide a table of descriptive statistics and visualise your data.\n\nRemember to interpret your plot in the context of the study (i.e., comment on any observed differences among treatment groups). \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nReview the many ways to numerically and visually explore your data by reading over the [data exploration flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#data-exploration).\n\nFor examples, see flashcards on [descriptives statistics tables - categorical and numeric values examples](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#data-exploration) and [data visualisation - bivariate examples](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#visual-exploration), paying particular attention to the type of data that you're working with. \n\nA nice additional step you could take with your data visialisation would be to add a line representing the grand mean (the mean of all the observations). You can do this by specifying `geom_hline()`. Within this argument, you will need to specify where the horizontal line should cut the y-axis via `yintercept = `. You might want to specify line: type (via `lty = `), width (via `lwd = `), and colour (via `colour = `). Make sure to comment on any observed differences among the conditions in comparison to the grand mean.\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n::: {.panel-tabset}\n\n## Numeric\n\nDescriptive statistics presented in a well formatted table, grouped by music condition:\n\n```{r message=FALSE, warning=FALSE}\n#| label: tbl-music-descript\n#| tbl-cap: Restaurant Spending & Music Type Descriptive Statistics\nrest_spend %>% \n            group_by(music) %>%\n            summarise(n = n(),\n                      Mean = mean(amount),\n                      SD = sd(amount),\n                      Min = min(amount),\n                      Max = max(amount)) %>% \n            kable(caption = \"Restaurant Spending & Music Type Descriptive Statistics\", digits = 2) %>%\n            kable_styling()\n```\n\n## Visual \n\nSince we have a continuous outcome and a categorical predictor - a boxplot would be most appropriate for visualisations:\n\n```{r}\n#| label: fig-music-desc\n#| fig-cap: \"Associations between Restaurant Spending and Music Type\"\nggplot(data = rest_spend, aes(x = music, y = amount, fill = music)) +\n  geom_boxplot() +\n    geom_hline(yintercept = mean(rest_spend$amount), lty = 2, lwd = 1, colour = \"darkgrey\") +\n  labs(x = 'Background Music Type', y = 'Restaurant Spending (in GBP)')\n```\n\n:::\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\n+ There are three types of music groups ($g = 3$), where there is one group for each music type: “Classical,” “None,” “Pop\". Each group has 120 observations. \n+ It seems that customers in the None and Pop music conditions had a similar average restaurant spending\n+ The average restaurant spending seems to be higher for those who had in the Classical music condition in comparison to customers in both the None and Pop music type conditions. \n:::\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Model Fitting & Interpretation \n\n`r qbegin(4)`\n\nSet the sum to zero constraint for the factor of background music.\n\nFit the specified model, and assign it the name \"mdl_stz\".\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nWe can switch between side-constraints using the following code:\n\n```{r, eval = FALSE}\n#use dummy coding\ncontrasts(rest_spend$music) <- \"contr.treatment\"\n\n#use sum-to-zero coding\ncontrasts(rest_spend$music) <- \"contr.sum\"\n```\n\nFor more information, see the [dummy vs effects coding flashcard](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#numeric-outcomes-categorical-predictors).\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n::: {.panel-tabset}\n\n## Sum to Zero Constraint\n\n```{r}\ncontrasts(rest_spend$music) <- \"contr.sum\"\n\n#check coding matches our table above:\ncontrasts(rest_spend$music)\n```\n\n\n## Fit Model \n```{r}\nmdl_stz <- lm(amount ~ music, data = rest_spend)\n\n#check summary\nsummary(mdl_stz)\n```\n\n:::\n\n`r solend()`\n\n<br> \n\n`r qbegin(5)`\n\nInterpret your coefficients in the context of the study.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nRecall that under this constraint the interpretation of the coefficients becomes:\n\n- $\\beta_0$ represents the grand mean\n- $\\beta_i$ the effect due to group $i$ --- that is, the mean response in group $i$ minus the grand mean\n\nFor more information, see the [numeric outcomes & categorical predictors flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#numeric-outcomes-categorical-predictors).\n\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nLet's first map our coefficients and estimates:\n\n| Coefficient | Estimate | Relation between $\\beta$ and $\\mu$ |\n|:-:|:-:|:-:|\n| (Intercept)   |  22.7382 | $\\beta_0 = \\frac{\\mu_1 + \\mu_2 + \\mu_3}{3} = \\mu$\n| music1        | -0.5968  | $\\beta_1 = \\mu_1 - \\mu$|\n| music2        | -0.8392  | $\\beta_2 = \\mu_2 - \\mu$ |\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\n+ The estimate corresponding to `(Intercept)` contains $\\beta_0 = \\mu = 22.7382$. This value represents the grand mean of the data. The estimated average spending for customers across background music conditions is approximately £22.74.\n\n+ The next estimate corresponds to `music1` and is $\\hat \\beta_1 = -0.5968$. The difference in mean spending between `None` $(\\hat \\mu_1)$ and the grand mean $(\\hat \\mu_0)$ was estimated to be $-0.5968$. In other words, people with no music playing in the background seem to spend approximately £0.60 less than average, and spent $22.7382 + (-0.5968) = £22.14$ in total.  \n\n+ The estimate corresponding to `music2` is $\\hat \\beta_2 = -0.8392$. The difference in mean spending between `Pop` $(\\hat \\mu_2)$ and the grand mean $(\\hat \\mu_0)$ was estimated to be $-0.8392$.  In other words, customers with Pop music playing in the background seem to spend approximately £0.84 less than average, and spent $22.7382 + (-0.8392) = £21.90$ in total. \n\n+ The estimate for `music3`, representing the difference of “Classical” to the grand mean is *not shown* by `summary()`. Because of the side-constraint, we know that $\\mu_3 = \\beta_0 - (\\beta_1 + \\beta_2)$. The difference in mean spending between `Classical` and the grand mean was estimated to be $-(-0.5968 + -0.8392) = 1.436$. In other words, customers with Classical music playing in the background seem to spend approximately £1.44 more than average, and spent $22.7382 - (-0.5968 + -0.8392) = £24.17$ in total.\n\n:::\n\n`r solend()`\n\n<br>\n\n`r qbegin(6)`\n\nObtain the estimated (or predicted) group means for the “None,” “Pop,” and “Classical” background music conditions by using the `predict()` function.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nStep 1: Define a data frame via `tibble()` with a column having the same name as the factor in the fitted model (i.e., music). Then, specify all the groups (i.e., levels) for which you would like the predicted mean.\n\nStep 2: Pass the data frame to the predict function using the `newdata = ` argument. The `predict()` function will match the column named type with the predictor called type in the fitted model 'mdl_stz'.\n\nIf you're still not sure, it might be helpful to review the [predicted values flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#model-predicted-values-residuals).\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nStep 1:\n\n```{r}\nquery_groups <- tibble(music = c(\"None\", \"Pop\", \"Classical\"))\nquery_groups\n```\n\nStep 2:\n\n```{r}\npredict(mdl_stz, newdata = query_groups)\n```\n\n+ Predicted mean of \"None\" = $\\hat \\mu_\\text{None}$ = 22.14\n+ Predicted mean of \"Pop\" = $\\hat \\mu_\\text{Pop}$ = 21.90\n+ Predicted mean of \"Classical\" = $\\hat \\mu_\\text{Classical}$ = 24.17\n\nWe can see that these predicted means match our model estimates in Q5. \n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Planned Comparisons / Contrasts\n\n`r qbegin(7)`\n\nFormally state the planned comparison that the researchers were interested in as a testable hypothesis. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nSee the [manual contrasts flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#manual-contrasts). \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nRecall that the researchers were also interested in addressing the following question:\n\n> Whether having some kind of music playing (i.e., pop or classical), rather than no music (i.e., none), resulted in a difference in spending\n\nWe can specify the hypothesis as follows:\n\n$$\n\\begin{aligned}\n    \\quad H_0 &: \\mu_\\text{No Music} = \\mu_\\text{Music} \\\\\n    \\quad H_0 &: \\mu_\\text{None} = \\frac{1}{2} (\\mu_\\text{Pop} + \\mu_\\text{Classical}) \\\\\n\\\\\n    \\quad H_1 &: \\mu_\\text{No Music} \\neq \\mu_\\text{Music} \\\\\n    \\quad H_1 &: \\mu_\\text{No Music} \\neq \\frac{1}{2} (\\mu_\\text{Pop} + \\mu_\\text{Classical}) \\\\\n\\\\ \n\\end{aligned}\n$$\n\n`r solend()`\n\n<br> \n\n`r qbegin(8)`\n\nAfter checking the levels of the factor `music`, use `emmeans()` to obtain the estimated treatment means and uncertainties for your factor. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nSee the [manual contrasts flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#manual-contrasts). \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\nlevels(rest_spend$music)\n```\n\nUse the `emmeans()` to get the estimated means of our groups:\n\n```{r}\nmusic_mean <- emmeans(mdl_stz, ~ music)\nmusic_mean\nplot(music_mean)\n```\n\n`r solend()`\n\n<br>\n\n`r qbegin(9)`\n\nSpecify the coefficients of the comparisons and run the contrast analysis, obtaining 95% confidence intervals. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nSee the [manual contrasts flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#manual-contrasts).\n\nRemember that ordering matters here - look again at the output of `levels(rest_spend$music)` as this will help you when assigning your weights. \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nAs shown above via `levels()`, the ordering of the treatment factor is:\n\n1. None (no music)\n2. Pop (music)\n3. Classical (music)\n\nFrom this ordering, we can specify our weights - based on the hypothesis, lets assign positive values to the music conditions:\n\n```{r}\nmusic_comp <- list(\"No Music - Music\" = c(-1, 1/2, 1/2))\n```\n\nNow lets run our contrast analysis and get confidence intervals:\n\n```{r}\n#run contrast analysis\nmusic_comp_test <- contrast(music_mean, method = music_comp)\n\n#examine output\nmusic_comp_test\n\n#obtain confidence intervals\nconfint(music_comp_test)\n```\n\n`r solend()`\n\n<br>\n\n`r qbegin(10)`\n\nInterpret the results of the contrast analysis in the context of the researchers hypotheses.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nSee the [manual contrasts flashcards](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading.html#manual-contrasts).\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\nWe performed a test against $H_0: \\mu_1 - \\frac{1}{2}(\\mu_2 + \\mu_3) = 0$. At the 5\\% significance level, there was evidence that restaurant spending per person for those who were in the no music condition was significantly different from those in a music condition ($t(357) = 2.82, p = .005, \\text{two-sided})$, and this difference was estimated to be 0.90. We are 95\\% confident that those who heard some form of background music spent on average, between £0.27 and £1.52 more per person on their meal than those who heard no background music $(CI_{95}[0.27, 1.52])$.\n\n:::\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Compile Report\n\n`r qbegin(\"Compile Report\", qlabel = FALSE)`  \n\nKnit your report to PDF, and check over your work. To do so, you should make sure:\n\n- Only the output you want your reader to see is visible (e.g., do you want to hide your code?)\n- Check that the **tinytex** package is installed\n- Ensure that the ‘yaml’ (bit at the very top of your document) looks something like this:\n\n```{}\n---\ntitle: \"this is my report title\"\nauthor: \"B1234506\"\ndate: \"07/09/2024\"\noutput: bookdown::pdf_document2\n---\n```\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n# What to do if you cannot knit to PDF\nIf you are having issues knitting directly to PDF, try the following:  \n\n- Knit to HTML file  \n- Open your HTML in a web-browser (e.g. Chrome, Firefox)  \n- Print to PDF (Ctrl+P, then choose to save to PDF)  \n- Open file to check formatting\n:::\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n# Hiding Code and/or Output\n\n:::{.panel-tabset}\n## Hiding R Code\n\nTo not show the code of an R code chunk, and only show the output, write:\n\n````\n```{{r, echo=FALSE}}\n# code goes here\n```\n````\n\n## Hiding R Output\n\nTo show the code of an R code chunk, but hide the output, write:\n\n````\n```{{r, results='hide'}}\n# code goes here\n```\n````\n\n## Hiding R Code and Output\n\nTo hide both code and output of an R code chunk, write:\n\n````\n```{{r, include=FALSE}}\n# code goes here\n```\n````\n:::\n\n:::\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Tinytex\nYou must make sure you have **tinytex** installed in R so that you can “Knit” your Rmd document to a PDF file:\n\n```{r eval = FALSE}\ninstall.packages(\"tinytex\")\ntinytex::install_tinytex()\n```\n\n:::\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\nYou should end up with a PDF file. If you have followed the above instructions and still have issues with knitting, speak with a Tutor. \n\n`r solend()`\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"include-in-header":["assets/toggling.html",{"text":"<link rel=\"stylesheet\" href=\"https://uoepsy.github.io/assets/css/ccfooter.css\" />\n"}],"number-sections":false,"output-file":"1_07_effects.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","bibliography":["biblio.bib"],"toc_float":true,"code-annotations":"hover","link-citations":true,"theme":["united","assets/style-labs.scss"],"title":"Effects Coding","params":{"SHOW_SOLS":true,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}