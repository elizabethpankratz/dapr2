{"title":"Multiple Linear Regression","markdown":{"yaml":{"title":"Multiple Linear Regression","link-citations":true,"params":{"SHOW_SOLS":true,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"headingText":"<i class=\"fa fa-graduation-cap\"></i> Learning Objectives","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nsource('assets/setup.R')\n\nset.seed(953)\n```\n\n:::lo\nAt the end of this lab, you will:\n\n1. Extend the ideas of single linear regression to consider regression models with two or more predictors\n2. Understand and interpret the coefficients in multiple linear regression models\n\n### <i class=\"fa fa-check-square-o fa-2\"></i> Requirements\n1. Be up to date with lectures\n2. Have completed [Week 1](https://uoepsy.github.io/dapr2/2324/labs/1_01_slr.html) lab exercises\n\n### <i class=\"fab fa-r-project\"></i> Required R Packages\nRemember to load all packages within a code chunk at the start of your RMarkdown file using `library()`. If you do not have a package and need to install, do so within the console using `install.packages(\" \")`. For further guidance on installing/updating packages, see Section C [here](https://uoepsy.github.io/files/install-update-r#update-pkgs). \n\nFor this lab, you will need to load the following package(s):\n\n* **tidyverse**\n* **psych**\n* **patchwork**\n* **sjPlot**\n* **kableExtra**\n\n### <i class=\"fa fa-pencil-square-o\" aria-hidden=\"true\"></i> Presenting Results\nAll results should be presented following [APA guidelines](https://apastyle.apa.org/instructional-aids/numbers-statistics-guide.pdf).If you need a reminder on how to hide code, format tables/plots, etc., make sure to review the [rmd bootcamp](https://uoepsy.github.io//rmd-bootcamp/).\n\nThe example write-up sections included as part of the solutions are **not perfect** - they instead should give you a good example of what information you should include and how to structure this. Note that you must **not** copy any of the write-ups included below for future reports - if you do, you will be committing plagiarism, and this type of academic misconduct is taken very seriously by the University. You can find out more [here](https://www.ed.ac.uk/academic-services/students/conduct/academic-misconduct).\n\n### <i class=\"fa fa-file\"></i> Lab Data\nYou can download the data required for this lab [here](https://uoepsy.github.io/data/wellbeing_rural.csv) or read it in via this link https://uoepsy.github.io/data/wellbeing_rural.csv \n\n:::\n\n# Study Overview {#sec-studyview}\n\n> **Research Question** \n>\n> Is there an association between wellbeing and time spent outdoors *after* taking into account the association between wellbeing and social interactions? \n\n`r optbegin(\"Wellbeing/Rurality data codebook.\", olabel=FALSE, toggle=params$TOGGLE)`  \n\n__Description__\n\nFrom the Edinburgh & Lothians, 100 city/suburb residences and 100 rural residences were chosen at random and contacted to participate in the study. The Warwick-Edinburgh Mental Wellbeing Scale (WEMWBS), was used to measure mental health and well-being. \n\nParticipants filled out a questionnaire including items concerning: estimated average number of hours spent outdoors each week, estimated average number of social interactions each week (whether on-line or in-person), whether a daily routine is followed (yes/no). For those respondents who had an activity tracker app or smart watch, they were asked to provide their average weekly number of steps.  \n  \n  \n__Data Dictionary__\n\nThe data in `wellbeing_rural.csv` contain seven attributes collected from a random sample of $n=200$ hypothetical residents over Edinburgh & Lothians, and include: \n\n```{r echo=FALSE, message=FALSE, warning=FALSE}\nmwdata  <- read_csv(\"https://uoepsy.github.io/data/wellbeing_rural.csv\")\ntibble(\nvariable = names(mwdata),\ndescription = c(\"Age in years of respondent\",\"Self report estimated number of hours per week spent outdoors \", \"Self report estimated number of social interactions per week (both online and in-person)\", \"Binary 1=Yes/0=No response to the question 'Do you follow a daily routine throughout the week?'\", \"Warwick-Edinburgh Mental Wellbeing Scale (WEMWBS), a self-report measure of mental health and well-being. The scale is scored by summing responses to each item, with items answered on a 1 to 5 Likert scale. The minimum scale score is 14 and the maximum is 70\", \"Location of primary residence (City, Suburb, Rural)\", \"Average weekly number of steps in thousands (as given by activity tracker if available)\")\n) %>% gt::gt()\n```\n  \n  \n__Preview__\n\nThe first six rows of the data are:\n\n```{r echo=FALSE, message=FALSE}\nread_csv('https://uoepsy.github.io/data/wellbeing_rural.csv') %>% head %>% gt::gt()\n```\n  \n`r optend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Setup\n\n`r qbegin(\"Setup\", qlabel = FALSE)`  \n\n1. Create a new RMarkdown file\n2. Load the required package(s)\n3. Read the wellbeing dataset into R, assigning it to an object named `mwdata`\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n```{r message=FALSE}\n#Loading the required package(s)\nlibrary(tidyverse)\nlibrary(psych)\nlibrary(patchwork)\nlibrary(sjPlot)\nlibrary(kableExtra)\n\n# Reading in data and storing to an object named 'mwdata'\nmwdata <- read_csv(\"https://uoepsy.github.io/data/wellbeing_rural.csv\")\n```\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Exercises \n\n## Study & Analysis Plan Overview \n\n`r qbegin(1)`\n\nProvide a brief overview of the study design and data, before detailing your analysis plan to address the research question.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\n- Give the reader some background on the context of the study (you might be able to re-use some of the content you wrote for [Lab 1](https://uoepsy.github.io/dapr2/2324/labs/1_01_slr.html) here)\n- State what type of analysis you will conduct in order to address the research question\n- Specify the model to be fitted to address the research question \n- Specify your chosen significance ($\\alpha$) level\n- State your hypotheses\n\nMuch of the information required can be found in the [Study Overview] codebook.\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nThe `mwdata` dataset contained information on 200 hypothetical participants who lived in Edinburgh & Lothians area. Using a between-subjects design, the researchers collected information on participants' wellbeing (measured via WEMWBS), outdoor time (hours per week), social interactions (number per week), routine (whether or not one was followed), location of residence (City, Suburb, or Rural), average weekly steps (in thousands), and age (in years).\n\nDensity plots and boxplots will be used to visualise the marginal distributions of wellbeing, social interactions, and outdoor time. To understand the strength of association among the variables, we will estimate the the correlation coefficients. To address the research question of whether there is an association between wellbeing and time spent outdoors after taking into account the association between wellbeing and social interactions, we are going to fit the following multiple linear regression model:\n\n$$\n\\text{Wellbeing} = \\beta_0 + \\beta_1 \\cdot Social~Interactions + \\beta_2 \\cdot Outdoor~Time + \\epsilon\n$$\n\nEffects will be considered statistically significant at $\\alpha=.05$.\n\nOur hypotheses are:\n\n$H_0: \\beta_2 = 0$: There is no association between wellbeing and time spent outdoors after taking into account the association between wellbeing and social interactions\n\n$H_1: \\beta_2 \\neq 0$: There is an association between wellbeing and time spent outdoors after taking into account the association between wellbeing and social interactions\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Descriptive Statistics & Visualisations\n\n`r qbegin(2)`\n\nAlongside descriptive statistics, visualize the marginal distributions of the `wellbeing`, `outdoor_time`, and `social_int` variables. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\n*Code for tables & plots*\n- You might be able to re-use some of the code you wrote for [Lab 1](https://uoepsy.github.io/dapr2/2324/labs/1_01_slr.html) here, and remember that you can refer back to the [DAPR1 materials](https://uoepsy.github.io/dapr1/2223/index.html) too\n\n*Plot interpretation*  \n- The *shape*, *center* and *spread* of the distribution  \n- Whether the distribution is *symmetric* or *skewed*  \n- Whether the distribution is *unimodal* or *bimodal* \n\n*Plotting tips*  \n- Use `\\n` to wrap text in your titles and or axis labels  \n- The **patchwork** package allows us to arrange multiple plots in two ways - `|` arranges the plots adjacent to one another, and `/` arranges the plots on top of one another  \n\n*Table tips*  \n- The `describe()` function from the **psych** package will produce a table of descriptive statistics. If you would like only a subset of this output (e.g., mean, sd), you can use `select()` after calling `describe()` e.g., `describe() %>% select(mean, sd)`  \n- The **kableExtra** package allows us to produce well formatted tables for our descriptive statistics. To do so, you need to specify the `kable()` and `kable_styling()` arguments  \n- Review the guidance on the [rmd bootcamp](https://uoepsy.github.io//rmd-bootcamp/), particularly Lesson 4\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n::: {.panel-tabset}\n\n## Numeric\n\nWe can present our summary statistics for wellbeing, outdoor time, and social interactions as a well formatted table using `kable()`: \n\n```{r}\n#| label: tbl-w2-desc\n#| tbl-cap: Wellbeing, Social Interactions, and Outdoor Time Descriptive Statistics\nmwdata %>% \n  select(wellbeing, outdoor_time, social_int) %>%\n    describe() %>%\n    kable(caption = \"Wellbeing, Social Interactions, and Outdoor Time Descriptive Statistics\", align = \"c\", digits = 2, booktabs = TRUE) %>%\n    kable_styling(full_width = FALSE)\n\n```\n\n:::{.callout-important icon=false appearance=\"minimal\"}\n\n+ The marginal distribution of scores on the WEMWBS was unimodal with a mean of approximately `r round(mean(mwdata$wellbeing),2)`. There was variation in WEMWBS scores (SD = `r round(sd(mwdata$wellbeing),2)`)   \n+ The marginal distribution of weekly hours spent outdoors was unimodal with a mean of approximately `r round(mean(mwdata$outdoor_time),2)`. There was variation in weekly hours spent outdoors (SD = `r round(sd(mwdata$outdoor_time),2)`) \n+ The marginal distribution of numbers of social interactions per week was unimodal with a mean of approximately `r round(mean(mwdata$social_int),2)`. There was variation in numbers of social interactions (SD = `r round(sd(mwdata$social_int),2)`)\n\n:::\n\n## Visual\n\nYou should be familiar now with how to visualise a marginal distribution. You might choose histograms, density curves, or boxplots, or a combination:   \n```{r}\n#| label: fig-marg-dist\n#| fig-cap: \"Marginal distribution plots of wellbeing sores, weekly hours spent outdoors, and social interactions\"\n   \nwellbeing_plot <- \n  ggplot(data = mwdata, aes(x = wellbeing)) +\n  geom_density() +\n  geom_boxplot(width = 1/200) +\n  labs(x = \"Score on WEMWBS (range 14-70)\", y = \"Probability\\nDensity\")\n\noutdoortime_plot <- \n  ggplot(data = mwdata, aes(x = outdoor_time)) +\n  geom_density() +\n  geom_boxplot(width = 1/200) +\n  labs(x = \"Time spent outdoors per week (hours)\", y = \"Probability\\nDensity\")\n\nsocial_plot <- \n  ggplot(data = mwdata, aes(x = social_int)) +\n  geom_density() +\n  geom_boxplot(width = 1/200) +\n  labs(x = \"Number of social interactions per week\", y = \"Probability\\nDensity\")\n\n# arrange plots vertically \nwellbeing_plot / outdoortime_plot / social_plot\n```\n\n:::\n\n`r solend()`\n\n<br>\n\n`r qbegin(3)`\n\nProduce plots of the associations between the outcome variable (wellbeing) and each of the explanatory variables.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\n*Plot interpretation*    \n- *Direction* of association  \n- *Form* of association (can it be summarised well with a straight line?)  \n- *Strength* of association (how closely do points fall to a recognizable pattern such as a line?)  \n- *Unusual observations* that do not fit the pattern of the rest of the observations and which are worth examining in more detail  \n\n*Plot tips*  \n- use `\\n` to wrap text in your titles and or axis labels  \n- consider using `geom_smooth()` to  superimpose the best-fitting line describing the association of interest\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r message = FALSE, warning=FALSE}\n#| label: fig-marg-relationship\n#| fig-cap: \"Scatterplots displaying the relationships between scores on the WEMWBS and a) weekly outdoor time (hours), and b) weekly number of social interactions\"\nwellbeing_outdoor <- \n  ggplot(data = mwdata, aes(x = outdoor_time, y = wellbeing)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) + \n  labs(x = \"Time spent outdoors \\nper week (hours)\", y = \"Wellbeing score (WEMWBS)\")\n\nwellbeing_social <- \n  ggplot(data = mwdata, aes(x = social_int, y = wellbeing)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) + \n  labs(x = \"Number of social interactions \\nper week\", y = \"Wellbeing score (WEMWBS)\")\n\n# place plots adjacent to one another\nwellbeing_outdoor | wellbeing_social\n```\n\nBoth scatterplots indicated weak, positive, and linear associations both between wellbeing and outdoor time, and between wellbeing and the number of weekly social interactions.\n\n`r solend()`\n\n<br>\n  \n`r qbegin(4)`\nProduce a correlation matrix of the variables which are to be used in the analysis, and write a short paragraph describing the associations. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\n*Correlation Matrix*  \nReview [Lab 1 Q2](https://uoepsy.github.io/dapr2/2324/labs/1_01_slr.html#associations-among-variables) for guidance on how to produce a correlation matrix.\n\n*APA Format*  \nMake sure to round your numbers in-line with APA 7th edition guidelines as noted at the start of the lab (see 'Presenting Results'). The `round()` function will come in handy here. \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nWe can either index the dataframe or select the variables of interest:\n\n::: {.panel-tabset}\n\n## Index dataframe (`[]`)\n\n```{r}\n# correlation matrix of the three columns of interest (check which columns we need - in this case, 2,3, and 5)\nround(cor(mwdata[,c(5,3,2)]), digits = 2)\n```\n\n## Variable selection (`select()`)\n\n```{r}\n# select only the columns we want by variable name, and pass this to cor()\nmwdata %>% \n  select(wellbeing, social_int, outdoor_time) %>%\n  cor() %>%\n  round(digits = 2)\n```\n\n:::\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\n- There was a weak, positive, linear association between WEMWBS scores and weekly outdoor time for the participants in the sample ($r$ = .25). Higher number of hours spent outdoors each week was associated, on average, with higher wellbeing scores   \n- There was a weak, positive, linear association between WEMWBS scores and the weekly number of social interactions for the participants in the sample ($r$ = .24). More social interactions were associated, on average,  with higher wellbeing scores\n- There was a negligible negative correlation between weekly outdoor time and the weekly number of social interactions ($r$ = -.04)\n\n::: \n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Model Fitting & Interpretation \n\n`r qbegin(5)`\n\nRecall the model specified in Q1, and:  \n\n(1) State the _parameters_ of the model. How do we denote _parameter estimates_?  \n(2) Fit the linear model in using `lm()`, assigning the output to an object called `mdl1`. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nAs we did for simple linear regression, we can fit our multiple regression model using the `lm()` function. We can add as many explanatory (i.e., independent) variables as we like, separating them with a `+`. \n\n<code>\n**model name** <- lm(**dependent variable** ~ **independent variable 1** + **independent variable 2** + ..., data = **dataframe**)\n</code>\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nA model for the association between $x_1$ = weekly numbers of social interactions, $x_2$ = weekly outdoor time, and $y$ = scores on the WEMWBS can be given by:\n$$\ny = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\epsilon \\\\ \\quad \\\\ \n\\text{where} \\quad \\epsilon \\sim N(0, \\sigma) \\text{ independently}\n$$\n\nIn the model specified above,\n\n- $\\mu_{y|x_1, x_2} = \\beta_0 + \\beta_1 x + \\beta_2 x_2$ represents the systematic part of the model giving the mean of $y$ at each combination of values of $x_1$ and $x_2$;\n- $\\epsilon$ represents the error (deviation) from that mean, and the errors are independent from one another.  \n  \n  \nThe parameters of our model are:\n\n+ $\\beta_0$ (The intercept);\n+ $\\beta_1$ (The slope across values of $x_1$);\n+ $\\beta_2$ (The slope across values of $x_2$);  \n+ $\\sigma$ (The standard deviation of the errors).\n\nWhen we estimate these parameters from the available data, we have a _fitted model_ (recall that the h$\\hat{\\textrm{a}}$ts are used to distinguish our _estimates_ from the _true unknown parameters_): \n\n$$\n\\widehat{Wellbeing} = \\hat \\beta_0 + \\hat \\beta_1 \\cdot Social~Interactions + \\hat \\beta_2 \\cdot Outdoor~Time \n$$\nAnd we have residuals $\\hat \\epsilon = y - \\hat y$ which are the deviations from the observed values and our model-predicted responses.  \n\nFitting the model in `R`:\n\n```{r}\nmdl1 <- lm(wellbeing ~ social_int + outdoor_time, data = mwdata)\n```\n\n`r solend()`\n\n<br>\n\n:::statbox\n__Visual__\n\nNote that for simple linear regression we talked about our model as a _line_ in 2 dimensions: the systematic part $\\beta_0 + \\beta_1 x$ defined a line for $\\mu_y$ across the possible values of $x$, with $\\epsilon$ as the random deviations from that line. But in multiple regression we have more than two variables making up our model. \n\nIn this particular case of three variables (one outcome + two explanatory), we can think of our model as a _regression surface_ (see @fig-reg-surface). The systematic part of our model defines the surface across a range of possible values of both $x_1$ *and* $x_2$. Deviations from the surface are determined by the random error component, $\\hat \\epsilon$.  \n\n```{r regsurf, echo=FALSE, out.width=\"100%\"}\n#| label: fig-reg-surface\n#| fig-cap: \"Regression surface for wellbeing ~  social_int + outdoor_time, from two different angles\"\n\nfit<-lm(wellbeing~outdoor_time+social_int, data=mwdata)\nsteps=50\noutdoor_time <- with(mwdata, seq(min(outdoor_time),max(outdoor_time),length=steps))\nsocial_int <- with(mwdata, seq(min(social_int),max(social_int),length=steps))\nnewdat <- expand.grid(outdoor_time=outdoor_time, social_int=social_int)\nwellbeing <- matrix(predict(fit, newdat), steps, steps)\n\n\npar(mfrow=c(1,2))\np <- persp(outdoor_time,social_int,wellbeing, theta = 35,phi=10, col = NA)\nobs <- with(mwdata, trans3d(outdoor_time,social_int, wellbeing, p))\npred <- with(mwdata, trans3d(outdoor_time, social_int, fitted(fit), p))\npoints(obs, col = \"red\", pch = 16)\n#points(pred, col = \"blue\", pch = 16)\nsegments(obs$x, obs$y, pred$x, pred$y)\n\np <- persp(outdoor_time,social_int,wellbeing, theta = -35,phi=10, col = NA)\nobs <- with(mwdata, trans3d(outdoor_time,social_int, wellbeing, p))\npred <- with(mwdata, trans3d(outdoor_time, social_int, fitted(fit), p))\npoints(obs, col = \"red\", pch = 16)\n#points(pred, col = \"blue\", pch = 16)\nsegments(obs$x, obs$y, pred$x, pred$y)\n\npar(mfrow=c(1,1))\n```\n\nDon't worry about trying to figure out how to visualise it if we had any more explanatory variables! We can only concieve of 3 spatial dimensions. One could imagine this surface changing over time, which would bring in a 4th dimension, but beyond that, it's not worth trying!\n\n:::\n\n<br>\n\n`r qbegin(6)`\nUsing any of:  \n\n- `mdl1`\n- `mdl1$coefficients`\n- `coef(mdl1)`\n- `coefficients(mdl1)`\n- `summary(mdl1)`\n\nWrite out the estimated parameter values of: \n\n1. $\\hat \\beta_0$, the estimated average wellbeing score associated with zero hours of outdoor time and zero social interactions per week.  \n2. $\\hat \\beta_1$, the estimated increase in average wellbeing score associated with an additional social interaction per week (an increase of one), _holding weekly outdoor time constant_.  \n3. $\\hat \\beta_2$, the estimated increase in average wellbeing score associated with one hour increase in weekly outdoor time, _holding the number of social interactions constant_ \n\n:::{.callout-note}\n# What do we mean by hold constant / controlling for / partialling out / residualizing for?\n\nWhen the remaining explanatory variables are held at the same value or are fixed.\n\n:::\n\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n::: {.panel-tabset}\n\n##mdl1\n```{r}\nmdl1\n```\n\n## mdl1$coefficients\n```{r}\nmdl1$coefficients\n```\n\n## coef(mdl1)\n```{r}\ncoef(mdl1)\n```\n\n## coefficients(mdl1)\n```{r}\ncoefficients(mdl1)\n```\n\n## summary(mdl1)\nLook under the “Estimate” column:\n```{r}\nsummary(mdl1)\n```\n\n:::\n\n1. $\\hat \\beta_0$ = `r round(coef(mdl1)[1],2)`  \n2. $\\hat \\beta_1$ = `r round(coef(mdl1)[2],2)`  \n3. $\\hat \\beta_2$ = `r round(coef(mdl1)[3],2)`  \n\n`r solend()`\n\n<br>\n\n`r qbegin(7)`\nWithin what distance from the model predicted values (the regression line) would we expect 95% of WEMWBS wellbeing scores to be?\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nEither `sigma()` or part of the output from `summary()` will help you here (see [Lab 1 Q5](https://uoepsy.github.io/dapr2/2324/labs/1_01_slr.html#model-specification-and-fitting) for a detailed explanation of $\\hat \\sigma$).  \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n::: {.panel-tabset}\n\n## sigma(mdl1) \n\n```{r}\nsigma(mdl1)\n```\n\n\n## summary(mdl1)\n\nLook at the \"Residual standard error\" entry of the `summary(mdl)` output:\n\n```{r}\nsummary(mdl1)\n```\n\n:::\n\nThe estimated standard deviation of the errors is $\\hat \\sigma$ = `r round(sigma(mdl1),2)`. We would expect 95% of wellbeing scores to be within about `r round(sigma(mdl1)*2,2)` ($2 \\hat \\sigma$) from the model fit. \n\n`r solend()`\n\n<br>\n\n`r qbegin(8)`\n\nBased on the model, predict the wellbeing scores for the following individuals who were not included in the original sample:\n\n- Leah: Social Interactions = 25; Outdoor Time = 3\n- Sean: Social Interactions = 19; Outdoor Time = 36\n- Mike: Social Interactions = 15; Outdoor Time = 20\n- Donna: Social Interactions = 7; Outdoor Time = 1\n\nWho has the highest predicted wellbeing score, and who has the lowest?\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nIt might be helpful to review the 'Model predicted values for other (unobserved data) from the [Predicted Values & Residuals of Lab 1](https://uoepsy.github.io/dapr2/2324/labs/1_01_slr.html#predicted-values-residuals).  \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nFirst we need to pass the data into R:\n```{r}\nwellbeing_query <- tibble(social_int = c(25, 19, 15, 7),\n                          outdoor_time = c(3, 36, 20, 1))\n```\n\nAnd next use `predict()` to get their estimated wellbeing scores:\n\n```{r}\npredict(mdl1, newdata = wellbeing_query)\n```\n\nSean has the highest predicted wellbeing score (42.15), and Donna the lowest (31.16). \n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Writing Up & Presenting Results\n\n`r qbegin(9)`\n\nProvide key model results in a formatted table.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nUse `tab_model()` from the __sjPlot__ package. \n\nYou can rename your DV and IV labels by specifying `dv.labels` and `pred.labels`. To do so, specify your variable name on the left, and what you would like this to be named in the table on the right. \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\n#| label: tbl-w3-modresults\n#| tbl-cap: Regression Table for Wellbeing Model\ntab_model(mdl1,\n          dv.labels = \"Wellbeing (WEMWBS Scores)\",\n          pred.labels = c(\"social_int\" = \"Social Interactions (number per week)\",\n                          \"outdoor_time\" = \"Outdoor Time (hours per week)\"),\n          title = \"Regression Table for Wellbeing Model\")\n```\n\n`r solend()`\n\n<br>\n\n`r qbegin(10)`\n\nInterpret your results in the context of the research question.\n\nMake reference to the your regression table.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nMake sure to include a decision in relation to your null hypothesis - based on the evidence, should you reject or fail to reject the null?  \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nFrom @fig-marg-dist, we can see that wellbeing $(M = `r round(mean(mwdata$wellbeing), 2)`, SD = `r round(sd(mwdata$wellbeing), 2)`)$, social interactions $(M = `r round(mean(mwdata$social_int), 2)`, SD = `r round(sd(mwdata$social_int), 2)`)$, and outdoor time $(M = `r round(mean(mwdata$outdoor_time), 2)`, SD = `r round(sd(mwdata$outdoor_time), 2)`)$ followed unimodal distributions. There were weak, positive, linear associations between WEMWBS scores and the weekly number of social interactions $(r = .24)$, and between WEMWBS scores and outdoor time $(r = .25)$ in the sample.\n\nA multiple regression model was used to determine if there was an association between well-being and time spent outdoors after taking into account the association between well-being and social interactions. As presented in @tbl-w3-modresults, outdoor time was significantly associated with wellbeing scores $(\\beta = 0.20, SE = 0.05, p < .001)$ after controlling for the number of weekly social interactions. Results suggested that, holding constant social interactions, for every additional hour spent outdoors each week, wellbeing scores increased by 0.20 points. Therefore, we should reject the null hypothesis since $p < .05$.\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Compile Report\n\n`r qbegin(\"Compile Report\", qlabel = FALSE)`  \n\nKnit your report to PDF, and check over your work. To do so, you should make sure:\n\n- Only the output you want your reader to see is visible (e.g., do you want to hide your code?)\n- Check that the **tinytex** package is installed\n- Ensure that the ‘yaml’ (bit at the very top of your document) looks something like this:\n\n```{}\n---\ntitle: \"this is my report title\"\nauthor: \"B1234506\"\ndate: \"07/09/2024\"\noutput: bookdown::pdf_document2\n---\n```\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n# What to do if you cannot knit to PDF\nIf you are having issues knitting directly to PDF, try the following:  \n\n- Knit to HTML file  \n- Open your HTML in a web-browser (e.g. Chrome, Firefox)  \n- Print to PDF (Ctrl+P, then choose to save to PDF)  \n- Open file to check formatting\n:::\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n# Hiding Code and/or Output\n\n:::{.panel-tabset}\n## Hiding R Code\n\nTo not show the code of an R code chunk, and only show the output, write:\n\n````\n```{{r, echo=FALSE}}\n# code goes here\n```\n````\n\n## Hiding R Output\n\nTo show the code of an R code chunk, but hide the output, write:\n\n````\n```{{r, results='hide'}}\n# code goes here\n```\n````\n\n## Hiding R Code and Output\n\nTo hide both code and output of an R code chunk, write:\n\n````\n```{{r, include=FALSE}}\n# code goes here\n```\n````\n:::\n\n:::\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Tinytex\nYou must make sure you have **tinytex** installed in R so that you can “Knit” your Rmd document to a PDF file:\n\n```{r eval = FALSE}\ninstall.packages(\"tinytex\")\ntinytex::install_tinytex()\n```\n\n:::\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\nYou should end up with a PDF file. If you have followed the above instructions and still have issues with knitting, speak with a Tutor. \n\n`r solend()`","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nsource('assets/setup.R')\n\nset.seed(953)\n```\n\n:::lo\n### <i class=\"fa fa-graduation-cap\"></i> Learning Objectives\nAt the end of this lab, you will:\n\n1. Extend the ideas of single linear regression to consider regression models with two or more predictors\n2. Understand and interpret the coefficients in multiple linear regression models\n\n### <i class=\"fa fa-check-square-o fa-2\"></i> Requirements\n1. Be up to date with lectures\n2. Have completed [Week 1](https://uoepsy.github.io/dapr2/2324/labs/1_01_slr.html) lab exercises\n\n### <i class=\"fab fa-r-project\"></i> Required R Packages\nRemember to load all packages within a code chunk at the start of your RMarkdown file using `library()`. If you do not have a package and need to install, do so within the console using `install.packages(\" \")`. For further guidance on installing/updating packages, see Section C [here](https://uoepsy.github.io/files/install-update-r#update-pkgs). \n\nFor this lab, you will need to load the following package(s):\n\n* **tidyverse**\n* **psych**\n* **patchwork**\n* **sjPlot**\n* **kableExtra**\n\n### <i class=\"fa fa-pencil-square-o\" aria-hidden=\"true\"></i> Presenting Results\nAll results should be presented following [APA guidelines](https://apastyle.apa.org/instructional-aids/numbers-statistics-guide.pdf).If you need a reminder on how to hide code, format tables/plots, etc., make sure to review the [rmd bootcamp](https://uoepsy.github.io//rmd-bootcamp/).\n\nThe example write-up sections included as part of the solutions are **not perfect** - they instead should give you a good example of what information you should include and how to structure this. Note that you must **not** copy any of the write-ups included below for future reports - if you do, you will be committing plagiarism, and this type of academic misconduct is taken very seriously by the University. You can find out more [here](https://www.ed.ac.uk/academic-services/students/conduct/academic-misconduct).\n\n### <i class=\"fa fa-file\"></i> Lab Data\nYou can download the data required for this lab [here](https://uoepsy.github.io/data/wellbeing_rural.csv) or read it in via this link https://uoepsy.github.io/data/wellbeing_rural.csv \n\n:::\n\n# Study Overview {#sec-studyview}\n\n> **Research Question** \n>\n> Is there an association between wellbeing and time spent outdoors *after* taking into account the association between wellbeing and social interactions? \n\n`r optbegin(\"Wellbeing/Rurality data codebook.\", olabel=FALSE, toggle=params$TOGGLE)`  \n\n__Description__\n\nFrom the Edinburgh & Lothians, 100 city/suburb residences and 100 rural residences were chosen at random and contacted to participate in the study. The Warwick-Edinburgh Mental Wellbeing Scale (WEMWBS), was used to measure mental health and well-being. \n\nParticipants filled out a questionnaire including items concerning: estimated average number of hours spent outdoors each week, estimated average number of social interactions each week (whether on-line or in-person), whether a daily routine is followed (yes/no). For those respondents who had an activity tracker app or smart watch, they were asked to provide their average weekly number of steps.  \n  \n  \n__Data Dictionary__\n\nThe data in `wellbeing_rural.csv` contain seven attributes collected from a random sample of $n=200$ hypothetical residents over Edinburgh & Lothians, and include: \n\n```{r echo=FALSE, message=FALSE, warning=FALSE}\nmwdata  <- read_csv(\"https://uoepsy.github.io/data/wellbeing_rural.csv\")\ntibble(\nvariable = names(mwdata),\ndescription = c(\"Age in years of respondent\",\"Self report estimated number of hours per week spent outdoors \", \"Self report estimated number of social interactions per week (both online and in-person)\", \"Binary 1=Yes/0=No response to the question 'Do you follow a daily routine throughout the week?'\", \"Warwick-Edinburgh Mental Wellbeing Scale (WEMWBS), a self-report measure of mental health and well-being. The scale is scored by summing responses to each item, with items answered on a 1 to 5 Likert scale. The minimum scale score is 14 and the maximum is 70\", \"Location of primary residence (City, Suburb, Rural)\", \"Average weekly number of steps in thousands (as given by activity tracker if available)\")\n) %>% gt::gt()\n```\n  \n  \n__Preview__\n\nThe first six rows of the data are:\n\n```{r echo=FALSE, message=FALSE}\nread_csv('https://uoepsy.github.io/data/wellbeing_rural.csv') %>% head %>% gt::gt()\n```\n  \n`r optend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Setup\n\n`r qbegin(\"Setup\", qlabel = FALSE)`  \n\n1. Create a new RMarkdown file\n2. Load the required package(s)\n3. Read the wellbeing dataset into R, assigning it to an object named `mwdata`\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n```{r message=FALSE}\n#Loading the required package(s)\nlibrary(tidyverse)\nlibrary(psych)\nlibrary(patchwork)\nlibrary(sjPlot)\nlibrary(kableExtra)\n\n# Reading in data and storing to an object named 'mwdata'\nmwdata <- read_csv(\"https://uoepsy.github.io/data/wellbeing_rural.csv\")\n```\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Exercises \n\n## Study & Analysis Plan Overview \n\n`r qbegin(1)`\n\nProvide a brief overview of the study design and data, before detailing your analysis plan to address the research question.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\n- Give the reader some background on the context of the study (you might be able to re-use some of the content you wrote for [Lab 1](https://uoepsy.github.io/dapr2/2324/labs/1_01_slr.html) here)\n- State what type of analysis you will conduct in order to address the research question\n- Specify the model to be fitted to address the research question \n- Specify your chosen significance ($\\alpha$) level\n- State your hypotheses\n\nMuch of the information required can be found in the [Study Overview] codebook.\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nThe `mwdata` dataset contained information on 200 hypothetical participants who lived in Edinburgh & Lothians area. Using a between-subjects design, the researchers collected information on participants' wellbeing (measured via WEMWBS), outdoor time (hours per week), social interactions (number per week), routine (whether or not one was followed), location of residence (City, Suburb, or Rural), average weekly steps (in thousands), and age (in years).\n\nDensity plots and boxplots will be used to visualise the marginal distributions of wellbeing, social interactions, and outdoor time. To understand the strength of association among the variables, we will estimate the the correlation coefficients. To address the research question of whether there is an association between wellbeing and time spent outdoors after taking into account the association between wellbeing and social interactions, we are going to fit the following multiple linear regression model:\n\n$$\n\\text{Wellbeing} = \\beta_0 + \\beta_1 \\cdot Social~Interactions + \\beta_2 \\cdot Outdoor~Time + \\epsilon\n$$\n\nEffects will be considered statistically significant at $\\alpha=.05$.\n\nOur hypotheses are:\n\n$H_0: \\beta_2 = 0$: There is no association between wellbeing and time spent outdoors after taking into account the association between wellbeing and social interactions\n\n$H_1: \\beta_2 \\neq 0$: There is an association between wellbeing and time spent outdoors after taking into account the association between wellbeing and social interactions\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Descriptive Statistics & Visualisations\n\n`r qbegin(2)`\n\nAlongside descriptive statistics, visualize the marginal distributions of the `wellbeing`, `outdoor_time`, and `social_int` variables. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\n*Code for tables & plots*\n- You might be able to re-use some of the code you wrote for [Lab 1](https://uoepsy.github.io/dapr2/2324/labs/1_01_slr.html) here, and remember that you can refer back to the [DAPR1 materials](https://uoepsy.github.io/dapr1/2223/index.html) too\n\n*Plot interpretation*  \n- The *shape*, *center* and *spread* of the distribution  \n- Whether the distribution is *symmetric* or *skewed*  \n- Whether the distribution is *unimodal* or *bimodal* \n\n*Plotting tips*  \n- Use `\\n` to wrap text in your titles and or axis labels  \n- The **patchwork** package allows us to arrange multiple plots in two ways - `|` arranges the plots adjacent to one another, and `/` arranges the plots on top of one another  \n\n*Table tips*  \n- The `describe()` function from the **psych** package will produce a table of descriptive statistics. If you would like only a subset of this output (e.g., mean, sd), you can use `select()` after calling `describe()` e.g., `describe() %>% select(mean, sd)`  \n- The **kableExtra** package allows us to produce well formatted tables for our descriptive statistics. To do so, you need to specify the `kable()` and `kable_styling()` arguments  \n- Review the guidance on the [rmd bootcamp](https://uoepsy.github.io//rmd-bootcamp/), particularly Lesson 4\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n::: {.panel-tabset}\n\n## Numeric\n\nWe can present our summary statistics for wellbeing, outdoor time, and social interactions as a well formatted table using `kable()`: \n\n```{r}\n#| label: tbl-w2-desc\n#| tbl-cap: Wellbeing, Social Interactions, and Outdoor Time Descriptive Statistics\nmwdata %>% \n  select(wellbeing, outdoor_time, social_int) %>%\n    describe() %>%\n    kable(caption = \"Wellbeing, Social Interactions, and Outdoor Time Descriptive Statistics\", align = \"c\", digits = 2, booktabs = TRUE) %>%\n    kable_styling(full_width = FALSE)\n\n```\n\n:::{.callout-important icon=false appearance=\"minimal\"}\n\n+ The marginal distribution of scores on the WEMWBS was unimodal with a mean of approximately `r round(mean(mwdata$wellbeing),2)`. There was variation in WEMWBS scores (SD = `r round(sd(mwdata$wellbeing),2)`)   \n+ The marginal distribution of weekly hours spent outdoors was unimodal with a mean of approximately `r round(mean(mwdata$outdoor_time),2)`. There was variation in weekly hours spent outdoors (SD = `r round(sd(mwdata$outdoor_time),2)`) \n+ The marginal distribution of numbers of social interactions per week was unimodal with a mean of approximately `r round(mean(mwdata$social_int),2)`. There was variation in numbers of social interactions (SD = `r round(sd(mwdata$social_int),2)`)\n\n:::\n\n## Visual\n\nYou should be familiar now with how to visualise a marginal distribution. You might choose histograms, density curves, or boxplots, or a combination:   \n```{r}\n#| label: fig-marg-dist\n#| fig-cap: \"Marginal distribution plots of wellbeing sores, weekly hours spent outdoors, and social interactions\"\n   \nwellbeing_plot <- \n  ggplot(data = mwdata, aes(x = wellbeing)) +\n  geom_density() +\n  geom_boxplot(width = 1/200) +\n  labs(x = \"Score on WEMWBS (range 14-70)\", y = \"Probability\\nDensity\")\n\noutdoortime_plot <- \n  ggplot(data = mwdata, aes(x = outdoor_time)) +\n  geom_density() +\n  geom_boxplot(width = 1/200) +\n  labs(x = \"Time spent outdoors per week (hours)\", y = \"Probability\\nDensity\")\n\nsocial_plot <- \n  ggplot(data = mwdata, aes(x = social_int)) +\n  geom_density() +\n  geom_boxplot(width = 1/200) +\n  labs(x = \"Number of social interactions per week\", y = \"Probability\\nDensity\")\n\n# arrange plots vertically \nwellbeing_plot / outdoortime_plot / social_plot\n```\n\n:::\n\n`r solend()`\n\n<br>\n\n`r qbegin(3)`\n\nProduce plots of the associations between the outcome variable (wellbeing) and each of the explanatory variables.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\n*Plot interpretation*    \n- *Direction* of association  \n- *Form* of association (can it be summarised well with a straight line?)  \n- *Strength* of association (how closely do points fall to a recognizable pattern such as a line?)  \n- *Unusual observations* that do not fit the pattern of the rest of the observations and which are worth examining in more detail  \n\n*Plot tips*  \n- use `\\n` to wrap text in your titles and or axis labels  \n- consider using `geom_smooth()` to  superimpose the best-fitting line describing the association of interest\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r message = FALSE, warning=FALSE}\n#| label: fig-marg-relationship\n#| fig-cap: \"Scatterplots displaying the relationships between scores on the WEMWBS and a) weekly outdoor time (hours), and b) weekly number of social interactions\"\nwellbeing_outdoor <- \n  ggplot(data = mwdata, aes(x = outdoor_time, y = wellbeing)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) + \n  labs(x = \"Time spent outdoors \\nper week (hours)\", y = \"Wellbeing score (WEMWBS)\")\n\nwellbeing_social <- \n  ggplot(data = mwdata, aes(x = social_int, y = wellbeing)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) + \n  labs(x = \"Number of social interactions \\nper week\", y = \"Wellbeing score (WEMWBS)\")\n\n# place plots adjacent to one another\nwellbeing_outdoor | wellbeing_social\n```\n\nBoth scatterplots indicated weak, positive, and linear associations both between wellbeing and outdoor time, and between wellbeing and the number of weekly social interactions.\n\n`r solend()`\n\n<br>\n  \n`r qbegin(4)`\nProduce a correlation matrix of the variables which are to be used in the analysis, and write a short paragraph describing the associations. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\n*Correlation Matrix*  \nReview [Lab 1 Q2](https://uoepsy.github.io/dapr2/2324/labs/1_01_slr.html#associations-among-variables) for guidance on how to produce a correlation matrix.\n\n*APA Format*  \nMake sure to round your numbers in-line with APA 7th edition guidelines as noted at the start of the lab (see 'Presenting Results'). The `round()` function will come in handy here. \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nWe can either index the dataframe or select the variables of interest:\n\n::: {.panel-tabset}\n\n## Index dataframe (`[]`)\n\n```{r}\n# correlation matrix of the three columns of interest (check which columns we need - in this case, 2,3, and 5)\nround(cor(mwdata[,c(5,3,2)]), digits = 2)\n```\n\n## Variable selection (`select()`)\n\n```{r}\n# select only the columns we want by variable name, and pass this to cor()\nmwdata %>% \n  select(wellbeing, social_int, outdoor_time) %>%\n  cor() %>%\n  round(digits = 2)\n```\n\n:::\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\n- There was a weak, positive, linear association between WEMWBS scores and weekly outdoor time for the participants in the sample ($r$ = .25). Higher number of hours spent outdoors each week was associated, on average, with higher wellbeing scores   \n- There was a weak, positive, linear association between WEMWBS scores and the weekly number of social interactions for the participants in the sample ($r$ = .24). More social interactions were associated, on average,  with higher wellbeing scores\n- There was a negligible negative correlation between weekly outdoor time and the weekly number of social interactions ($r$ = -.04)\n\n::: \n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Model Fitting & Interpretation \n\n`r qbegin(5)`\n\nRecall the model specified in Q1, and:  \n\n(1) State the _parameters_ of the model. How do we denote _parameter estimates_?  \n(2) Fit the linear model in using `lm()`, assigning the output to an object called `mdl1`. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nAs we did for simple linear regression, we can fit our multiple regression model using the `lm()` function. We can add as many explanatory (i.e., independent) variables as we like, separating them with a `+`. \n\n<code>\n**model name** <- lm(**dependent variable** ~ **independent variable 1** + **independent variable 2** + ..., data = **dataframe**)\n</code>\n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nA model for the association between $x_1$ = weekly numbers of social interactions, $x_2$ = weekly outdoor time, and $y$ = scores on the WEMWBS can be given by:\n$$\ny = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\epsilon \\\\ \\quad \\\\ \n\\text{where} \\quad \\epsilon \\sim N(0, \\sigma) \\text{ independently}\n$$\n\nIn the model specified above,\n\n- $\\mu_{y|x_1, x_2} = \\beta_0 + \\beta_1 x + \\beta_2 x_2$ represents the systematic part of the model giving the mean of $y$ at each combination of values of $x_1$ and $x_2$;\n- $\\epsilon$ represents the error (deviation) from that mean, and the errors are independent from one another.  \n  \n  \nThe parameters of our model are:\n\n+ $\\beta_0$ (The intercept);\n+ $\\beta_1$ (The slope across values of $x_1$);\n+ $\\beta_2$ (The slope across values of $x_2$);  \n+ $\\sigma$ (The standard deviation of the errors).\n\nWhen we estimate these parameters from the available data, we have a _fitted model_ (recall that the h$\\hat{\\textrm{a}}$ts are used to distinguish our _estimates_ from the _true unknown parameters_): \n\n$$\n\\widehat{Wellbeing} = \\hat \\beta_0 + \\hat \\beta_1 \\cdot Social~Interactions + \\hat \\beta_2 \\cdot Outdoor~Time \n$$\nAnd we have residuals $\\hat \\epsilon = y - \\hat y$ which are the deviations from the observed values and our model-predicted responses.  \n\nFitting the model in `R`:\n\n```{r}\nmdl1 <- lm(wellbeing ~ social_int + outdoor_time, data = mwdata)\n```\n\n`r solend()`\n\n<br>\n\n:::statbox\n__Visual__\n\nNote that for simple linear regression we talked about our model as a _line_ in 2 dimensions: the systematic part $\\beta_0 + \\beta_1 x$ defined a line for $\\mu_y$ across the possible values of $x$, with $\\epsilon$ as the random deviations from that line. But in multiple regression we have more than two variables making up our model. \n\nIn this particular case of three variables (one outcome + two explanatory), we can think of our model as a _regression surface_ (see @fig-reg-surface). The systematic part of our model defines the surface across a range of possible values of both $x_1$ *and* $x_2$. Deviations from the surface are determined by the random error component, $\\hat \\epsilon$.  \n\n```{r regsurf, echo=FALSE, out.width=\"100%\"}\n#| label: fig-reg-surface\n#| fig-cap: \"Regression surface for wellbeing ~  social_int + outdoor_time, from two different angles\"\n\nfit<-lm(wellbeing~outdoor_time+social_int, data=mwdata)\nsteps=50\noutdoor_time <- with(mwdata, seq(min(outdoor_time),max(outdoor_time),length=steps))\nsocial_int <- with(mwdata, seq(min(social_int),max(social_int),length=steps))\nnewdat <- expand.grid(outdoor_time=outdoor_time, social_int=social_int)\nwellbeing <- matrix(predict(fit, newdat), steps, steps)\n\n\npar(mfrow=c(1,2))\np <- persp(outdoor_time,social_int,wellbeing, theta = 35,phi=10, col = NA)\nobs <- with(mwdata, trans3d(outdoor_time,social_int, wellbeing, p))\npred <- with(mwdata, trans3d(outdoor_time, social_int, fitted(fit), p))\npoints(obs, col = \"red\", pch = 16)\n#points(pred, col = \"blue\", pch = 16)\nsegments(obs$x, obs$y, pred$x, pred$y)\n\np <- persp(outdoor_time,social_int,wellbeing, theta = -35,phi=10, col = NA)\nobs <- with(mwdata, trans3d(outdoor_time,social_int, wellbeing, p))\npred <- with(mwdata, trans3d(outdoor_time, social_int, fitted(fit), p))\npoints(obs, col = \"red\", pch = 16)\n#points(pred, col = \"blue\", pch = 16)\nsegments(obs$x, obs$y, pred$x, pred$y)\n\npar(mfrow=c(1,1))\n```\n\nDon't worry about trying to figure out how to visualise it if we had any more explanatory variables! We can only concieve of 3 spatial dimensions. One could imagine this surface changing over time, which would bring in a 4th dimension, but beyond that, it's not worth trying!\n\n:::\n\n<br>\n\n`r qbegin(6)`\nUsing any of:  \n\n- `mdl1`\n- `mdl1$coefficients`\n- `coef(mdl1)`\n- `coefficients(mdl1)`\n- `summary(mdl1)`\n\nWrite out the estimated parameter values of: \n\n1. $\\hat \\beta_0$, the estimated average wellbeing score associated with zero hours of outdoor time and zero social interactions per week.  \n2. $\\hat \\beta_1$, the estimated increase in average wellbeing score associated with an additional social interaction per week (an increase of one), _holding weekly outdoor time constant_.  \n3. $\\hat \\beta_2$, the estimated increase in average wellbeing score associated with one hour increase in weekly outdoor time, _holding the number of social interactions constant_ \n\n:::{.callout-note}\n# What do we mean by hold constant / controlling for / partialling out / residualizing for?\n\nWhen the remaining explanatory variables are held at the same value or are fixed.\n\n:::\n\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n::: {.panel-tabset}\n\n##mdl1\n```{r}\nmdl1\n```\n\n## mdl1$coefficients\n```{r}\nmdl1$coefficients\n```\n\n## coef(mdl1)\n```{r}\ncoef(mdl1)\n```\n\n## coefficients(mdl1)\n```{r}\ncoefficients(mdl1)\n```\n\n## summary(mdl1)\nLook under the “Estimate” column:\n```{r}\nsummary(mdl1)\n```\n\n:::\n\n1. $\\hat \\beta_0$ = `r round(coef(mdl1)[1],2)`  \n2. $\\hat \\beta_1$ = `r round(coef(mdl1)[2],2)`  \n3. $\\hat \\beta_2$ = `r round(coef(mdl1)[3],2)`  \n\n`r solend()`\n\n<br>\n\n`r qbegin(7)`\nWithin what distance from the model predicted values (the regression line) would we expect 95% of WEMWBS wellbeing scores to be?\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nEither `sigma()` or part of the output from `summary()` will help you here (see [Lab 1 Q5](https://uoepsy.github.io/dapr2/2324/labs/1_01_slr.html#model-specification-and-fitting) for a detailed explanation of $\\hat \\sigma$).  \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n::: {.panel-tabset}\n\n## sigma(mdl1) \n\n```{r}\nsigma(mdl1)\n```\n\n\n## summary(mdl1)\n\nLook at the \"Residual standard error\" entry of the `summary(mdl)` output:\n\n```{r}\nsummary(mdl1)\n```\n\n:::\n\nThe estimated standard deviation of the errors is $\\hat \\sigma$ = `r round(sigma(mdl1),2)`. We would expect 95% of wellbeing scores to be within about `r round(sigma(mdl1)*2,2)` ($2 \\hat \\sigma$) from the model fit. \n\n`r solend()`\n\n<br>\n\n`r qbegin(8)`\n\nBased on the model, predict the wellbeing scores for the following individuals who were not included in the original sample:\n\n- Leah: Social Interactions = 25; Outdoor Time = 3\n- Sean: Social Interactions = 19; Outdoor Time = 36\n- Mike: Social Interactions = 15; Outdoor Time = 20\n- Donna: Social Interactions = 7; Outdoor Time = 1\n\nWho has the highest predicted wellbeing score, and who has the lowest?\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nIt might be helpful to review the 'Model predicted values for other (unobserved data) from the [Predicted Values & Residuals of Lab 1](https://uoepsy.github.io/dapr2/2324/labs/1_01_slr.html#predicted-values-residuals).  \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nFirst we need to pass the data into R:\n```{r}\nwellbeing_query <- tibble(social_int = c(25, 19, 15, 7),\n                          outdoor_time = c(3, 36, 20, 1))\n```\n\nAnd next use `predict()` to get their estimated wellbeing scores:\n\n```{r}\npredict(mdl1, newdata = wellbeing_query)\n```\n\nSean has the highest predicted wellbeing score (42.15), and Donna the lowest (31.16). \n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Writing Up & Presenting Results\n\n`r qbegin(9)`\n\nProvide key model results in a formatted table.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nUse `tab_model()` from the __sjPlot__ package. \n\nYou can rename your DV and IV labels by specifying `dv.labels` and `pred.labels`. To do so, specify your variable name on the left, and what you would like this to be named in the table on the right. \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r}\n#| label: tbl-w3-modresults\n#| tbl-cap: Regression Table for Wellbeing Model\ntab_model(mdl1,\n          dv.labels = \"Wellbeing (WEMWBS Scores)\",\n          pred.labels = c(\"social_int\" = \"Social Interactions (number per week)\",\n                          \"outdoor_time\" = \"Outdoor Time (hours per week)\"),\n          title = \"Regression Table for Wellbeing Model\")\n```\n\n`r solend()`\n\n<br>\n\n`r qbegin(10)`\n\nInterpret your results in the context of the research question.\n\nMake reference to the your regression table.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nMake sure to include a decision in relation to your null hypothesis - based on the evidence, should you reject or fail to reject the null?  \n\n:::\n\n`r qend()`\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nFrom @fig-marg-dist, we can see that wellbeing $(M = `r round(mean(mwdata$wellbeing), 2)`, SD = `r round(sd(mwdata$wellbeing), 2)`)$, social interactions $(M = `r round(mean(mwdata$social_int), 2)`, SD = `r round(sd(mwdata$social_int), 2)`)$, and outdoor time $(M = `r round(mean(mwdata$outdoor_time), 2)`, SD = `r round(sd(mwdata$outdoor_time), 2)`)$ followed unimodal distributions. There were weak, positive, linear associations between WEMWBS scores and the weekly number of social interactions $(r = .24)$, and between WEMWBS scores and outdoor time $(r = .25)$ in the sample.\n\nA multiple regression model was used to determine if there was an association between well-being and time spent outdoors after taking into account the association between well-being and social interactions. As presented in @tbl-w3-modresults, outdoor time was significantly associated with wellbeing scores $(\\beta = 0.20, SE = 0.05, p < .001)$ after controlling for the number of weekly social interactions. Results suggested that, holding constant social interactions, for every additional hour spent outdoors each week, wellbeing scores increased by 0.20 points. Therefore, we should reject the null hypothesis since $p < .05$.\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Compile Report\n\n`r qbegin(\"Compile Report\", qlabel = FALSE)`  \n\nKnit your report to PDF, and check over your work. To do so, you should make sure:\n\n- Only the output you want your reader to see is visible (e.g., do you want to hide your code?)\n- Check that the **tinytex** package is installed\n- Ensure that the ‘yaml’ (bit at the very top of your document) looks something like this:\n\n```{}\n---\ntitle: \"this is my report title\"\nauthor: \"B1234506\"\ndate: \"07/09/2024\"\noutput: bookdown::pdf_document2\n---\n```\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n# What to do if you cannot knit to PDF\nIf you are having issues knitting directly to PDF, try the following:  \n\n- Knit to HTML file  \n- Open your HTML in a web-browser (e.g. Chrome, Firefox)  \n- Print to PDF (Ctrl+P, then choose to save to PDF)  \n- Open file to check formatting\n:::\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n# Hiding Code and/or Output\n\n:::{.panel-tabset}\n## Hiding R Code\n\nTo not show the code of an R code chunk, and only show the output, write:\n\n````\n```{{r, echo=FALSE}}\n# code goes here\n```\n````\n\n## Hiding R Output\n\nTo show the code of an R code chunk, but hide the output, write:\n\n````\n```{{r, results='hide'}}\n# code goes here\n```\n````\n\n## Hiding R Code and Output\n\nTo hide both code and output of an R code chunk, write:\n\n````\n```{{r, include=FALSE}}\n# code goes here\n```\n````\n:::\n\n:::\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Tinytex\nYou must make sure you have **tinytex** installed in R so that you can “Knit” your Rmd document to a PDF file:\n\n```{r eval = FALSE}\ninstall.packages(\"tinytex\")\ntinytex::install_tinytex()\n```\n\n:::\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\nYou should end up with a PDF file. If you have followed the above instructions and still have issues with knitting, speak with a Tutor. \n\n`r solend()`"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"include-in-header":["assets/toggling.html"],"number-sections":false,"output-file":"1_02_mlr.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.340","bibliography":["biblio.bib"],"toc_float":true,"code-annotations":"hover","link-citations":true,"theme":["united","assets/style-labs.scss"],"code-copy":false,"title":"Multiple Linear Regression","params":{"SHOW_SOLS":true,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}