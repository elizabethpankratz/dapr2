{"title":"Functions and Models","markdown":{"yaml":{"title":"Functions and Models","link-citations":true,"code-annotations":"hover","params":{"SHOW_SOLS":true,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"headingText":"knitr::opts_chunk$set(cache = TRUE)","containsRefs":false,"markdown":"\n\n\n```{r setup, include=FALSE}\nsource('assets/setup.R')\n\nset.seed(1)\n```\n\n:::lo\n\n### <i class=\"fa fa-graduation-cap\"></i> Learning Objectives\nAt the end of this lab, you will:\n\n1. Have reviewed the main concepts from introductory statistics.\n2. Understand the concept of a function.\n3. Be able to discuss what a statistical model is.\n4. Understand the link between models and functions.\n\n### <i class=\"fa fa-check-square-o fa-2\"></i> Requirements\n1. Have attended and/or watched Week 1 lectures.\n2. Have installed R and RStudio on your own computer (unless you have a Chromebook where you may continue to use the PPLS RStudio Server).\n\n### <i class=\"fab fa-r-project\"></i> Required R Packages\nRemember to load all packages within a code chunk at the start of your RMarkdown file using `library()`. If you do not have a package and need to install, do so within the console using `install.packages(\" \")`. For further guidance on installing/updating packages, see Section C [here](https://uoepsy.github.io/files/install-update-r#update-pkgs). \n\nFor this lab, you will need to load the following package(s):\n\n* **tidyverse**\n* **ggExtra**\n* **kableExtra**\n\n### <i class=\"fa fa-file\"></i> Lab Data\nYou can download the data required for this lab [here](https://uoepsy.github.io/data/handheight.csv) or read it in via this link https://uoepsy.github.io/data/handheight.csv. \n\n:::\n\n# Setup\n\n`r qbegin(\"Setup\", qlabel = FALSE)`  \n\n1. Create a new RMarkdown file\n2. Load the required package(s)\n3. Read the handheight dataset into `R`, assigning it to an object named `handheight`\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n```{r message=FALSE}\n#Loading the required package(s)\nlibrary(tidyverse)\nlibrary(ggExtra)\nlibrary(kableExtra)\n\n# Reading in data and storing to an object named 'handheight'\nhandheight <- read_csv('https://uoepsy.github.io/data/handheight.csv')\n```\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Refresher of Basic Terminology\n\n`r qbegin(1)`\n\nProvide a short definition for each of these terms. \n\n- (Observational) unit\n- Variable\n- Categorical variable\n- Numeric variable\n- Response/dependent variable\n- Explanatory/independent variable\n- Observational study\n- Experiment\n\nCheck the flashcards in the solution below to compare your definition. If you are not comfortable with one (or more) of the terms, revisit the [DAPR1 materials](https://uoepsy.github.io/dapr1/2223/) for a refresher.\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\n`r optbegin(\"(Observational) unit\", olabel=FALSE,toggle=params$TOGGLE)`\nThe individual entities on which data are collected.\n`r optend()`\n\n`r optbegin(\"Variable\", olabel=FALSE,toggle=params$TOGGLE)`\nAny characteristic recorded on the observational units.\n`r optend()`\n\n`r optbegin(\"Categorical variable\", olabel=FALSE,toggle=params$TOGGLE)`\nA categorical variable places units into one of several groups. Examples are country of birth, dominant hand, and eye colour.\n`r optend()`\n\n`r optbegin(\"Numeric variable\", olabel=FALSE,toggle=params$TOGGLE)`\nA variable that records a numerical quantity for each case. For such variables standard arithmetic operations make sense. For example, average height, IQ, and weight.\n`r optend()`\n\n`r optbegin(\"Response/dependent variable\", olabel=FALSE,toggle=params$TOGGLE)`\nA response variable (also called a dependent variable, or outcome variable) measures the outcome of interest in a study.\n`r optend()`\n\n`r optbegin(\"Explanatory/independent variable\", olabel=FALSE,toggle=params$TOGGLE)`\nExplanatory variables (also called independent variables or predictors) are used to explain differences/changes in the response variable.\n`r optend()`\n\n`r optbegin(\"Observational study\", olabel=FALSE,toggle=params$TOGGLE)`\nAn observational study is a study in which the researcher does not manipulate any of the variables involved in the study, but merely records the values as they naturally exist.\n`r optend()`\n\n`r optbegin(\"Experiment\", olabel=FALSE,toggle=params$TOGGLE)`\nAn experiment is a study in which the researcher imposes the values of the explanatory variable on the units before measuring the response variable.\n`r optend()`\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Functions and Mathematical Models\n\n`r qbegin(2)`\nConsider the function $y = 2 + 5 \\ x$.\n\n- Identify the dependent variable (DV)\n- Identify the independent variable (IV)\n- Describe in words what the function does, and compute the output for the following input:\n\n$$\nx = \\begin{bmatrix}\n2 \\\\\n6\n\\end{bmatrix}\n$$\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\nThe function says that the $y$ value is obtained as a transformation of the $x$ value.\n\n- The dependent variable is $y$\n- The independent variable is $x$\n- The $y$ value is obtained as five times $x$, plus two.\n\n<br />\nExample (1): If $x$ equals 2, the corresponding value of $y$ will be $2 + 5 * 2 = 12$.\n<br />\nExample (2): If $x$ equals 6, the corresponding value of $y$ will be $2 + 5 * 6 = 32$.\n$$\ny = \\begin{bmatrix}\n2 + 5 * 2 \\\\\n2 + 5 * 6\n\\end{bmatrix}\n= \\begin{bmatrix}\n12 \\\\\n32\n\\end{bmatrix}\n$$\n`r solend()`\n\n<br>\n\n`r qbegin(3)`\nWrite down in words and in symbols the function describing the relationship between the side of a square and its perimeter.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nWe are interested in how the perimeter varies as a function of its side. Hence, the perimeter is the dependent variable, and the side is the independent variable.\n\n:::\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n**In words:**\n\nThe perimeter of a square is four times the length of its side.\n\n<br />\n**In symbols:**\n\nThe relationship between side and perimeter of squares is given by:\n$$\nPerimeter = 4 * Side\n$$\n\nIf you denote $y$ as the dependent variable _Perimeter_, and $x$ as the independent variable _Side_ we cam write rewrite as: \n$$\ny = 4 * x\n$$\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Functions and Mathematical Models: Plots\n\n`r qbegin(4)`\n\nCreate a data set called `squares` containing the perimeter of four squares having sides of length $0, 2, 5, 9$ metres, and then plot the `squares` data as points on a scatterplot. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nRemember that to combine multiple numbers together we use the function `c()`. \n\n:::\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\nFirst, let's make our squares data:\n```{r}\nsquares <- tibble(\n  side = c(0, 2, 5, 9), \n  perimeter = 4 * side\n)\n\nsquares\n```\n\nNext, lets plot it:\n```{r}\n#| label: fig-squares\n\nggplot(data = squares, aes(x = side, y = perimeter)) +\n  geom_point() +   #specify `geom_point' as want to create a scatterplot\n  labs(x = 'Side (m)', y = 'Perimeter (m)')    #label x- and y-axis with new and clearer titles\n```\n\n`r solend()`\n\n<br>\n\n`r qbegin(5)`\nGenerate one hundred data points, and use them to visualise the relationship between side and perimeter of squares. To do so, you need to complete four steps:\n\n- Create a sequence of one hundred side lengths (x) going from 0 to 3 metres.\n- Compute the corresponding perimeters (y).\n- Plot the side and perimeter data as points on a graph.\n- Visualise the functional relationship between side and perimeter of squares. To do so, use the function `geom_line()` to connect the computed points with lines. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nTo create a sequence of numbers, we can use the function `seq()`. We need to include within the `seq()` argument our `from` and `to` values (i.e., the lowest and highest values in the sequence), as well as `length.out` to specify the length of the sequence (i.e., how many 0-3's do we want).  \n\nIf you would like to change the colour of the line (step 4), you can specify `geom_line(colour = \"insert_colour\")` \n\n:::\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\nSteps 1 & 2 - create the side and perimeter data:\n```{r}\nsquares_grid <- tibble(\n  side = seq(0, 3, length.out = 100),\n  perimeter = 4 * side)\n```\n\nStep 3 - plot the individual points:\n```{r}\n\nggplot(data = squares_grid, aes(x = side, y = perimeter)) +\n  geom_point() +\n  labs(x = 'Side (m)', y = 'Perimeter (m)', title = 'Perimeter = 4*Side')\n```\n\nStep 4 - visualise the functional relationship by connecting the individual points with a line:\n```{r}\nggplot(data = squares_grid, aes(x = side, y = perimeter)) +\n  geom_point() +\n  geom_line(colour = 'blue') +\n  labs(x = 'Side (m)', y = 'Perimeter (m)', title = 'Perimeter = 4*Side')\n```\n\n:::{.callout-note appearance=\"simple\" collapse=\"true\"}\n\n**Note**\n\nThe function $y = 4 \\ x$ that you plotted above is an example of a function representing a *mathematical model*.\n\nWe typically validate a model using experimental data. However, we all know how squares work and that two squares with the same side will have the same perimeter (more on this later).\n\n:::\n\n`r solend()`\n\n<br>\n\n`r qbegin(6)`\nThe Scottish National Gallery kindly provided us with measurements of side and perimeter (in metres) for a sample of 10 square paintings.\n\nThe data are provided below:\n```{r eval=FALSE}\nsng <- tibble(\n  side = c(1.3, 0.75, 2, 0.5, 0.3, 1.1, 2.3, 0.85, 1.1, 0.2),\n  perimeter = c(5.2, 3.0, 8.0, 2.0, 1.2, 4.4, 9.2, 3.4, 4.4, 0.8)\n)\n```\n\nPlot the mathematical model of the relationship between side and perimeter for squares, and superimpose on top the experimental data from the Scottish National Gallery.\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n```{r}\n#| label: fig-squares-scatterplot\n#| fig-cap: \"The exact relationship between side and perimeter of squares\"\n\nsng <- tibble( # <11>\n  side = c(1.3, 0.75, 2, 0.5, 0.3, 1.1, 2.3, 0.85, 1.1, 0.2),  # <11>\n  perimeter = c(5.2, 3.0, 8.0, 2.0, 1.2, 4.4, 9.2, 3.4, 4.4, 0.8) # <11>\n) # <11>\n\nggplot() + \n  geom_line(data = squares_grid, aes(x = side, y = perimeter), colour = 'blue') + # add blue line\n  geom_point(data = sng, aes(x = side, y = perimeter), colour = 'black',  # add black points\n             alpha = 0.5, size = 3) + # make the points 0.5 transparency, size 3\n  labs(x = 'Side (m)', y = 'Perimeter (m)')\n```\n\nThe above plot shows perfect agreement between the observed data and the model.\n\n`r solend()`\n\n<br>\n\n`r qbegin(7)`\nUse the mathematical model to predict the perimeter of a painting with a side of 1.5 metres.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nDon't forget to always include the measurement units when reporting/writing-up results!\n\n:::\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\nWe do not have a painting with a side of 1.5 metres within the random sample of paintings from the Scottish National Gallery.\nHowever, we can **predict** the perimeter of an unobserved squared painting having a 1.5 metre side using the mathematical model.\n\nYou can obtain this prediction using either a visual approach or an algebraic one.\n\n::: {.panel-tabset}\n\n## Visual Approach\n\n```{r echo=FALSE}\nggplot() +\n  geom_line(data = squares_grid, aes(x = side, y = perimeter), colour = 'blue') +\n  geom_point(data = sng, aes(x = side, y = perimeter), colour = 'black', \n             alpha = 0.5, size = 3) +\n  geom_segment(aes(x = 1.5, xend = 1.5, y = 0, yend = 4 * 1.5), linetype = 2, \n               colour = 'red', arrow = arrow(length = unit(0.5, \"cm\"))) +\n  geom_segment(aes(x = 1.5, xend = 0 , y = 4 * 1.5, yend = 4 * 1.5), linetype = 2, \n               colour = 'red', arrow = arrow(length = unit(0.5, \"cm\"))) +\n  labs(x = 'Side (m)', y = 'Perimeter (m)')\n```\n\nSometimes we can directly read a predicted value from the graph of the functional relationship.\n\nConsider the plot created in the previous question. First, we need to check where x = 1.5. Then, we draw a vertical dashed line until it meets the blue line. The y value corresponding to x = 1.5 can be read off the y-axis.\n\nHowever, in this case it is not that easy to read it from the drawing...\n\n## Algebraic Approach\n\nYou can substitute the x value in the formula and calculate the corresponding y value.\n$$\ny = 4 * x = 4 * 1.5 = 6\n$$\n:::\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\nThe predicted perimeter of squared paintings having a 1.5m side is 6m.\n\n:::\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Statistical Models\n\n## Study Overview \n\n> **Research Question**\n> \n> How does handspan vary as a function of height?  \n\nConsider now the association between height (in inches) and handspan (in cm). @Utts2015 provided data for a sample of 167 students which reported their height and handspan as part of a class survey. \n\nUsing the `handheight` data you already loaded at the start of the lab, your task is to investigate how handspan varies as a function of height for the students in the sample.\n\n`r optbegin(\"Handheight codebook.\", olabel=FALSE, toggle=params$TOGGLE)` \n\n__Description__\n\nThe data set records the height and handspan reported by a random sample of 167 students as part of a class survey.\n\nThe variables are:\n\n- `height`, measured in inches\n- `handspan`, measured in centimetres\n\n__Preview__\n\nThe first six rows of the data are:\n\n```{r echo=FALSE, message = FALSE}\nhandheight <- read_csv(file = 'https://uoepsy.github.io/data/handheight.csv')\nkable(head(handheight), align = 'c') %>%\n  kable_styling(full_width = FALSE) %>%\n  column_spec(1:2, width = '10em')\n```\n`r optend()`\n\n<br>\n\n`r qbegin(8)`\nUsing a scatterplot (since the variables are numeric and continuous) to visualise the association between the two numeric variables, comment on any main differences you notice with the association between side and perimeter of squares. Note if you detected outliers or points that do not fit with the pattern in the rest of the data.\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\n```{r}\n#| label: fig-simple-scatter\n#| fig-cap: \"Simple Scatterplot\"\n\nplt <- ggplot(handheight, aes(x = height, y = handspan)) +\n  geom_point(size = 3, alpha = 0.5) +\n  labs(x = 'Height (in.)', y = 'Handspan (cm)')\n\nplt\n\n```\n\nWe can also add marginal boxplots for each variable using the package `ggExtra`.\n\n```{r}\n#| label: fig-handheight-scatterplot\n#| fig-cap: \"The statistical relationship between height and handspan\"\n\nggMarginal(plt, type = 'boxplot')\n```\n\nOutliers are extreme observations that are not possible values of a variable or that do not seem to fit with the rest of the data. This could either be:\n\n- *marginally* along one axis: points that have an unusual (too high or too low) x-coordinate or y-coordinate;\n- *jointly*: observations that do not fit with the rest of the point cloud.\n\nThe boxplots in @fig-handheight-scatterplot do not highlight any outliers in the marginal distributions of height and handspan.\nFurthermore, from the scatterplot we do not notice any extreme observations or points that do not fit with the rest of the point cloud.\n\nWe notice a moderate, positive linear association between height and handspan.\n\nRecall @fig-squares-scatterplot, displaying the association between side and perimeters of squares.\nIn the plot we notice two points on top of each other, reflecting the fact that two squares having the same side will always have the same perimeter.\nIn fact, the data from the Scottish National Gallery include two squared paintings with a side of 1.1m, both having a measured perimeter of 4.4m.\n\n@fig-handheight-scatterplot, instead, displays the association between height and handspan of a sample of students. The first thing that grabs our attention is the fact that students having the same height do not necessarily have the same handspan. Rather, we clearly see a variety of handspan values for students all having a height of, for example, 70in. To be more precise, the seven students who are 70 in. tall all have differing handspans.\n`r solend()`\n\n<br>\n\n`r qbegin(9)`\nUsing the following command, superimpose on top of the scatterplot a best-fit line describing how handspan varies as a function of height.\nFor the moment, the argument `se = FALSE` tells R to not display uncertainty bands.\n\n```{r eval=FALSE, echo=TRUE}\ngeom_smooth(method = lm, se = FALSE)\n```\n\nComment on any differences between the lines representing the linear relationship between (a) the side and perimeter of square and (b) height and handspan.\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n```{r message = FALSE}\n#| label: fig-handheight-fitted-model\n#| fig-cap: \"The best-fit line\"\n\nggplot(handheight, aes(x = height, y = handspan)) +\n  geom_point(size = 3, alpha = 0.5) +\n  geom_smooth(method = lm, se = FALSE) +\n  labs(x = 'Height (in.)', y = 'Handspan (cm)')\n```\n\nThe line representing the relationship between side and perimeter of squares is able to predict the actual perimeter value from the measurement of the side of a square.\nThis is possible because the relationship between side and perimeter is an **exact** one. \n\nThat is, any squares having the same side will have the same perimeter, and there will be no variation in those values.\n\nThe line that best fits the relationship between height and handspan (see @fig-handheight-fitted-model), instead, is only able to predict the **average** handspan for a given value of height.\n\nThis is because there will be a distribution of handspans at each value of height.\nThe line will fit the trend/pattern in the values, but there will be individual-to-individual variability that we must accept around that average pattern.\n`r solend()`\n\n<br>\n\n`r qbegin(10)`\n```{r eval=FALSE, echo=FALSE}\nmdl <- lm(handspan ~ 1 + height, data = handheight)\nequatiomatic::extract_eq(mdl, ital_vars = TRUE, use_coefs = TRUE)\n```\n\nThe line of best-fit is given by:^[Yes, the error term is gone. This is because the line of best-fit gives you the prediction of the average handspan for a given height, and not the individual handspan of a person, which will almost surely be different from the prediction of the line.]\n\n$$\n\\widehat{Handspan} = -3 + 0.35 \\cdot Height\n$$\n\nEstimate (or predict) handspan of a student who is (a) 73in tall, and (b) 5in tall. \n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n- The predicted average handspan for students who are 73in tall is:\n<br />\n$-3 + (0.35 * 73) = 22.55$cm.\n<br />\n<br />\n- The predicted average handspan for students who are 5in tall is:\n<br />\n$-3 + (0.35 * 5) = -1.25$cm. \n\n\nBut wait, handspan can not be negative... This *does not* make any sense!\nThat's right, we went too far off the range of the available data on heights, which were between 57in and 78in. We extrapolated. This is very dangerous...\n\n```{r, echo=FALSE, fig.cap = 'Source: Randall Munroe, xkcd.com'}\nknitr::include_graphics('https://imgs.xkcd.com/comics/extrapolating.png')\n```\n`r solend()`\n","srcMarkdownNoYaml":"\n\n\n```{r setup, include=FALSE}\nsource('assets/setup.R')\n\n# knitr::opts_chunk$set(cache = TRUE)\nset.seed(1)\n```\n\n:::lo\n\n### <i class=\"fa fa-graduation-cap\"></i> Learning Objectives\nAt the end of this lab, you will:\n\n1. Have reviewed the main concepts from introductory statistics.\n2. Understand the concept of a function.\n3. Be able to discuss what a statistical model is.\n4. Understand the link between models and functions.\n\n### <i class=\"fa fa-check-square-o fa-2\"></i> Requirements\n1. Have attended and/or watched Week 1 lectures.\n2. Have installed R and RStudio on your own computer (unless you have a Chromebook where you may continue to use the PPLS RStudio Server).\n\n### <i class=\"fab fa-r-project\"></i> Required R Packages\nRemember to load all packages within a code chunk at the start of your RMarkdown file using `library()`. If you do not have a package and need to install, do so within the console using `install.packages(\" \")`. For further guidance on installing/updating packages, see Section C [here](https://uoepsy.github.io/files/install-update-r#update-pkgs). \n\nFor this lab, you will need to load the following package(s):\n\n* **tidyverse**\n* **ggExtra**\n* **kableExtra**\n\n### <i class=\"fa fa-file\"></i> Lab Data\nYou can download the data required for this lab [here](https://uoepsy.github.io/data/handheight.csv) or read it in via this link https://uoepsy.github.io/data/handheight.csv. \n\n:::\n\n# Setup\n\n`r qbegin(\"Setup\", qlabel = FALSE)`  \n\n1. Create a new RMarkdown file\n2. Load the required package(s)\n3. Read the handheight dataset into `R`, assigning it to an object named `handheight`\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n```{r message=FALSE}\n#Loading the required package(s)\nlibrary(tidyverse)\nlibrary(ggExtra)\nlibrary(kableExtra)\n\n# Reading in data and storing to an object named 'handheight'\nhandheight <- read_csv('https://uoepsy.github.io/data/handheight.csv')\n```\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Refresher of Basic Terminology\n\n`r qbegin(1)`\n\nProvide a short definition for each of these terms. \n\n- (Observational) unit\n- Variable\n- Categorical variable\n- Numeric variable\n- Response/dependent variable\n- Explanatory/independent variable\n- Observational study\n- Experiment\n\nCheck the flashcards in the solution below to compare your definition. If you are not comfortable with one (or more) of the terms, revisit the [DAPR1 materials](https://uoepsy.github.io/dapr1/2223/) for a refresher.\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\n`r optbegin(\"(Observational) unit\", olabel=FALSE,toggle=params$TOGGLE)`\nThe individual entities on which data are collected.\n`r optend()`\n\n`r optbegin(\"Variable\", olabel=FALSE,toggle=params$TOGGLE)`\nAny characteristic recorded on the observational units.\n`r optend()`\n\n`r optbegin(\"Categorical variable\", olabel=FALSE,toggle=params$TOGGLE)`\nA categorical variable places units into one of several groups. Examples are country of birth, dominant hand, and eye colour.\n`r optend()`\n\n`r optbegin(\"Numeric variable\", olabel=FALSE,toggle=params$TOGGLE)`\nA variable that records a numerical quantity for each case. For such variables standard arithmetic operations make sense. For example, average height, IQ, and weight.\n`r optend()`\n\n`r optbegin(\"Response/dependent variable\", olabel=FALSE,toggle=params$TOGGLE)`\nA response variable (also called a dependent variable, or outcome variable) measures the outcome of interest in a study.\n`r optend()`\n\n`r optbegin(\"Explanatory/independent variable\", olabel=FALSE,toggle=params$TOGGLE)`\nExplanatory variables (also called independent variables or predictors) are used to explain differences/changes in the response variable.\n`r optend()`\n\n`r optbegin(\"Observational study\", olabel=FALSE,toggle=params$TOGGLE)`\nAn observational study is a study in which the researcher does not manipulate any of the variables involved in the study, but merely records the values as they naturally exist.\n`r optend()`\n\n`r optbegin(\"Experiment\", olabel=FALSE,toggle=params$TOGGLE)`\nAn experiment is a study in which the researcher imposes the values of the explanatory variable on the units before measuring the response variable.\n`r optend()`\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Functions and Mathematical Models\n\n`r qbegin(2)`\nConsider the function $y = 2 + 5 \\ x$.\n\n- Identify the dependent variable (DV)\n- Identify the independent variable (IV)\n- Describe in words what the function does, and compute the output for the following input:\n\n$$\nx = \\begin{bmatrix}\n2 \\\\\n6\n\\end{bmatrix}\n$$\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\nThe function says that the $y$ value is obtained as a transformation of the $x$ value.\n\n- The dependent variable is $y$\n- The independent variable is $x$\n- The $y$ value is obtained as five times $x$, plus two.\n\n<br />\nExample (1): If $x$ equals 2, the corresponding value of $y$ will be $2 + 5 * 2 = 12$.\n<br />\nExample (2): If $x$ equals 6, the corresponding value of $y$ will be $2 + 5 * 6 = 32$.\n$$\ny = \\begin{bmatrix}\n2 + 5 * 2 \\\\\n2 + 5 * 6\n\\end{bmatrix}\n= \\begin{bmatrix}\n12 \\\\\n32\n\\end{bmatrix}\n$$\n`r solend()`\n\n<br>\n\n`r qbegin(3)`\nWrite down in words and in symbols the function describing the relationship between the side of a square and its perimeter.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nWe are interested in how the perimeter varies as a function of its side. Hence, the perimeter is the dependent variable, and the side is the independent variable.\n\n:::\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n**In words:**\n\nThe perimeter of a square is four times the length of its side.\n\n<br />\n**In symbols:**\n\nThe relationship between side and perimeter of squares is given by:\n$$\nPerimeter = 4 * Side\n$$\n\nIf you denote $y$ as the dependent variable _Perimeter_, and $x$ as the independent variable _Side_ we cam write rewrite as: \n$$\ny = 4 * x\n$$\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Functions and Mathematical Models: Plots\n\n`r qbegin(4)`\n\nCreate a data set called `squares` containing the perimeter of four squares having sides of length $0, 2, 5, 9$ metres, and then plot the `squares` data as points on a scatterplot. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nRemember that to combine multiple numbers together we use the function `c()`. \n\n:::\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\nFirst, let's make our squares data:\n```{r}\nsquares <- tibble(\n  side = c(0, 2, 5, 9), \n  perimeter = 4 * side\n)\n\nsquares\n```\n\nNext, lets plot it:\n```{r}\n#| label: fig-squares\n\nggplot(data = squares, aes(x = side, y = perimeter)) +\n  geom_point() +   #specify `geom_point' as want to create a scatterplot\n  labs(x = 'Side (m)', y = 'Perimeter (m)')    #label x- and y-axis with new and clearer titles\n```\n\n`r solend()`\n\n<br>\n\n`r qbegin(5)`\nGenerate one hundred data points, and use them to visualise the relationship between side and perimeter of squares. To do so, you need to complete four steps:\n\n- Create a sequence of one hundred side lengths (x) going from 0 to 3 metres.\n- Compute the corresponding perimeters (y).\n- Plot the side and perimeter data as points on a graph.\n- Visualise the functional relationship between side and perimeter of squares. To do so, use the function `geom_line()` to connect the computed points with lines. \n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nTo create a sequence of numbers, we can use the function `seq()`. We need to include within the `seq()` argument our `from` and `to` values (i.e., the lowest and highest values in the sequence), as well as `length.out` to specify the length of the sequence (i.e., how many 0-3's do we want).  \n\nIf you would like to change the colour of the line (step 4), you can specify `geom_line(colour = \"insert_colour\")` \n\n:::\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\nSteps 1 & 2 - create the side and perimeter data:\n```{r}\nsquares_grid <- tibble(\n  side = seq(0, 3, length.out = 100),\n  perimeter = 4 * side)\n```\n\nStep 3 - plot the individual points:\n```{r}\n\nggplot(data = squares_grid, aes(x = side, y = perimeter)) +\n  geom_point() +\n  labs(x = 'Side (m)', y = 'Perimeter (m)', title = 'Perimeter = 4*Side')\n```\n\nStep 4 - visualise the functional relationship by connecting the individual points with a line:\n```{r}\nggplot(data = squares_grid, aes(x = side, y = perimeter)) +\n  geom_point() +\n  geom_line(colour = 'blue') +\n  labs(x = 'Side (m)', y = 'Perimeter (m)', title = 'Perimeter = 4*Side')\n```\n\n:::{.callout-note appearance=\"simple\" collapse=\"true\"}\n\n**Note**\n\nThe function $y = 4 \\ x$ that you plotted above is an example of a function representing a *mathematical model*.\n\nWe typically validate a model using experimental data. However, we all know how squares work and that two squares with the same side will have the same perimeter (more on this later).\n\n:::\n\n`r solend()`\n\n<br>\n\n`r qbegin(6)`\nThe Scottish National Gallery kindly provided us with measurements of side and perimeter (in metres) for a sample of 10 square paintings.\n\nThe data are provided below:\n```{r eval=FALSE}\nsng <- tibble(\n  side = c(1.3, 0.75, 2, 0.5, 0.3, 1.1, 2.3, 0.85, 1.1, 0.2),\n  perimeter = c(5.2, 3.0, 8.0, 2.0, 1.2, 4.4, 9.2, 3.4, 4.4, 0.8)\n)\n```\n\nPlot the mathematical model of the relationship between side and perimeter for squares, and superimpose on top the experimental data from the Scottish National Gallery.\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n```{r}\n#| label: fig-squares-scatterplot\n#| fig-cap: \"The exact relationship between side and perimeter of squares\"\n\nsng <- tibble( # <11>\n  side = c(1.3, 0.75, 2, 0.5, 0.3, 1.1, 2.3, 0.85, 1.1, 0.2),  # <11>\n  perimeter = c(5.2, 3.0, 8.0, 2.0, 1.2, 4.4, 9.2, 3.4, 4.4, 0.8) # <11>\n) # <11>\n\nggplot() + \n  geom_line(data = squares_grid, aes(x = side, y = perimeter), colour = 'blue') + # add blue line\n  geom_point(data = sng, aes(x = side, y = perimeter), colour = 'black',  # add black points\n             alpha = 0.5, size = 3) + # make the points 0.5 transparency, size 3\n  labs(x = 'Side (m)', y = 'Perimeter (m)')\n```\n\nThe above plot shows perfect agreement between the observed data and the model.\n\n`r solend()`\n\n<br>\n\n`r qbegin(7)`\nUse the mathematical model to predict the perimeter of a painting with a side of 1.5 metres.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nDon't forget to always include the measurement units when reporting/writing-up results!\n\n:::\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\nWe do not have a painting with a side of 1.5 metres within the random sample of paintings from the Scottish National Gallery.\nHowever, we can **predict** the perimeter of an unobserved squared painting having a 1.5 metre side using the mathematical model.\n\nYou can obtain this prediction using either a visual approach or an algebraic one.\n\n::: {.panel-tabset}\n\n## Visual Approach\n\n```{r echo=FALSE}\nggplot() +\n  geom_line(data = squares_grid, aes(x = side, y = perimeter), colour = 'blue') +\n  geom_point(data = sng, aes(x = side, y = perimeter), colour = 'black', \n             alpha = 0.5, size = 3) +\n  geom_segment(aes(x = 1.5, xend = 1.5, y = 0, yend = 4 * 1.5), linetype = 2, \n               colour = 'red', arrow = arrow(length = unit(0.5, \"cm\"))) +\n  geom_segment(aes(x = 1.5, xend = 0 , y = 4 * 1.5, yend = 4 * 1.5), linetype = 2, \n               colour = 'red', arrow = arrow(length = unit(0.5, \"cm\"))) +\n  labs(x = 'Side (m)', y = 'Perimeter (m)')\n```\n\nSometimes we can directly read a predicted value from the graph of the functional relationship.\n\nConsider the plot created in the previous question. First, we need to check where x = 1.5. Then, we draw a vertical dashed line until it meets the blue line. The y value corresponding to x = 1.5 can be read off the y-axis.\n\nHowever, in this case it is not that easy to read it from the drawing...\n\n## Algebraic Approach\n\nYou can substitute the x value in the formula and calculate the corresponding y value.\n$$\ny = 4 * x = 4 * 1.5 = 6\n$$\n:::\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\nThe predicted perimeter of squared paintings having a 1.5m side is 6m.\n\n:::\n\n`r solend()`\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Statistical Models\n\n## Study Overview \n\n> **Research Question**\n> \n> How does handspan vary as a function of height?  \n\nConsider now the association between height (in inches) and handspan (in cm). @Utts2015 provided data for a sample of 167 students which reported their height and handspan as part of a class survey. \n\nUsing the `handheight` data you already loaded at the start of the lab, your task is to investigate how handspan varies as a function of height for the students in the sample.\n\n`r optbegin(\"Handheight codebook.\", olabel=FALSE, toggle=params$TOGGLE)` \n\n__Description__\n\nThe data set records the height and handspan reported by a random sample of 167 students as part of a class survey.\n\nThe variables are:\n\n- `height`, measured in inches\n- `handspan`, measured in centimetres\n\n__Preview__\n\nThe first six rows of the data are:\n\n```{r echo=FALSE, message = FALSE}\nhandheight <- read_csv(file = 'https://uoepsy.github.io/data/handheight.csv')\nkable(head(handheight), align = 'c') %>%\n  kable_styling(full_width = FALSE) %>%\n  column_spec(1:2, width = '10em')\n```\n`r optend()`\n\n<br>\n\n`r qbegin(8)`\nUsing a scatterplot (since the variables are numeric and continuous) to visualise the association between the two numeric variables, comment on any main differences you notice with the association between side and perimeter of squares. Note if you detected outliers or points that do not fit with the pattern in the rest of the data.\n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n\n```{r}\n#| label: fig-simple-scatter\n#| fig-cap: \"Simple Scatterplot\"\n\nplt <- ggplot(handheight, aes(x = height, y = handspan)) +\n  geom_point(size = 3, alpha = 0.5) +\n  labs(x = 'Height (in.)', y = 'Handspan (cm)')\n\nplt\n\n```\n\nWe can also add marginal boxplots for each variable using the package `ggExtra`.\n\n```{r}\n#| label: fig-handheight-scatterplot\n#| fig-cap: \"The statistical relationship between height and handspan\"\n\nggMarginal(plt, type = 'boxplot')\n```\n\nOutliers are extreme observations that are not possible values of a variable or that do not seem to fit with the rest of the data. This could either be:\n\n- *marginally* along one axis: points that have an unusual (too high or too low) x-coordinate or y-coordinate;\n- *jointly*: observations that do not fit with the rest of the point cloud.\n\nThe boxplots in @fig-handheight-scatterplot do not highlight any outliers in the marginal distributions of height and handspan.\nFurthermore, from the scatterplot we do not notice any extreme observations or points that do not fit with the rest of the point cloud.\n\nWe notice a moderate, positive linear association between height and handspan.\n\nRecall @fig-squares-scatterplot, displaying the association between side and perimeters of squares.\nIn the plot we notice two points on top of each other, reflecting the fact that two squares having the same side will always have the same perimeter.\nIn fact, the data from the Scottish National Gallery include two squared paintings with a side of 1.1m, both having a measured perimeter of 4.4m.\n\n@fig-handheight-scatterplot, instead, displays the association between height and handspan of a sample of students. The first thing that grabs our attention is the fact that students having the same height do not necessarily have the same handspan. Rather, we clearly see a variety of handspan values for students all having a height of, for example, 70in. To be more precise, the seven students who are 70 in. tall all have differing handspans.\n`r solend()`\n\n<br>\n\n`r qbegin(9)`\nUsing the following command, superimpose on top of the scatterplot a best-fit line describing how handspan varies as a function of height.\nFor the moment, the argument `se = FALSE` tells R to not display uncertainty bands.\n\n```{r eval=FALSE, echo=TRUE}\ngeom_smooth(method = lm, se = FALSE)\n```\n\nComment on any differences between the lines representing the linear relationship between (a) the side and perimeter of square and (b) height and handspan.\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n```{r message = FALSE}\n#| label: fig-handheight-fitted-model\n#| fig-cap: \"The best-fit line\"\n\nggplot(handheight, aes(x = height, y = handspan)) +\n  geom_point(size = 3, alpha = 0.5) +\n  geom_smooth(method = lm, se = FALSE) +\n  labs(x = 'Height (in.)', y = 'Handspan (cm)')\n```\n\nThe line representing the relationship between side and perimeter of squares is able to predict the actual perimeter value from the measurement of the side of a square.\nThis is possible because the relationship between side and perimeter is an **exact** one. \n\nThat is, any squares having the same side will have the same perimeter, and there will be no variation in those values.\n\nThe line that best fits the relationship between height and handspan (see @fig-handheight-fitted-model), instead, is only able to predict the **average** handspan for a given value of height.\n\nThis is because there will be a distribution of handspans at each value of height.\nThe line will fit the trend/pattern in the values, but there will be individual-to-individual variability that we must accept around that average pattern.\n`r solend()`\n\n<br>\n\n`r qbegin(10)`\n```{r eval=FALSE, echo=FALSE}\nmdl <- lm(handspan ~ 1 + height, data = handheight)\nequatiomatic::extract_eq(mdl, ital_vars = TRUE, use_coefs = TRUE)\n```\n\nThe line of best-fit is given by:^[Yes, the error term is gone. This is because the line of best-fit gives you the prediction of the average handspan for a given height, and not the individual handspan of a person, which will almost surely be different from the prediction of the line.]\n\n$$\n\\widehat{Handspan} = -3 + 0.35 \\cdot Height\n$$\n\nEstimate (or predict) handspan of a student who is (a) 73in tall, and (b) 5in tall. \n\n`r qend()`\n\n`r solbegin(show = params$SHOW_SOLS, toggle = params$TOGGLE)`\n- The predicted average handspan for students who are 73in tall is:\n<br />\n$-3 + (0.35 * 73) = 22.55$cm.\n<br />\n<br />\n- The predicted average handspan for students who are 5in tall is:\n<br />\n$-3 + (0.35 * 5) = -1.25$cm. \n\n\nBut wait, handspan can not be negative... This *does not* make any sense!\nThat's right, we went too far off the range of the available data on heights, which were between 57in and 78in. We extrapolated. This is very dangerous...\n\n```{r, echo=FALSE, fig.cap = 'Source: Randall Munroe, xkcd.com'}\nknitr::include_graphics('https://imgs.xkcd.com/comics/extrapolating.png')\n```\n`r solend()`\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"include-in-header":["assets/toggling.html"],"number-sections":false,"output-file":"0_01_function.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.340","bibliography":["biblio.bib"],"toc_float":true,"theme":["united","assets/style-labs.scss"],"code-copy":false,"title":"Functions and Models","link-citations":true,"code-annotations":"hover","params":{"SHOW_SOLS":true,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}