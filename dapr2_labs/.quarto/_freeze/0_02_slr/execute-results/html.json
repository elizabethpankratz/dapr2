{
  "hash": "b2dd1132fe3d15da376b355607aa41e6",
  "result": {
    "markdown": "---\ntitle: \"Simple Linear Regression\"\nlink-citations: true\nparams: \n    SHOW_SOLS: TRUE\n    TOGGLE: TRUE\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n:::lo\n### <i class=\"fa fa-graduation-cap\"></i> Learning Objectives\nAt the end of this lab, you will:\n\n1. Be able to specify a simple linear model. \n2. Understand what fitted values and residuals are. \n3. Be able to interpret the coefficients of a fitted model.\n\n### <i class=\"fa fa-check-square-o fa-2\"></i> Requirements\n\n1. Be up to date with lectures from Weeks 1 & 2\n2. Have completed [Week 1 lab exercises](https://uoepsy.github.io/dapr2/2223/labs/1_01_function.html) \n\n### <i class=\"fab fa-r-project\"></i> Required R Packages\nRemember to load all packages within a code chunk at the start of your RMarkdown file using `library()`. If you do not have a package and need to install, do so within the console using `install.packages(\" \")`. For further guidance on installing/updating packages, see Section C [here](https://uoepsy.github.io/files/install-update-r#update-pkgs). \n\nFor this lab, you will need to load the following package(s):\n\n* **tidyverse** \n* **sjPlot**\n\n### <i class=\"fa fa-pencil-square-o\" aria-hidden=\"true\"></i> Presenting Results\nAll results should be presented following [APA guidelines](https://apastyle.apa.org/instructional-aids/numbers-statistics-guide.pdf).If you need a reminder on how to hide code, format tables/plots, etc., make sure to review the [rmd bootcamp](https://uoepsy.github.io//rmd-bootcamp/).\n\n### <i class=\"fa fa-file\"></i> Lab Data\nYou can download the data required for this lab [here](https://uoepsy.github.io/data/riverview.csv) or read it in via this link https://uoepsy.github.io/data/riverview.csv. \n:::\n\n# Study Overview \n\n> **Research Question**\n> \n> Is there an association between income and education level in the city of Riverview?  \n\nLet’s imagine a study into income disparity for workers in a local authority. We might carry out interviews and find that there is an association between the level of education and an employee’s income. Those with more formal education seem to be better paid. \n\nIn this lab, we will use the riverview data (see below codebook) to examine whether education level is related to income among the employees working for the city of Riverview, a hypothetical midwestern city in the US.\n\n\n\n<div class=\"optional-begin\"><span id='opt-start-1' class=\"fa-solid fa-circle-right optional-icon clickable\" onclick=\"toggle_visibility('opt-body-1', 'opt-start-1')\"> <span class=\"olab\">Riverview data codebook.</span></span></div><div class=\"optional-body\" id = \"opt-body-1\" style=\"display: none;\">\n\n\n\n__Description__\n\nThe riverview data come from @Lewis-Beck2015 and contain five attributes collected from a random sample of employees working in the hypothetical city of Riverview ($n=32$). The attributes include:\n\n- `education`: Years of formal education\n- `income`: Annual income (in thousands of U.S. dollars)\n- `seniority`: Years of seniority\n- `gender`: Employee's gender\n- `male`: Dummy coded gender variable (0 = Female, 1 = Male)\n- `party`: Political party affiliation\n\n__Preview__\n\nThe first six rows of the data are:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> education </th>\n   <th style=\"text-align:center;\"> income </th>\n   <th style=\"text-align:center;\"> seniority </th>\n   <th style=\"text-align:center;\"> gender </th>\n   <th style=\"text-align:center;\"> male </th>\n   <th style=\"text-align:center;\"> party </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 37.449 </td>\n   <td style=\"text-align:center;\"> 7 </td>\n   <td style=\"text-align:center;\"> male </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> Democrat </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 26.430 </td>\n   <td style=\"text-align:center;\"> 9 </td>\n   <td style=\"text-align:center;\"> female </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> Independent </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 47.034 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> male </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> Democrat </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 34.182 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> female </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> Independent </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 25.479 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> female </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> Republican </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 46.488 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> female </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> Democrat </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n</div><p class=\"optional-end\"></p>\n\n\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Setup\n\n\n<div class='question-begin'>Setup</div><div class='question-body'>\n\n  \n\n1. Create a new RMarkdown file\n2. Load the required package(s)\n3. Read the riverview dataset into R, assigning it to an object named `riverview`\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n\n<div class=\"solution-begin\"><span id='sol-start-2' class=\"fa-solid fa-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-2', 'sol-start-2')\">  Solution </span></div><div class=\"solution-body\" id = \"sol-body-2\" style=\"display: none;\">\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#Loading the required package(s)\nlibrary(tidyverse)\nlibrary(sjPlot)\n\n#Reading in riverview data and storing in object named 'riverview'\nriverview <- read_csv(\"https://uoepsy.github.io/data/riverview.csv\")\n\n#check first six rows\nhead(riverview)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n  education income seniority gender  male party      \n      <dbl>  <dbl>     <dbl> <chr>  <dbl> <chr>      \n1         8   37.4         7 male       1 Democrat   \n2         8   26.4         9 female     0 Independent\n3        10   47.0        14 male       1 Democrat   \n4        10   34.2        16 female     0 Independent\n5        10   25.5         1 female     0 Republican \n6        12   46.5        11 female     0 Democrat   \n```\n:::\n:::\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n# Exercises \n\n## Data Exploration\n\nThe common first port of call for almost any statistical analysis is to explore the data, and we can do this visually and/or numerically.\n\n+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|                |  Marginal Distributions                                                                                                                                         | Bivariate Associations                                                                                                                                                       |\n+================+=================================================================================================================================================================+==============================================================================================================================================================================+\n|**Description** |  The distribution of each variable (e.g., employee incomes and education levels) *without* reference to the values of the other variables                       | Describing the relationship between two numeric variables                                                                                                                    |\n+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|**Visually**    | Plot each variable individually.                                                                                                                                | Plot associations among two variables.                                                                                                                                       |\n|  <br>          | <br>                                                                                                                                                            | <br>                                                                                                                                                                         |\n|  <br>          | <br>                                                                                                                                                            | <br>                                                                                                                                                                         |\n|                | You could use, for example, `geom_density()` for a density plot or `geom_histogram()` for a histogram to comment on and/or examine:                             | You could use, for example, `geom_point()` for a scatterplot  to comment on and/or examine:                                                                                                     |\n|  <br>          | <br>                                                                                                                                                            | <br>                                                                                                                                                                         |\n|  <br>          | <br>                                                                                                                                                            | <br>                                                                                                                                                                         |\n|                |<ul><li> The *shape* of the distribution. Look at the shape, centre and spread of the distribution. Is it symmetric or skewed? Is it unimodal or bimodal? </li>  | <li>The *direction* of the association indicates whether there is a positive or negative association  </li>                                                                 \n|                |<li> Identify any *unusual observations*. Do you notice any extreme observations (i.e., outliers)? </li>                                                         | <li>The *form* of association refers to whether the relationship between the variables can be summarized well with a straight line or some more complicated pattern </li>   \n|                |                                                                                                                                                                 | <li>The *strength* of association entails how closely the points fall to a recognizable pattern such as a line  </li>                                                       \n|                |                                                                                                                                                                 | <li>*Unusual observations* that do not fit the pattern of the rest of the observations and which are worth examining in more detail </li></ul>                              |\n+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|**Numerically** | Compute and report summary statistics e.g., mean, standard deviation, median, min, max, etc.                                                                    | Compute and report the correlation coefficient.                                                                                                                              |\n|  <br>          | <br>                                                                                                                                                            | <br>                                                                                                                                                                         |\n|  <br>          | <br>                                                                                                                                                            | <br>                                                                                                                                                                         |\n|                | You could, for example, calculate summary statistics such as the mean (`mean()`) and standard deviation (`sd()`), etc. within `summarize()`                     | <br>                                                                                                                                                                         |\n|                |                                                                                                                                                                 | You can use the `cor()` function to calculate this                                                                                                                           |   \n+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n### Marginal Distributions\n\n\n\n<div class='question-begin'>Question 2</div><div class='question-body'>\n\n\n\nVisualise and describe the marginal distributions of employee incomes and education level.\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n\n<div class=\"solution-begin\"><span id='sol-start-3' class=\"fa-solid fa-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-3', 'sol-start-3')\">  Solution </span></div><div class=\"solution-body\" id = \"sol-body-3\" style=\"display: none;\">\n\n\n\n::: {.panel-tabset}\n\n## Employee Incomes\n\nVisualisation of distribution:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = riverview, aes(x = income)) +\n  geom_density() +\n  geom_boxplot(width = 1/300) +\n  labs(x = \"Income (in thousands of U.S. dollars)\", \n       y = \"Probability density\")\n```\n\n::: {.cell-output-display}\n![Density plot and boxplot of employee incomes](0_02_slr_files/figure-html/fig-densbox-income-1.png){#fig-densbox-income fig-align='center' fig-alt='Density and boxplot of employee incomes.\nUnimodal distribution, with most incomes around $45,000-70,000.\nNo outliers suggested based on boxplot.' width=80%}\n:::\n:::\n\n\nInitial observations from plot:\n\n+ The distribution of employee incomes was unimodal\n+ Most of the incomes were between roughly \\$45,000 and \\$63,000\n+ The lowest income in the sample was approximately \\$25,000 and the highest approximately \\$83,000. This suggested there was a fair high degree of variation in the data. \n+ The boxplot did not highlight any outliers in the data.\n\nDescriptive (or summary) statistics for the employees' incomes:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndesc_income <- riverview %>% \n  summarize(\n    M = mean(income), \n    SD = sd(income)\n    )\ndesc_income\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 2\n      M    SD\n  <dbl> <dbl>\n1  53.7  14.6\n```\n:::\n:::\n\n\nFollowing the exploration above, we can describe the income variable as follows:\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\nThe marginal distribution of income was unimodal with a mean of approximately \\$53,700. There was variation in employees' salaries (SD = \\$14,553). \n\n:::\n\n## Employee Education Levels\n\nVisualisation of distribution:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = riverview, aes(x = education)) +\n  geom_density() +\n  geom_boxplot(width = 1/100) +\n  labs(x = \"Education (in years)\", \n       y = \"Probability density\")\n```\n\n::: {.cell-output-display}\n![Density plot and boxplot of employee education levels](0_02_slr_files/figure-html/fig-densbox-education-1.png){#fig-densbox-education fig-align='center' width=80%}\n:::\n:::\n\n\nInitial observations from plot:\n\n+ The distribution of employee education was unimodal\n+ Most of the employees received formal education for between 12 and 20 years\n+ The fewest formal years of education was approximately 8 years, and the highest approximately 25. This suggested there was a fair high degree of variation in the data.\n+ The boxplot did not highlight any outliers in the data\n\nDescriptive (or summary) statistics for the employees' level of education:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndesc_education <- riverview %>%\n  summarize(\n    M = mean(education),\n    SD = sd(education)\n    )\ndesc_education\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 2\n      M    SD\n  <dbl> <dbl>\n1    16  4.36\n```\n:::\n:::\n\n\nFollowing the exploration above, we can describe the education variable as follows:\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\nThe marginal distribution of education was unimodal with an average of of 16 years. There was variation in employees' level of education (SD = 4.4 years).\n\n:::\n\n:::\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n### Associations among Variables\n\n\n\n<div class='question-begin'>Question 3</div><div class='question-body'>\n\n\nCreate a scatterplot of income and education level *before* calculating the correlation between income and education level. \n\nMaking reference to both the plot and correlation coefficient, describe the association between income and level of education among the employees in the sample.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nWe are trying to investigate how income varies when varying years of formal education. Hence, income is the dependent variable (on the y-axis), and education is the independent variable (on the x-axis).\n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n\n<div class=\"solution-begin\"><span id='sol-start-4' class=\"fa-solid fa-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-4', 'sol-start-4')\">  Solution </span></div><div class=\"solution-body\" id = \"sol-body-4\" style=\"display: none;\">\n\n\n\nLet's produce a scatterplot:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = riverview, aes(x = education, y = income)) +\n  geom_point() +\n  labs(x = \"Education (in years)\", \n       y = \"Income (in thousands of U.S. dollars)\")\n```\n\n::: {.cell-output-display}\n![The association between employees' education level and income](0_02_slr_files/figure-html/fig-riverview-scatterplot-1.png){#fig-riverview-scatterplot fig-align='center' width=80%}\n:::\n:::\n\n\nTo comment on the strength of the linear association we compute the correlation coefficient:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncorr <- riverview %>%\n  select(education, income) %>%\n  cor()\ncorr\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          education    income\neducation 1.0000000 0.7947847\nincome    0.7947847 1.0000000\n```\n:::\n:::\n\n\nthat is, \n$$\nr_{\\text({education, income})} = 0.79\n$$\n<br>\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\nThere was a strong positive linear association between education level and income for the employees in the sample. High incomes tended to be observed, on average, with more years of formal education ($r$ = .79).\n\n:::\n\n<br>\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Model Specification and Fitting\n\nThe scatterplot highlighted a linear relationship, where the data points were scattered around an underlying linear pattern with a roughly-constant spread as x varied.\n\nHence, we will try to fit a simple (i.e., one x variable only) linear regression model:\n\n$$\ny_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i \n\\\\\n\\quad \\text{where} \\quad \\epsilon_i \\sim N(0, \\sigma) \\text{ independently}\n$$\n\n::: {.callout-important icon=false collapse=true}\n# What does $y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i \\quad \\text{where} \\quad \\epsilon_i \\sim N(0, \\sigma) \\text{ independently}$ mean?\nLets break the statement down into smaller parts:\n\n###### $y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i$\n+ $y_i$ is our measured outcome variable (our DV)\n+ $x_i$ is our measured predictor variable (our IV)\n+ $\\beta_0$ is the model intercept\n+ $\\beta_1$ is the model slope\n\n###### $\\epsilon \\sim N(0, \\sigma) \\text{ independently}$\n+ $\\epsilon$ is the residual error \n+ $\\sim$ means 'distributed according to'\n+ $\\sim N(0, \\sigma) \\text{ independently}$ means 'normal distribution with a mean of 0 and a variance of $\\sigma$' \n+ Together, we can say that the errors around the line have a mean of zero and constant spread as x varies. \n\n:::\n\n<br>\n\n\n\n<div class='question-begin'>Question 4</div><div class='question-body'>\n\n\n\nFirst, write the equation of the fitted line. \n\nNext, using the `lm()` function, fit a simple linear model to predict income (DV) by Education (IV), naming the output `mdl`.\n\nLastly, add update your equation of the fitted line to include the estimated coefficients.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nThe syntax of the `lm()` function is:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n[model name] <- lm([response variable i.e., dependent variable] ~ [explanatory variable i.e., independent variable], data = [dataframe])\n```\n:::\n\n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n\n<div class=\"solution-begin\"><span id='sol-start-5' class=\"fa-solid fa-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-5', 'sol-start-5')\">  Solution </span></div><div class=\"solution-body\" id = \"sol-body-5\" style=\"display: none;\">\n\n\n\nFirst, lets specify the fitted model, which can be written either as:\n\n::: {.panel-tabset}\n\n## Option A\n\n$$\n\\widehat{Income} = \\hat \\beta_0 + \\hat \\beta_1 \\cdot Education\n$$\n\n## Option B\n\n$$\n\\widehat{Income} = \\hat \\beta_0 \\cdot 1 + \\hat \\beta_1 \\cdot Education\n$$\n:::\n\nTo fit the model in `R`, as the variables are in the `riverview` dataframe, we would write:\n\n::: {.panel-tabset}\n\n## Option A\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmdl <- lm(income ~ education, data = riverview)\nmdl\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = income ~ education, data = riverview)\n\nCoefficients:\n(Intercept)    education  \n     11.321        2.651  \n```\n:::\n:::\n\n\n## Option B\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmdl <- lm(income ~ 1 + education, data = riverview)\nmdl\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = income ~ 1 + education, data = riverview)\n\nCoefficients:\n(Intercept)    education  \n     11.321        2.651  \n```\n:::\n:::\n\n\n\n:::\n\n::: {.callout-important icon=false collapse=true}\n## Why is there a 1 in the Option B's? \nWhen we specify the linear model in `R`, we include after the tilde sign ($\\sim$), the variables that appear to the right of the $\\hat \\beta$s. The intercept, or $\\beta_0$, is a constant. That is, we could write it as multiplied by 1.\n\nIncluding the 1 explicitly is not necessary because it is included by default (you can check this by comparing the outputs of A & B above with and without the 1 included - the estimates are the same!). After a while, you will find you just want to drop the 1 (i.e., Option B) when calling `lm()` because you know that it’s going to be there, but in these early weeks we tried to keep it explicit to make it clear that you want to the intercept to be estimated. \n:::\n\nNote that by calling the name of the fitted model, `mdl`, you can see the estimated regression coefficients $\\hat \\beta_0$ and $\\hat \\beta_1$. We can add these values to the fitted line: \n\n$$\n\\widehat{Income} = 11.32 + 2.65 \\cdot Education \\\\\n$$\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n<br>\n\n\n\n<div class='question-begin'>Question 5</div><div class='question-body'>\n\n\nExplore the following equivalent ways to obtain the estimated regression coefficients --- that is, $\\hat \\beta_0$ and $\\hat \\beta_1$ --- from the fitted model:\n\n- `mdl`\n- `mdl$coefficients`\n- `coef(mdl)`\n- `coefficients(mdl)`\n- `summary(mdl)`\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n\n<div class=\"solution-begin\"><span id='sol-start-6' class=\"fa-solid fa-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-6', 'sol-start-6')\">  Solution </span></div><div class=\"solution-body\" id = \"sol-body-6\" style=\"display: none;\">\n\n\n\nThe estimated parameters returned by the below methods are all equivalent. However, `summary()` returns more information.\n\n::: {.panel-tabset}\n\n## mdl()\nSimply invoke the name of the fitted model:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmdl\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = income ~ 1 + education, data = riverview)\n\nCoefficients:\n(Intercept)    education  \n     11.321        2.651  \n```\n:::\n:::\n\n\n## mdl$coefficients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmdl$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)   education \n  11.321379    2.651297 \n```\n:::\n:::\n\n\n## coef(mdl)\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncoef(mdl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)   education \n  11.321379    2.651297 \n```\n:::\n:::\n\n\n\n## coefficients(mdl)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncoefficients(mdl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)   education \n  11.321379    2.651297 \n```\n:::\n:::\n\n\n## summary(mdl)\nLook under the “Estimate” column:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsummary(mdl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = income ~ 1 + education, data = riverview)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-15.809  -5.783   2.088   5.127  18.379 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  11.3214     6.1232   1.849   0.0743 .  \neducation     2.6513     0.3696   7.173 5.56e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.978 on 30 degrees of freedom\nMultiple R-squared:  0.6317,\tAdjusted R-squared:  0.6194 \nF-statistic: 51.45 on 1 and 30 DF,  p-value: 5.562e-08\n```\n:::\n:::\n\n\n:::\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\nThe estimated intercept is $\\hat \\beta_0 = 11.32$ and the estimated slope is $\\hat \\beta_1 = 2.65$.\n\n:::\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n<br>\n\n\n\n<div class='question-begin'>Question 6</div><div class='question-body'>\n\n\nExplore the following equivalent ways to obtain the estimated standard deviation of the errors --- that is, $\\hat \\sigma$ --- from the fitted model `mdl`:\n\n- `sigma(mdl)`\n- `summary(mdl)`\n\n\n\n<div class=\"optional-begin\"><span id='opt-start-7' class=\"fa-solid fa-circle-right optional-icon clickable\" onclick=\"toggle_visibility('opt-body-7', 'opt-start-7')\"> <span class=\"olab\">Huh? What is $\\sigma$?</span></span></div><div class=\"optional-body\" id = \"opt-body-7\" style=\"display: none;\">\n\n\nThe standard deviation of the errors, denoted by $\\sigma$, is an important quantity that our model estimates. It represents how much individual data points tend to deviate above and below the regression line. \n\nA small $\\sigma$ indicates that the points hug the line closely and we should expect fairly accurate predictions, while a large $\\sigma$ suggests that, even if we estimate the line perfectly, we can expect individual values to deviate from it by substantial amounts.\n\nThe *estimated* standard deviation of the errors is denoted $\\hat \\sigma$, and is estimated by essentially averaging squared residuals (giving the variance) and taking the square-root: \n\n$$\n\\begin{align}\n& \\hat \\sigma = \\sqrt{\\frac{SS_{Residual}}{n - k - 1}} \\\\\n\\qquad \\\\\n& \\text{where} \\\\\n& SS_{Residual} = \\textrm{Sum of Squared Residuals} = \\sum_{i=1}^n{(\\epsilon_i)^2}\n\\end{align}\n$$\n\n\n</div><p class=\"optional-end\"></p>\n\n\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n\n<div class=\"solution-begin\"><span id='sol-start-8' class=\"fa-solid fa-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-8', 'sol-start-8')\">  Solution </span></div><div class=\"solution-body\" id = \"sol-body-8\" style=\"display: none;\">\n\n\n\nThe estimated standard deviation of the errors can be equivalently obtained by the below methods. However, `summary()` returns more information.\n\n::: {.panel-tabset}\n\n## sigma(mdl)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsigma(mdl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8.978116\n```\n:::\n:::\n\n\n## summary(mdl)\n\nLook at the \"Residual standard error\" entry of the `summary(mdl)` output:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsummary(mdl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = income ~ 1 + education, data = riverview)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-15.809  -5.783   2.088   5.127  18.379 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  11.3214     6.1232   1.849   0.0743 .  \neducation     2.6513     0.3696   7.173 5.56e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.978 on 30 degrees of freedom\nMultiple R-squared:  0.6317,\tAdjusted R-squared:  0.6194 \nF-statistic: 51.45 on 1 and 30 DF,  p-value: 5.562e-08\n```\n:::\n:::\n\n\n:::{.callout-note}\n\nThe term \"Residual standard error\" is a misnomer, as the help page for `sigma` says (check `?sigma`). However, it's hard to get rid of this bad name as it has been used in too many books showing R output.\n\n:::\n\n:::\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\n\nThe estimated standard deviation of the errors is $\\hat \\sigma = 8.98$.\n\n:::\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n<br>\n\n\n\n<div class='question-begin'>Question 7</div><div class='question-body'>\n\n\n\nInterpret the estimated intercept, slope, and standard deviation of the errors in the context of the research question.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nTo interpret the estimated standard deviation of the errors we can use the fact that about 95\\% of values from a normal distribution fall within two standard deviations of the centre.\n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n\n<div class=\"solution-begin\"><span id='sol-start-9' class=\"fa-solid fa-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-9', 'sol-start-9')\">  Solution </span></div><div class=\"solution-body\" id = \"sol-body-9\" style=\"display: none;\">\n\n\n\n::: {.panel-tabset}\n\n## Intercept\n\nThe estimated income associated to zero years of formal education is \\$11,321.\n\n## Slope\n\nThe estimated increase in income associated to a one year increase in education is \\$2,651.\n\n## Standard deviation of the errors\n\nFor any particular level of education, employee incomes should be distributed above and below the regression line with standard deviation estimated to be $\\hat \\sigma = 8.98$. Since $2 \\hat \\sigma = 2 (8.98) = 17.96$, we expect most (about 95\\%) of the employee incomes to be within about \\$18,000 from the regression line.\n\n:::\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n<br>\n\n\n\n<div class='question-begin'>Question 8</div><div class='question-body'>\n\n\nPlot the data and the fitted regression line. To do so:\n\n- Extract the estimated regression coefficients e.g., via `betas <- coef(mdl)`\n- Extract the first entry of `betas` (i.e., the intercept) via `betas[1]`\n- Extract the second entry of `betas` (i.e., the slope) via `betas[2]`\n- Provide the intercept and slope to the function\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint\n\nExtracting values:\nThe function `coef(mdl)` returns a *vector*: that is, a sequence of numbers all of the same type. To get the first element of the sequence you append `[1]`, and `[2]` for the second.\n\nPlotting:\nIn your `ggplot()`, you will need to specify `geom_abline()`. This might help get you started:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngeom_abline(intercept = <intercept>, slope = <slope>)\n```\n:::\n\n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n\n<div class=\"solution-begin\"><span id='sol-start-10' class=\"fa-solid fa-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-10', 'sol-start-10')\">  Solution </span></div><div class=\"solution-body\" id = \"sol-body-10\" style=\"display: none;\">\n\n\n\nFirst extract the values required:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbetas <- coef(mdl)\nintercept <- betas[1]\nslope <- betas[2]\n```\n:::\n\n\nWe can plot the model as follows:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = riverview, aes(x = education, y = income)) +\n  geom_point() +\n  geom_abline(intercept = intercept, slope = slope, color = 'blue') + \n  labs(x = \"Education (in years)\", y = \"Income (in thousands of U.S. dollars)\")\n```\n\n::: {.cell-output-display}\n![](0_02_slr_files/figure-html/unnamed-chunk-21-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n<div class=\"divider div-transparent div-dot\"></div>\n\n## Predicted Values & Residuals\n\n:::statbox \n\n### Predicted Values\n\n#### Model predicted values for sample data:\n\nWe can get out the model predicted values for $y$, the \"y hats\" ($\\hat y$), for the data in the sample using various functions:\n\n- `predict(<fitted model>)`\n- `fitted(<fitted model>)`\n- `fitted.values(<fitted model>)`\n- `mdl$fitted.values`\n\nFor example, this will give us the estimated income (point on our regression line) for each observed value of education level.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npredict(mdl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       1        2        3        4        5        6        7        8 \n32.53175 32.53175 37.83435 37.83435 37.83435 43.13694 43.13694 43.13694 \n       9       10       11       12       13       14       15       16 \n43.13694 48.43953 48.43953 48.43953 51.09083 53.74212 53.74212 53.74212 \n      17       18       19       20       21       22       23       24 \n53.74212 53.74212 56.39342 59.04472 59.04472 61.69601 61.69601 64.34731 \n      25       26       27       28       29       30       31       32 \n64.34731 64.34731 64.34731 66.99861 66.99861 69.64990 69.64990 74.95250 \n```\n:::\n:::\n\n\n#### Model predicted values for other (unobserved) data:\n\nTo compute the model-predicted values for unobserved data (i.e., data not contained in the sample), we can use the following function:\n\n- `predict(<fitted model>, newdata = <dataframe>)`\n\nFor this example, we first need to remember that the model predicts `income` using the independent variable `education`. Hence, if we want predictions for new (unobserved) data, we first need to create a tibble with a column called `education` containing the years of education for which we want the prediction, and store this as a dataframe.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#Create dataframe 'newdata' containing education years of 7, 11 and 25\nnewdata <- tibble(education = c(7, 11, 25))\nnewdata\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 1\n  education\n      <dbl>\n1         7\n2        11\n3        25\n```\n:::\n:::\n\n\nThen we take `newdata` and add a new column called `income_hat`, computed as the prediction from the fitted `mdl` using the `newdata` above:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnewdata <- newdata %>%\n  mutate(\n    income_hat = predict(mdl, newdata = newdata)\n  )\nnewdata\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 2\n  education income_hat\n      <dbl>      <dbl>\n1         7       29.9\n2        11       40.5\n3        25       77.6\n```\n:::\n:::\n\n\n### Residuals\n\nThe residuals represent the deviations between the actual responses and the predicted responses and can be obtained either as\n\n- `mdl$residuals`\n- `resid(mdl)`\n- `residuals(mdl)`\n- computing them as the difference between the response ($y_i$) and the predicted response ($\\hat y_i$)\n\n:::\n\n<br>\n\n\n\n<div class='question-begin'>Question 9</div><div class='question-body'>\n\n\n\nUse `predict(mdl)` to compute the fitted values and residuals. Mutate the `riverview` dataframe to include the fitted values and residuals as extra columns.\n\nAssign to the following symbols the corresponding numerical values:\n\n- $y_{3}$ (response variable for unit $i = 3$ in the sample data)\n- $\\hat y_{3}$ (fitted value for the third unit)\n- $\\hat \\epsilon_{5}$ (the residual corresponding to the 5th unit, i.e., $y_{5} - \\hat y_{5}$)\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n\n<div class=\"solution-begin\"><span id='sol-start-11' class=\"fa-solid fa-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-11', 'sol-start-11')\">  Solution </span></div><div class=\"solution-body\" id = \"sol-body-11\" style=\"display: none;\">\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nriverview_fitted <- riverview %>%\n  mutate(\n    income_hat = predict(mdl),\n    resid = income - income_hat\n  )\n\nhead(riverview_fitted)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 8\n  education income seniority gender  male party       income_hat  resid\n      <dbl>  <dbl>     <dbl> <chr>  <dbl> <chr>            <dbl>  <dbl>\n1         8   37.4         7 male       1 Democrat          32.5   4.92\n2         8   26.4         9 female     0 Independent       32.5  -6.10\n3        10   47.0        14 male       1 Democrat          37.8   9.20\n4        10   34.2        16 female     0 Independent       37.8  -3.65\n5        10   25.5         1 female     0 Republican        37.8 -12.4 \n6        12   46.5        11 female     0 Democrat          43.1   3.35\n```\n:::\n:::\n\n\n- $y_{3}$ = 47.03 (see row 3, column 2)\n- $\\hat y_{3}$ = 37.83 (see row 3, column 7)\n- $\\hat \\epsilon_{5} = y_{5} - \\hat y_{5}$ = -12.36 (see row 5, columns 2 and 7)\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n<br>\n\n\n\n<div class='question-begin'>Question 10</div><div class='question-body'>\n\n\n\nDescribe the design of the study, and the analyses that you undertook. Interpret your results in the context of the research question and report your model results in full.\n\nProvide key model results in a formatted table.\n\n:::{.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n### Hint \n\nUse `tab_model()` from the __sjPlot__ package. \n\nRemember that you can rename your DV and IV labels by specifying `dv.labels` and `pred.labels`.\n\nMake sure to write your results up following [APA guidelines](https://apastyle.apa.org/instructional-aids/numbers-statistics-guide.pdf)\n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n\n<div class=\"solution-begin\"><span id='sol-start-12' class=\"fa-solid fa-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-12', 'sol-start-12')\">  Solution </span></div><div class=\"solution-body\" id = \"sol-body-12\" style=\"display: none;\">\n\n\n\nBefore we write up our analyses & results, lets first create the table of results:\n\n\n::: {#tbl-income-modresults .cell layout-align=\"center\" tbl-cap='Regression Table for Income Model'}\n\n```{.r .cell-code}\ntab_model(mdl,\n          dv.labels = \"Income (in thousands of US dollars)\",\n          pred.labels = c(\"education\" = \"Education (years)\"),\n          title = \"Regression Table for Income Model\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<caption style=\"font-weight: bold; text-align:left;\">Regression Table for Income Model</caption>\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">Income (in thousands of US dollars)</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">11.32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.18&nbsp;&ndash;&nbsp;23.83</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.074</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Education (years)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.65</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.90&nbsp;&ndash;&nbsp;3.41</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">32</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.632 / 0.619</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {.callout-important icon=false appearance=\"minimal\"}\n\nThe `riverview` dataset contained information on 32 participants who worked in the hypothetical city of Riverview, US. Using a between-subjects design, the researchers collected information on participants' sex, income, education, and seniority level. \n\nTo investigate whether there was an association between income and education level, the following simple linear regression model was used:\n\n$$\n\\text{Income}= \\beta_0 + \\beta_1 \\cdot \\text{Education}\n$$\n\nFull regression results are displayed in @tbl-income-modresults. The estimated income associated with no formal years of education was \\$11,321. Each additional year of formal education was associated with an income increase of \\$2,651. \n:::\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n",
    "supporting": [
      "0_02_slr_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}