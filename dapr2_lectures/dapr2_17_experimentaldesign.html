<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title> Analyzing Experiments</title>
    <meta charset="utf-8" />
    <meta name="author" content="dapR2 Team" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# <b> Analyzing Experiments </b>
## Data Analysis for Psychology in R 2<br><br>
### dapR2 Team
### Department of Psychology<br>The University of Edinburgh

---









# Week's Learning Objectives
1. Understand the different types of experimental design and the data that results from them.
2. Be able to link experimental designs to linear model specifications
3. Understand the distinction between simple, main and interaction effects.
4. Be able to test main effects (via F-tests)
5. Interpret interactions with effects coding.

---
# Topics for today
+ Experimental design
+ Analysing an experiment with a linear model
  + Main effects (F-tests)
  + Categorical Interactions (With sum to zero)

---
# Experimental Design: manipulation
+ A key feature of experimental designs is that we actively manipulate our predictor (IV).

+ The intention is that changing the predictor will result in changes in the outcome (DV).

+ That is our manipulation will lead to variation in the outcome.

+ Our experiments can fail because we design these manipulations poorly.

+ The predictors in an experiment are (primarily) experimental conditions.

---
# Conditions/Factors &amp; levels
+ **Conditions**: 
  + Are part of our experimental designs.
  + They are what is manipulated.
  
+ **Factors**
  + The resultant variables in our data set that code the experimental conditions are typically called factors.
  + Generally the terms conditions and factors are used interchangeably.
  + But it is useful to differentiate the design (conditions) and the data that represents aspects of the design (factors)

+ Factors can have **levels**
  + These are the number of ways we vary or manipulate the condition

---
# Between vs Within Person
+ Two broad choices of study structure:
  + **Between person**: Participants only appear on one level/condition
  + **Within person**: Participants appear in multiple level/conditions

--

+ The labels we use to refer to kinds of studies reflect the number of conditions and whethert the conditions are between vs within.
  + One-way between person
  + Two-way within person
  + etc.

---
# A new study
+ Suppose we wanted to look at the number of reading errors caused by noise distraction. 

+ We might devise a task where participants had to read a passage of text and put a cross through all verbs. 

+ Our outcome, or dependent variable, is the number of verbs correctly crossed out.
+ Our predictor, or independent variable, is the noise level. 

---
# One-way Between Person

&lt;style type="text/css"&gt;
    .remark-slide thead, .remark-slide tr:nth-child(2n) {
        background-color: white;
    }
&lt;/style&gt;

&lt;table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
&lt;tr&gt;&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Noise Level&lt;/div&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; None &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Noise &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tom &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Adam &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Aja &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Fiona &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Alex &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Simon &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Brandy &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tasha &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Darren &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Josh &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Lucy &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Charlotte &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;



???
0db
85db

---
# One-way Between Person (more levels)


&lt;table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
&lt;tr&gt;&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Noise Level&lt;/div&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; None &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Moderate &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Loud &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tom &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Darren &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Adam &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Aja &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Lucy &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Fiona &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Alex &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Josh &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Simon &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Brandy &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Charlotte &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tasha &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


???
0db
85db
100db

---
# Two-way Between Person

&lt;table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
&lt;tr&gt;
&lt;th style="empty-cells: hide;border-bottom:hidden;" colspan="1"&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Noise&lt;/div&gt;&lt;/th&gt;
&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Distraction &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; None &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Moderate &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Loud &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Words &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Tom &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Darren &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Adam &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Words &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Aja &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Lucy &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Fiona &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No Words &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Alex &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Josh &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Simon &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No Words &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Brandy &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Charlotte &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tasha &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

???
0db
85db
100db

As we have a verbal task, possible noise with words would be a greater distraction


---
# One-way Within Person

&lt;table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
&lt;tr&gt;&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Noise Level&lt;/div&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; None &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Noise &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tom &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tom &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Aja &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Aja &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Alex &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Alex &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Brandy &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Brandy &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Darren &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Darren &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Lucy &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Lucy &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Josh &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Josh &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Charlotte &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Charlotte &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
# Two-way Within Person

&lt;table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
&lt;tr&gt;
&lt;th style="empty-cells: hide;border-bottom:hidden;" colspan="1"&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Noise Level&lt;/div&gt;&lt;/th&gt;
&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Distraction &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; None &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Noise &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Word &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Tom &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Tom &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Word &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Aja &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Aja &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Word &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Alex &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Alex &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Word &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Brandy &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Brandy &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No Word &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tom &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tom &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No Word &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Aja &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Aja &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No Word &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Alex &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Alex &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No Word &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Brandy &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Brandy &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
# Mixed Designs
&lt;table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
&lt;tr&gt;
&lt;th style="empty-cells: hide;border-bottom:hidden;" colspan="1"&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Noise Level&lt;/div&gt;&lt;/th&gt;
&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Distraction &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; None &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Noise &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Word &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Tom &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Tom &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Word &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Aja &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Aja &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Word &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Alex &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Alex &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Word &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Brandy &lt;/td&gt;
   &lt;td style="text-align:left;background-color: lightblue !important;"&gt; Brandy &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No Word &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Darren &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Darren &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No Word &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Lucy &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Lucy &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No Word &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Josh &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Josh &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No Word &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Charlotte &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Charlotte &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
# Models and Experiments
+ Linear model

`$$outcome = model + error$$` 
+ When we have an experiment:

`$$outcome = design + error$$` 

+ And the design is simply sets of categorical variables.

+ So to analyse an experiment, we are simply analysing a linear model with categorical predictors.


---
class: center, middle
# Time for a break

---
class: center, middle
# Welcome Back!

---
# A brief example

+ Suppose that we care about the effects of 2 drug treatments on the reading ability of hyperactive children. 

+ In our design, we randomly select 3 groups of children (n=5 per group, N = 15)
  + we give group 1 a placebo (a1), 
  + group 2 one drug (a2), and 
  + group 3 a different drug (a3). 

+ After 1 hour we let the children study a passage of text for 10 minutes, then administer a standard test of comprehension

---
# The data

```
## # A tibble: 15 x 3
##    ID    A_condition score
##    &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1 ID1   a1_control     16
##  2 ID2   a1_control     18
##  3 ID3   a1_control     10
##  4 ID4   a1_control     12
##  5 ID5   a1_control     19
##  6 ID6   a2_drug1        4
##  7 ID7   a2_drug1        7
##  8 ID8   a2_drug1        8
##  9 ID9   a2_drug1       10
## 10 ID10  a2_drug1        1
## 11 ID11  a3_drug2        2
## 12 ID12  a3_drug2       10
## 13 ID13  a3_drug2        9
## 14 ID14  a3_drug2       13
## 15 ID15  a3_drug2       11
```

---
# Describe the data

.pull-left[

```r
data %&gt;%
  group_by(A_condition) %&gt;%
  summarise(
    mean = round(mean(score)),
    sd = round(sd(score),1),
    N = n()
  )
```
]

.pull-right[

```
## # A tibble: 3 x 4
##   A_condition  mean    sd     N
##   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
## 1 a1_control     15   3.9     5
## 2 a2_drug1        6   3.5     5
## 3 a3_drug2        9   4.2     5
```
]


---
# Hypotheses we test in experimental studies

+ One-way designs:
  + Main effect (tests overall effect of a condition; `\(F\)`-tests )
  + Contrasts (tests differences between specific group means; `\(\beta\)` )

--

+ Factorial designs:
  + Main effects
  + Interactions (categorical*categorical) usually based on effects coding
  + Simple contrasts/effects


---
# One way main effects


---
# Factorial main effects and interaction


---
class: center, middle
# Time for a break

---
class: center, middle
# Now let's think about interpreting an interaction with effects codes

---
# Introduction
- Today we're going to focus on interpretting interactions in factorial designs. 
- We'll focus on how to understanding and how to read interaction plots. 
- In these plots we have two categorical variables, each of which has two levels. Here I am going to call them:
  - `cond1` with levels A and B 
  - `cond2` with levels C and D

- It's the simplest case for a factorial design, and so it is an obvious choice for getting used to looking at such plots! 

---
# Refresher
- When viewing the plots, we need to remember that each point represents a group mean. 
- For the sake of these plots, we can assume that each group has the same number of participants.

- So what we are doing is plotting our 2x2 tables of means. 

---
# Refresher

```
##       C  D Mean
## A    20 10   15
## B    10 20   15
## Mean 15 15   15
```

- **Cell mean**: Average score for the participants in that particular experimental condition. So the group of people in condition A-C have a mean of 20. etc.
- **Marginal mean**: The average for a level of one condition *across level* of the other. So, the average score of people in condition A (so A-C and A-D) is 15.
- **Simple effect**: Is a test across one condition at a single level of the other. So A test of the difference between A and B within level C.
- **Main effect**: Average across all simple effects.
- **Interaction**: Test of the difference in effect across levels of the other variable. So, is the effect of condition1 (difference in A-B), different for level C and D of condition 2.
  - Put differently: Are simple effects changing across levels of the second variable.

???
Remember also when looking at this document, we are not talking in terms of inference and statistical significance. We are simply trying to put across what indicative patterns in data would look like in a given plot. This should allow you to interpret plots, and cross-check these against results - either in your own work or published work.

---
# Interaction plots
- Let's look at how to interpret interactions using the easiest tool at our disposal, the interaction plot. 
- An interaction plot basically shows us the effects of one IV1 on the DV as a function of the different levels of IV1. 
  - On the y-axis we have the DV. 
  - On the x-axis we have levels of IV1. 
  - We have different lines representing the levels of IV2. 
  - We'll look at a concrete example now... 
- Let's start by considering a case where we have no main effect, but we do have an interaction... 

---
# No main effects, but an interaction
.pull-left[
- Let's start with some data each time:




```
##       C  D Mean
## A    20 10   15
## B    10 20   15
## Mean 15 15   15
```
]

.pull-right[
- And now let's look at the plot:

![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-15-1.png)&lt;!-- --&gt;
]

---
# No main effects, but an interaction
.pull-left[
- First, consider the main effect of `cond1`.
- The black dots in this plot represent the marginal means for level A and level B of  `cond1`. 
- The main effect here concerns whether these means are different. 
- The magnitude of the difference can be judged by the distance between the dashed horizontal lines when they meet the y-axis. 
- The dashed horizontal line runs through both points, and clearly shows they are not different! There appears to be no main effect of `cond1`
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-16-1.png)&lt;!-- --&gt;
]

---
# No main effects, but an interaction
.pull-left[
- Next, consider the main effect of `cond2`.
- Again, the black dot represent the marginal means for levels C and D of `cond2`. 
- These are the same value, so the points overlay one another. 
- Again, the dashed line runs through each point, but is overlayed. There appears to be no difference in these means, so no main effect.
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-17-1.png)&lt;!-- --&gt;
]

---
# No main effects, but an interaction
.pull-left[
- Finally the interaction. 
- When thinking about the interactions, we are thinking about the differences between conditions C and D within conditions A and B. 
- Let's highlight the differences of C-D within A and within B.
- It's clear that these values are different (10 and -10). 
- This difference indicates to us that there is an interation. 
- In this case, the interaction is **disordinal** in other words, the lines cross. The name disordinal points to the fact that the ranking of C and D change order in A and B.
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-18-1.png)&lt;!-- --&gt;
]

---
## Main effect cond2, with an interaction
.pull-left[
- We will start with some data... 




```
##          C     D  Mean
## A    12.00 14.00 13.00
## B    20.00  5.00 12.50
## Mean 16.00  9.50 12.75
```
]

.pull-right[
- And let's look at the plot:

![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-21-1.png)&lt;!-- --&gt;
]

---
## Main effect cond2, with an interaction
.pull-left[
- Let's consider the main effect of `cond1`.
- The dots are at the means of each level across levels of `cond2`, and the dashed lines run through each dot. As we can see, they are very close together.
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-22-1.png)&lt;!-- --&gt;
]

---
## Main effect cond2, with an interaction
.pull-left[
- And the main effect of `cond2`. 
- For `cond2` you can see that there is a difference in the outcome variable across these conditions that is more substantial. This would indicate a potential effect.
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-23-1.png)&lt;!-- --&gt;
]

---
## Main effect cond2, with an interaction
 .pull-left[
- And finally, the interaction. 
- We see some indication of the interaction. 
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-24-1.png)&lt;!-- --&gt;
]

---
## Main effect of cond1, with an interaction
.pull-left[
- We will start with some data... 


```r
dat3 &lt;- tibble(
  cond1 = c("A", "A", "B", "B"),
  cond2 = c("C", "D", "C", "D"),
  score = c(20, 25, 10, 5)
)
```


```
##         C    D Mean
## A    20.0 25.0 22.5
## B    10.0  5.0  7.5
## Mean 15.0 15.0 15.0
```
]

.pull-right[
And let's look at the plot:

![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-27-1.png)&lt;!-- --&gt;
]

---
## Main effect of cond1, with an interaction
.pull-left[
- Let's consider the main effect of `cond1`. 
- In this plot we can see a large difference (distance between the lines) in score for level A and level B of `cond1`. Indicating there is a main effect present. 
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-28-1.png)&lt;!-- --&gt;
]

---
## Main effect of cond1, with an interaction
.pull-left[
- And the main effect of `cond2`. 
- Again, the dashed line runs through each point, but is overlayed. In short, there appears to be no difference in these means, so no main effect of `cond2`. 
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-29-1.png)&lt;!-- --&gt;
]

---
## Main effect of cond1, with an interaction
.pull-left[
- And finally the interaction. 
- We see some indication of the interaction. 
- Think through the idea that within level A, people in condition D score better than C, and in level B, this is reversed. So we are seeing a change in the effect of one variable asd a function of the other. 
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-30-1.png)&lt;!-- --&gt;
]

---
## Main effect of cond1 and cond2, with an interaction
.pull-left[
Let's do this one quickly as hopefully you are getting the hang of it... 




```
##         C    D Mean
## A    25.0 27.0 26.0
## B    18.0  2.0 10.0
## Mean 21.5 14.5 18.0
```
]

.pull-right[
And let's look at the plot:

![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-33-1.png)&lt;!-- --&gt;
]

---
## Main effect of cond1 and cond2, with an interaction
.pull-left[
- First, let's consider the main effect of `cond1`. 
- Dashed lines differ! 
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-34-1.png)&lt;!-- --&gt;
]

---
## Main effect of cond1 and cond2, with an interaction
.pull-left[
- And the main effect of `cond2`. 
- Dashed lines differ!
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-35-1.png)&lt;!-- --&gt;
]

---
## Main effect of cond1 and cond2, with an interaction
.pull-left[
- And finally the interaction. 
- Again, when thinking about the interactions, we are thinking about the differences between conditions C and D with conditions A and B, so we'll annotate the plots with the value of C-D within A and within B. 
- Should see indication of an interaction. 
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-36-1.png)&lt;!-- --&gt;
]

---
## Main effect cond1, no main effect cond2 or interaction 
.pull-left[
- We start with some data each time... 




```
##         C    D Mean
## A    20.0 19.0 19.5
## B    10.0  9.0  9.5
## Mean 15.0 14.0 14.5
```
]

.pull-right[
And now let's look at the plot:

![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-39-1.png)&lt;!-- --&gt;
]

---
## Main effect cond1, no main effect cond2 or interaction 
.pull-left[
So let's consider the main effect of `cond1`. 
There appears to be no main effect of `cond1`. 
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-40-1.png)&lt;!-- --&gt;
]

---
## Main effect cond1, no main effect cond2 or interaction 
.pull-left[
And the main effect of `cond2`. 
Lines are very close, likely no effect of `cond2`. 
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-41-1.png)&lt;!-- --&gt;
]

---
## Main effect cond1, no main effect cond2 or interaction
.pull-left[
- And the interaction. 
- So this is our only no interaction example. Note the value of the differences is the same, and the lines are parallel. 
]

.pull-right[
![](dapr2_17_experimentaldesign_files/figure-html/unnamed-chunk-42-1.png)&lt;!-- --&gt;
]

---
# Interim summary
- Interactions mean a difference in the relatative effects of one IV at different levels of another. 

- If the difference in the levels of IV1 are different when you're at one level of IV2 vs another, then you're looking at an interaction. 

- The easiest way to visualise an interaction and it's implications are with an interaction plot. 

---
class: center, middle
# Time for a break

---
class: center, middle
# Now let's apply to our example

---
# Example
+ The data comes from a study into patient care in a paediatric wards. 

+ A researcher was interested in whether the subjective well-being of patients differed dependent on the post-operation treatment schedule they were given, and the hospital in which they were staying. 

+ **Condition 1**: `Treatment` (Levels: TreatA, TreatB, TreatC).
  
+ **Condition 2**: `Hosp` (Levels: Hosp1, Hosp2). 
  
+ Total sample n = 180 (30 patients in each of 6 groups).
  + Between person design. 

+ **Outcome**: Subjective well-being (SWB)
  + An average of multiple raters (the patient, a member of their family, and a friend). 
  + SWB score ranged from 0 to 20.


---
# The data

```r
hosp_tbl &lt;- read_csv("hospital.csv", col_types = "dff")
hosp_tbl %&gt;%
  slice(1:10)
```

```
## # A tibble: 10 x 3
##      SWB Treatment Hospital
##    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;   
##  1   6.2 TreatA    Hosp1   
##  2  15.9 TreatA    Hosp1   
##  3   7.2 TreatA    Hosp1   
##  4  11.3 TreatA    Hosp1   
##  5  11.2 TreatA    Hosp1   
##  6   9   TreatA    Hosp1   
##  7  14.5 TreatA    Hosp1   
##  8   7.3 TreatA    Hosp1   
##  9  13.7 TreatA    Hosp1   
## 10  12.6 TreatA    Hosp1
```

---
# Our results

```r
m4 &lt;- lm(SWB ~ Treatment + Hospital + Treatment*Hospital, data = hosp_tbl)
anova(m4)
```

```
## Analysis of Variance Table
## 
## Response: SWB
##                     Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Treatment            2 177.02  88.511 21.5597 4.315e-09 ***
## Hospital             1   9.57   9.568  2.3306    0.1287    
## Treatment:Hospital   2 392.18 196.088 47.7635 &lt; 2.2e-16 ***
## Residuals          174 714.34   4.105                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---
# Our results

```r
m4sum &lt;- summary(m4)
round(m4sum$coefficients,2)
```

```
##                               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                      10.80       0.37   29.19     0.00
## TreatmentTreatB                  -1.37       0.52   -2.62     0.01
## TreatmentTreatC                  -0.70       0.52   -1.33     0.18
## HospitalHosp2                    -2.95       0.52   -5.63     0.00
## TreatmentTreatB:HospitalHosp2     6.63       0.74    8.97     0.00
## TreatmentTreatC:HospitalHosp2     0.82       0.74    1.11     0.27
```

---
# Visualizing the interaction

.pull-left[

]

.pull-right[

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Hosp1 &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Hosp2 &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Marginal &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; TreatA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 10.80 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 7.85 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9.33 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; TreatB &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9.43 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 13.11 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 11.27 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; TreatC &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 10.10 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 7.98 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9.04 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Marginal &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 10.11 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9.65 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9.88 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

]

---
# Coding interactions
+ We noted last time that to fully code an interaction between categorical variables in a linear model, we need (r-1)(c-1) variables.

+ This point comes from our design matrix, or: 

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Hosp1 &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Hosp2 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; TreatA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 10.80 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 7.85 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; TreatB &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 9.43 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 13.11 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; TreatC &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 10.10 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 7.98 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

+ Recall this coding for dummy and effects codes... 

---
# For dummy coding

`$$y_{ijk} = b_0 + \underbrace{(b_1D_1 + b_2D_2)}_{\text{Treatment}} + \underbrace{b_3D_3}_{\text{Hospital}} + \underbrace{b_4D_{13} + b_5D_{23}}_{\text{Interactions}} + \epsilon_{i}$$`



```
## # A tibble: 6 x 7
##   Treatment Hospital    D1    D2    D3   D13   D23
##   &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 A         Hosp1        0     0     0     0     0
## 2 A         Hosp2        0     0     1     0     0
## 3 B         Hosp1        1     0     0     0     0
## 4 B         Hosp2        1     0     1     1     0
## 5 C         Hosp1        0     1     0     0     0
## 6 C         Hosp2        0     1     1     0     1
```

---
# Interpretation (nulls) with dummy coding

```
##                               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                      10.80       0.37   29.19     0.00
## TreatmentTreatB                  -1.37       0.52   -2.62     0.01
## TreatmentTreatC                  -0.70       0.52   -1.33     0.18
## HospitalHosp2                    -2.95       0.52   -5.63     0.00
## TreatmentTreatB:HospitalHosp2     6.63       0.74    8.97     0.00
## TreatmentTreatC:HospitalHosp2     0.82       0.74    1.11     0.27
```

+ `\(b_0\)` = Mean of treatment A in hospital 1.
+ `\(b_1\)` = Difference between Treatment B and Treatment A in Hospital 1.
+ `\(b_2\)` = Difference between Treatment C and Treatment A in Hospital 1.
+ `\(b_3\)` = Difference between Treatment A in Hospital 1 and Hospital 2.
+ `\(b_4\)` = Difference between Treatment A and Treatment B between Hospital 1 and Hospital 2
+ `\(b_5\)` = Difference between Treatment A and Treatment C between Hospital 1 and Hospital 2


---
# For effects coding

`$$y_{ijk} = b_0 + \underbrace{(b_1E_1 + b_2E_2)}_{\text{Treatment}} + \underbrace{b_3E_3}_{\text{Hospital}} + \underbrace{b_4E_{13} + b_5E_{23}}_{\text{Interactions}} + \epsilon_{i}$$`



```
## # A tibble: 6 x 7
##   Treatment Hospital    E1    E2    E3   E13   E23
##   &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 A         Hosp1        1     0     1     1     0
## 2 A         Hosp2        1     0    -1    -1     0
## 3 B         Hosp1        0     1     1     0     1
## 4 B         Hosp2        0     1    -1     0    -1
## 5 C         Hosp1       -1    -1     1    -1    -1
## 6 C         Hosp2       -1    -1    -1     1     1
```






---
# Run model with effects coding

```r
contrasts(hosp_tbl$Treatment) &lt;- contr.sum
contrasts(hosp_tbl$Hospital) &lt;- contr.sum
m4a &lt;- lm(SWB ~ Treatment + Hospital + Treatment*Hospital, data = hosp_tbl)
```

---
# Run model with effects coding

```
## 
## Call:
## lm(formula = SWB ~ Treatment + Hospital + Treatment * Hospital, 
##     data = hosp_tbl)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.6000 -1.2533  0.1083  1.2650  5.7000 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)            9.8806     0.1510  65.425  &lt; 2e-16 ***
## Treatment1            -0.5539     0.2136  -2.593   0.0103 *  
## Treatment2             1.3928     0.2136   6.521 7.30e-10 ***
## Hospital1              0.2306     0.1510   1.527   0.1287    
## Treatment1:Hospital1   1.2428     0.2136   5.819 2.79e-08 ***
## Treatment2:Hospital1  -2.0739     0.2136  -9.710  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.026 on 174 degrees of freedom
## Multiple R-squared:  0.4476,	Adjusted R-squared:  0.4317 
## F-statistic:  28.2 on 5 and 174 DF,  p-value: &lt; 2.2e-16
```

---
# Interpretation with effects coding

```
##                        Estimate Std. Error   t value      Pr(&gt;|t|)
## (Intercept)           9.8805556  0.1510222 65.424539 1.874861e-124
## Treatment1           -0.5538889  0.2135776 -2.593385  1.031285e-02
## Treatment2            1.3927778  0.2135776  6.521179  7.300375e-10
## Hospital1             0.2305556  0.1510222  1.526634  1.286678e-01
## Treatment1:Hospital1  1.2427778  0.2135776  5.818858  2.786690e-08
## Treatment2:Hospital1 -2.0738889  0.2135776 -9.710236  4.395931e-18
```

+ `\(b_0\)` = Grand mean.
+ `\(b_1\)` = Difference between row marginal for treatment A and the grand mean. 
+ `\(b_2\)` = Difference between row marginal for treatment B and the grand mean.
+ `\(b_3\)` = Difference between column marginal for Hospital 1 and the grand mean.
+ `\(b_4\)` = Difference between Treatment A and grand mean, in Hospital 1 and Hospital 2
+ `\(b_5\)` = Difference between Treatment B and grand mean, in Hospital 1 and Hospital 2

---
# Summary

+ This week we had a good amount of material.

+ We reviewed experimental designs, and linked this linear models with categorical predictors.

+ We defined main effects, simple effects, and interactions in the context of an experiment.

+ We used F-tests to explore main effects

+ We looked at interactions with effects coding

+ Next time we will look more closely at simple effects

---
class: center, middle
# Thanks for listening!
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
