<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>DAPR2 - Assumptions and Diagnostics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-chevron-circle-right')) {
    f.classList.add('fa-chevron-circle-down')
    f.classList.remove('fa-chevron-circle-right')
} else {
    f.classList.add('fa-chevron-circle-right')
    f.classList.remove('fa-chevron-circle-down')
}
}
</script><script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DAPR2</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-intro-to-linear-models" role="button" data-bs-toggle="dropdown" aria-expanded="false">Intro to Linear Models</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-intro-to-linear-models">
<li>
    <a class="dropdown-item" href="./1_01_function.html">
 <span class="dropdown-text">1/1: Functions and Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_02_slr.html">
 <span class="dropdown-text">1/2: Intro to Linear Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_03_mlr.html">
 <span class="dropdown-text">1/3: Multiple Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_04_model_fit.html">
 <span class="dropdown-text">1/4: Model Fit and Standardization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_05_cat_recap.html">
 <span class="dropdown-text">1/5: Cat Predictors &amp; Recap</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-more-linear-models" role="button" data-bs-toggle="dropdown" aria-expanded="false">More Linear Models</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-more-linear-models">
<li>
    <a class="dropdown-item" href="./1_07_int1_nc.html">
 <span class="dropdown-text">1/7: Interactions I: Num x Cat</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_08_int2_nn.html">
 <span class="dropdown-text">1/8: Interactions II: Num x Num</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_09_int3_cc.html">
 <span class="dropdown-text">1/9: Interactions III: Cat x Cat</span></a>
  </li>  
        <li class="dropdown-header">1/10: Assumptions &amp; Diagnostics</li>
        <li class="dropdown-header">1/11: Recap &amp; Write Up</li>
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analysing-experimental-studies" role="button" data-bs-toggle="dropdown" aria-expanded="false">Analysing Experimental Studies</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analysing-experimental-studies">
<li class="dropdown-header">2/1: Functions and Models</li>
        <li class="dropdown-header">2/2: Intro to Linear Regression</li>
        <li class="dropdown-header">2/3: More Linear Regression</li>
        <li class="dropdown-header">2/4: Multiple Predictors</li>
        <li class="dropdown-header">2/5: Recap &amp; Write Up</li>
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-advanced-topics-for-lm" role="button" data-bs-toggle="dropdown" aria-expanded="false">Advanced Topics for LM</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-advanced-topics-for-lm">
<li class="dropdown-header">2/6: Functions and Models</li>
        <li class="dropdown-header">2/7: Intro to Linear Regression</li>
        <li class="dropdown-header">2/8: More Linear Regression</li>
        <li class="dropdown-header">2/9: Multiple Predictors</li>
        <li class="dropdown-header">2/10: Recap &amp; Write Up</li>
    </ul>
</li>
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#lab-overview" id="toc-lab-overview" class="nav-link active" data-scroll-target="#lab-overview">Lab Overview</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li>
<a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
<li><a href="#linearity" id="toc-linearity" class="nav-link" data-scroll-target="#linearity">Linearity</a></li>
  <li><a href="#equal-variances-homoscedasticity" id="toc-equal-variances-homoscedasticity" class="nav-link" data-scroll-target="#equal-variances-homoscedasticity">Equal variances (Homoscedasticity)</a></li>
  <li><a href="#independence" id="toc-independence" class="nav-link" data-scroll-target="#independence">Independence</a></li>
  <li><a href="#normality-of-errors" id="toc-normality-of-errors" class="nav-link" data-scroll-target="#normality-of-errors">Normality of errors</a></li>
  <li><a href="#multicollinearity" id="toc-multicollinearity" class="nav-link" data-scroll-target="#multicollinearity">Multicollinearity</a></li>
  <li><a href="#individual-case-diagnostics" id="toc-individual-case-diagnostics" class="nav-link" data-scroll-target="#individual-case-diagnostics">Individual Case Diagnostics</a></li>
  </ul>
</li>
  <li><a href="#less-guided-exercises---extra-practice" id="toc-less-guided-exercises---extra-practice" class="nav-link" data-scroll-target="#less-guided-exercises---extra-practice">Less guided exercises - extra practice</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Assumptions and Diagnostics</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div class="lo">
<section id="learning-objectives" class="level3"><h3 class="anchored" data-anchor-id="learning-objectives">
<i class="fa fa-graduation-cap"></i> Learning Objectives</h3>
<p>At the end of this lab, you will:</p>
<ol type="1">
<li>Be able to state the assumptions underlying a linear model.</li>
<li>Specify the assumptions underlying a linear model with multiple predictors.</li>
<li>Assess if a fitted model satisfies the assumptions of your model.</li>
<li>Assess the effect of influential cases on linear model coefficients and overall model evaluations.</li>
</ol></section><section id="what-you-need" class="level3"><h3 class="anchored" data-anchor-id="what-you-need">
<i class="fa fa-check-square-o fa-2"></i> What You Need</h3>
<ol type="1">
<li>Be up to date with lectures</li>
<li>Have completed previous lab exercises from <a href="https://uoepsy.github.io/dapr2/2223/labs/1_07_int1_nc.html">Week 7</a>, <a href="https://uoepsy.github.io/dapr2/2223/labs/1_08_int2_nn.html">Week 8</a>, and <a href="https://uoepsy.github.io/dapr2/2223/labs/1_09_int2_cc.html">Week 9</a>
</li>
</ol></section><section id="required-r-packages" class="level3"><h3 class="anchored" data-anchor-id="required-r-packages">
<i class="fab fa-r-project"></i> Required R Packages</h3>
<p>Remember to load all packages within a code chunk at the start of your RMarkdown file using <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>. If you do not have a package and need to install, do so within the console using <code>install.packages(" ")</code>. For further guidance on installing/updating packages, see Section C <a href="https://uoepsy.github.io/files/install-update-r#update-pkgs">here</a>.</p>
<p>For this lab, you will need to load the following package(s):</p>
<ul>
<li><strong>tidyverse</strong></li>
<li><strong>psych</strong></li>
<li><strong>sjPlot</strong></li>
<li><strong>kableExtra</strong></li>
<li><strong>car</strong></li>
</ul></section><section id="lab-data" class="level3"><h3 class="anchored" data-anchor-id="lab-data">
<i class="fa fa-file"></i> Lab Data</h3>
<p>You can download the data required for this lab <a href="https://uoepsy.github.io/data/scs_study.csv">here</a> or read it in via this link https://uoepsy.github.io/data/scs_study.csv.</p>
</section>
</div>
<section id="lab-overview" class="level1"><h1>Lab Overview</h1>
<p>In the previous labs, we have fitted a number of regression models, including some with multiple predictors. In each case, we first specified the model, then visually explored the marginal distributions and relationships of variables which would be used in the analysis. Finally, we fit the model, and began to examine the fit by studying what the various parameter estimates represented, and the spread of the residuals.</p>
<p>But before we draw inferences using our model estimates or use our model to make predictions, we need to be satisfied that our model meets a specific set of assumptions. If these assumptions are not satisfied, the results will not hold.</p>
<p>In this lab, we will check the assumptions of two models that we have previously fitted - one simple linear model, and one with multiple predictors. Specifically, we will check the assumptions from the simple linear regression model we fitted using the ‘riverview’ dataset in <a href="https://uoepsy.github.io/dapr2/2223/labs/1_02_slr.html">week 2</a>, and the assumptions of the multiple linear regression model we fitted using the ‘wellbeing’ dataset in <a href="https://uoepsy.github.io/dapr2/2223/labs/1_03_mlr.html">week 3</a>.</p>
</section></main>
</div>
<p class="optional-end">
</p>

<section id="setup" class="level1"><h1>Setup</h1>
<div class="question-begin">
Setup
</div>
<div class="question-body">
<ol type="1">
<li>Create a new RMarkdown file</li>
<li>Load the required package(s)</li>
<li>Read the riverview and wellbeing datasets into R, assigning them to objects named <code>rvdata</code> and <code>wbdata</code> respectively</li>
<li>Fit the following models:</li>
</ol>
<p><span class="math display">\[
Model 1: Income = \beta_0 + \beta_1 \ Education \\
\\
\\
Model 2: Wellbeing = \beta_0 + \beta_1  Social Interactions +  \beta_2  Outdoor Time \\
\]</span></p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-1" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-1', 'sol-start-1')"> Solution </span>
</div>
<div id="sol-body-1" class="solution-body" style="display: none;">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="co">#Loading the required package(s)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Reading in data and storing in object named 'scs_study'</span></span>
<span><span class="va">rvdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"https://uoepsy.github.io/data/riverview.csv"</span><span class="op">)</span></span>
<span><span class="va">wbdata</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"https://uoepsy.github.io/data/wellbeing.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#fit models</span></span>
<span><span class="co">## riverview model</span></span>
<span><span class="va">rv_mdl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">income</span> <span class="op">~</span> <span class="va">education</span>, data <span class="op">=</span> <span class="va">rvdata</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">## wellbeing model</span></span>
<span><span class="va">wb_mdl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">wellbeing</span> <span class="op">~</span> <span class="va">outdoor_time</span> <span class="op">+</span> <span class="va">social_int</span>, data <span class="op">=</span> <span class="va">wbdata</span><span class="op">)</span> </span></code></pre></div>
</div>
</div>
<p class="solution-end">
</p>
<p>You can remember the four assumptions by memorising the acronym LINE:</p>
<ul>
<li>
<strong>L</strong>inearity: The relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> is linear.</li>
<li>
<strong>I</strong>ndependence of errors: The error terms should be independent from one another.</li>
<li>
<strong>N</strong>ormality: The errors <span class="math inline">\(\epsilon\)</span> are normally distributed in the population.</li>
<li>
<strong>E</strong>qual variances (“Homoscedasticity”): The variability of the errors <span class="math inline">\(\epsilon\)</span> is constant across <span class="math inline">\(x\)</span>.</li>
</ul>
<p>If at least one of these assumptions does not hold, say N - Normality, you might be reporting a <strong><em>LIE</em></strong>.</p>
<p>Because we don’t have the data about the entire population, we check the assumptions on the errors by looking at their sample counterpart: the residuals from the fitted model = observed values - fitted values = <span class="math inline">\(y_i - \hat y_i\)</span>.<br>
The residuals <span class="math inline">\(\hat \epsilon_i\)</span> are the sample realisation of the actual, but unknown, true errors <span class="math inline">\(\epsilon_i\)</span> for the entire population. Because these same assumptions hold for a regression model with multiple predictors, we can assess them in a similar way. However, there are a number of important considerations.</p>
</section><section id="exercises" class="level1"><h1>Exercises</h1>
<section id="linearity" class="level2"><h2 data-anchor-id="linearity">Linearity</h2>
<div class="frame">
<section id="simple-linear-regression" class="level3"><h3 data-anchor-id="simple-linear-regression">Simple Linear Regression</h3>
<p>In simple linear regression (SLR) with only one explanatory variable, we could assess linearity through a simple scatterplot of the outcome variable against the explanatory. This would allow us to check if the errors have a mean of zero. If this assumption was met, the residuals would appear to be randomly scattered around zero.<br>
The rationale for this is that, once you remove from the data the linear trend, what’s left over in the residuals should not have any trend, i.e.&nbsp;have a mean of zero.</p>
</section><section id="multiple-regression" class="level3"><h3 data-anchor-id="multiple-regression">Multiple Regression</h3>
<p>In multiple regression, however, it becomes more necessary to rely on diagnostic plots of the model residuals. This is because we need to know whether the relations are linear between the outcome and each predictor <em>after accounting for the other predictors in the model.</em></p>
<p>In order to assess this, we use <strong>partial-residual plots</strong> (also known as ‘component-residual plots’). This is a plot with each explanatory variable <span class="math inline">\(x_j\)</span> on the x-axis, and <strong>partial residuals</strong> on the y-axis.</p>
<p>Partial residuals for a predictor <span class="math inline">\(x_j\)</span> are calculated as:</p>
<p><span class="math display">\[
\hat \epsilon + \hat \beta_j x_j
\]</span></p>
<p><strong>In R</strong> we can easily create these plots for all predictors in the model by using the <code><a href="https://rdrr.io/pkg/car/man/crPlots.html">crPlots()</a></code> function from the <strong>car</strong> package.</p>
</section>
</div>
<div class="question-begin">
Question 1
</div>
<div class="question-body">
<p>Check if the fitted model satisfies the linearity assumption for <code>rv_mdl1</code>. Write a sentence summarising whether or not you consider the assumption to have been met. Justify your answer with reference to the plots.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-2" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-2', 'sol-start-2')"> Solution </span>
</div>
<div id="sol-body-2" class="solution-body" style="display: none;">
<p>As usual, there are multiple equivalent ways to check this. Below are a couple of possibilities.</p>
<p>Residuals vs fitted values:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rv_mdl1</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co">#here what we need to see is that the red line is approximately horizontal at zero</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Some useful quantities:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">riverview_check</span> <span class="op">&lt;-</span> <span class="va">rvdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    income_hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">rv_mdl1</span><span class="op">)</span>,</span>
<span>    resid <span class="op">=</span> <span class="va">income</span> <span class="op">-</span> <span class="va">income_hat</span>,</span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>Residuals vs explanatory variable:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">riverview_check</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">income_hat</span>, y <span class="op">=</span> <span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br> Either of the above plots can be used to say:</p>
<div class="int">
<p>The residuals appear to be randomly scattered around zero, without showing any pattern with respect to the fitted values. Hence, there is no sign of violation of the zero-mean assumption.</p>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 2
</div>
<div class="question-body">
<p>Create partial-residual plots for the <code>wb_mdl1</code> model.<br>
Remember to load the <strong>car</strong> package first. If it does not load correctly, it might mean that you have need to install it.</p>
<p>Write a sentence summarising whether or not you consider the assumption to have been met. Justify your answer with reference to the plots.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-3" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-3', 'sol-start-3')"> Solution </span>
</div>
<div id="sol-body-3" class="solution-body" style="display: none;">
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/crPlots.html">crPlots</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<div class="int">
<p>The smoother (the pink line) follows quite closely to a linear relationship (the dashed blue line), suggesting that the linearity assumption is met.</p>
</div>
</div>
<p class="solution-end">
</p>
</section><section id="equal-variances-homoscedasticity" class="level2"><h2 data-anchor-id="equal-variances-homoscedasticity">Equal variances (Homoscedasticity)</h2>
<div class="frame">
<p>The equal variances assumption is that the error variance <span class="math inline">\(\sigma^2\)</span> is constant across values of the predictor(s) <span class="math inline">\(x_1, \dots, x_k\)</span>, and across values of the fitted values <span class="math inline">\(\hat y\)</span>. This sometimes gets termed “Constant” vs “Non-constant” variance. Figures @ref(fig:ncv1) &amp; @ref(fig:ncv2) shows what these look like visually.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_10_assump_diag_files/figure-html/ncv1-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Non-constant variance for numeric and categorical x</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_10_assump_diag_files/figure-html/ncv2-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Constant variance for numeric and categorical x</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><strong>In R</strong> we can create plots of the <em>Pearson residuals</em> against the predicted values <span class="math inline">\(\hat y\)</span> and against the predictors <span class="math inline">\(x_1\)</span>, … <span class="math inline">\(x_k\)</span> by using the <code><a href="https://rdrr.io/pkg/car/man/residualPlots.html">residualPlots()</a></code> function from the <strong>car</strong> package. This function also provides the results of a lack-of-fit test for each of these relationships (note when it is the fitted values <span class="math inline">\(\hat y\)</span> it gets called “Tukey’s test”).</p>
</div>
<div class="question-begin">
Question 3
</div>
<div class="question-body">
<p>Check if the fitted models <code>rv_mdl1</code> and <code>wb_mdl1</code> satisfy the equal variance assumption. Use <code><a href="https://rdrr.io/pkg/car/man/residualPlots.html">residualPlots()</a></code> to plot residuals against the predictor.</p>
<p>Write a sentence summarising whether or not you consider the assumption to have been met for each model. Justify your answer with reference to plots.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-4" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-4', 'sol-start-4')"> Solution </span>
</div>
<div id="sol-body-4" class="solution-body" style="display: none;">
<p>Let’s start with our <code>rv_mdl1</code> model. The vertical spread of the residuals should roughly be the same everywhere.</p>
<p>We can visually assess it by plotting the Pearson residuals against the fitted values:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/residualPlots.html">residualPlots</a></span><span class="op">(</span><span class="va">rv_mdl1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" style="width:90.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>           Test stat Pr(&gt;|Test stat|)
education    -0.0744           0.9412
Tukey test   -0.0744           0.9407</code></pre>
</div>
</div>
<p><strong>Quick Tip:</strong> As the residuals can be positive or negative, we can make it easier to assess equal spread by improving the ‘resolution’ of the points.</p>
<p>We can make all residuals positive by discarding the sign (take the absolute value), and then take the square root to make them closer to each other.</p>
<p>A plot of <span class="math inline">\(\sqrt{|\text{Standardized residuals}|}\)</span> against the fitted values is shown below:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rv_mdl1</span>, which <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plot above has the points closer to each other, and all above 0. The line seems to be relatively flat (as it should be if the spread was constant).</p>
<div class="int">
<p>The spread of the standardized residuals appears to be constant as the fitted values vary.</p>
</div>
<p>Now for our <code>wb_mdl1</code> model:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="co">#plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/residualPlots.html">residualPlots</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" style="width:90.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>             Test stat Pr(&gt;|Test stat|)
outdoor_time   -0.3478           0.7306
social_int     -0.1068           0.9157
Tukey test     -0.4189           0.6753</code></pre>
</div>
</div>
<div class="int">
<p>Partial residual plots show no clear non-linear trends between residuals and predictors.</p>
<p>Visual inspection of suggested little sign of non-constant variance.</p>
</div>
</div>
<p class="solution-end">
</p>
</section><section id="independence" class="level2"><h2 data-anchor-id="independence">Independence</h2>
<div class="frame">
<p>The ‘independence of errors’ assumption is the condition that the errors do not have some underlying relationship which is causing them to influence one another. <br></p>
<p>There are many sources of possible dependence, and often these are issues of study design. For example, we may have groups of observations in our data which we would expect to be related (e.g., multiple trials from the same participant). Our modelling strategy would need to take this into account. <br> One form of dependence is <strong>autocorrelation</strong> - this is when observations influence those adjacent to them. It is common in data for which <em>time</em> is a variable of interest (e.g, the humidity today is dependent upon the rainfall yesterday).</p>
</div>
<div class="question-begin">
Question 4
</div>
<div class="question-body">
<p>For both <code>rv_mdl1</code> and <code>wb_mdl1</code>, visually assess whether there is autocorrelation in the error terms.</p>
<p>Write a sentence summarising whether or not you consider the assumption of independence to have been met for each (you may have to assume certain aspects of the study design).</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-5" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-5', 'sol-start-5')"> Solution </span>
</div>
<div id="sol-body-5" class="solution-body" style="display: none;">
<p>Lets assess our <code>rv_mdl1</code> first.</p>
<p>To get a single figure made up of 2 by 1 panels, you can use the command <code>par(mfrow = c(1,2))</code>. Then create the plot. Then you need to go back to a single figure made up by a single panel with the command <code>par(mfrow = c(1,1))</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">rv_mdl1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">rv_mdl1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">rv_mdl1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="int">
<p>The plot of the residuals vs their index shows no clear dependence (if they were collected over time, for example, and there was an increasing trend this would highlight a violation). The residuals vs fitted plot shows that there is no association between the errors and the model predictions.</p>
</div>
<p>And now our <code>wb_mdl1</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="int">
<p>Similarly to above, the plot of the residuals vs their index shows no clear dependence, and the residuals vs fitted plot shows that there is no association between the errors and the model predictions.</p>
</div>
</div>
<p class="solution-end">
</p>
</section><section id="normality-of-errors" class="level2"><h2 data-anchor-id="normality-of-errors">Normality of errors</h2>
<div class="frame">
<p>The normality assumption is the condition that the errors <span class="math inline">\(\epsilon\)</span> are normally distributed in the population.</p>
<p>We can visually assess this condition through histograms, density plots, and quantile-quantile plots (QQplots) of our residuals <span class="math inline">\(\hat \epsilon\)</span>.</p>
</div>
<div class="question-begin">
Question 5
</div>
<div class="question-body">
<p>Assess the normality assumption by producing a qqplot of the residuals (either manually or using <code>plot(model, which = ???)</code>) for both <code>rv_mdl1</code> and <code>wb_mdl1</code>.</p>
<p>Write a sentence summarising whether or not you consider the assumption to have been met. Justify your answer with reference to the plots.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-6" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-6', 'sol-start-6')"> Solution </span>
</div>
<div id="sol-body-6" class="solution-body" style="display: none;">
<p>We can get the QQplot from one of the <code>plot(model)</code> plot. Remember that departures from a linear trend in QQ plots indicate a lack of normality.</p>
<p>First, lets check our <code>rv_mdl1</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rv_mdl1</span>, which <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="int">
<p>The normal quantile plot follows a linear pattern and does not highlight any substantial skew or departure from normality.</p>
</div>
<hr>
<p>Now onto <code>wb_mdl1</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">wb_mdl1</span>, which <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="int">
<p>The QQplot indicates that the residuals follow close to a normal distribution. Although there is some evidence of heavier tails, given the small sample size (n=32) it is not of concern and we can be more conservative in our visual assessment of the plot.</p>
</div>
</div>
<p class="solution-end">
</p>
</section><section id="multicollinearity" class="level2"><h2 data-anchor-id="multicollinearity">Multicollinearity</h2>
<div class="frame">
<p>For the linear model with <strong>multiple</strong> explanatory variables, we need to also think about <strong>multicollinearity</strong> - this is when two (or more) of the predictors in our regression model are moderately or highly correlated.<br><br> We can assess multicollinearity using the <strong>variance inflation factor (VIF)</strong>, which for a given predictor <span class="math inline">\(x_j\)</span> is calculated as:</p>
<p><span class="math display">\[
VIF_j = \frac{1}{1-R_j^2} \\
\]</span></p>
<p>Suggested cut-offs for VIF are varied. Some suggest 10, others 5. Define what you will consider an acceptable value <em>prior</em> to calculating it. You could loosely interpret VIF values larger than 5 as moderate multicollinearity and values larger than 10 as severe multicollinearity.</p>
<p><strong>In R</strong>, the <code><a href="https://rdrr.io/pkg/car/man/vif.html">vif()</a></code> function from the <strong>car</strong> package will provide VIF values for each predictor in your model.</p>
</div>
<div class="question-begin">
Question 6
</div>
<div class="question-body">
<p>Calculate the variance inflation factor (VIF) for the predictors in the model.</p>
<p>Write a sentence summarising whether or not you consider multicollinearity to be a problem here.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-7" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-7', 'sol-start-7')"> Solution </span>
</div>
<div id="sol-body-7" class="solution-body" style="display: none;">
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>outdoor_time   social_int 
     1.13023      1.13023 </code></pre>
</div>
</div>
<div class="int">
<p>The VIF values for all predictors are &lt;5, indicating that multicollinearity is not adversely affecting model estimates.</p>
</div>
</div>
<p class="solution-end">
</p>
</section><section id="individual-case-diagnostics" class="level2"><h2 data-anchor-id="individual-case-diagnostics">Individual Case Diagnostics</h2>
<div class="frame">
<p>We have seen in the case of the simple linear regression that individual cases in our data can influence our model more than others. We know about:</p>
<ul>
<li>
<strong>Regression outliers:</strong> A large residual <span class="math inline">\(\hat \epsilon_i\)</span> - i.e., a big discrepancy between their predicted y-value and their observed y-value.
<ul>
<li>
<strong>Standardised residuals:</strong> For residual <span class="math inline">\(\hat \epsilon_i\)</span>, divide by the estimate of the standard deviation of the residuals. In R, the <code><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard()</a></code> function will give you these</li>
<li>
<strong>Studentised residuals:</strong> For residual <span class="math inline">\(\hat \epsilon_i\)</span>, divide by the estimate of the standard deviation of the residuals excluding case <span class="math inline">\(i\)</span>. In R, the <code><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent()</a></code> function will give you these.</li>
</ul>
</li>
<li>
<strong>High leverage cases:</strong> These are cases which have considerable <em>potential</em> to influence the regression model (e.g., cases with an unusual combination of predictor values).
<ul>
<li>
<strong>Hat values:</strong> are used to assess leverage. In R, The <code><a href="https://rdrr.io/r/stats/influence.measures.html">hatvalues()</a></code> function will retrieve these.</li>
</ul>
</li>
<li>
<strong>High influence cases:</strong> When a case has high leverage <em>and</em> is an outlier, it will have a large influence on the regression model.
<ul>
<li>
<strong>Cook’s Distance:</strong> combines <em>leverage</em> (hatvalues) with <em>outlying-ness</em> to capture influence. In R, the <code><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance()</a></code> function will provide these. Alongside Cook’s Distance, we can examine the extent to which model estimates and predictions are affected when an entire case is dropped from the dataset and the model is refitted.<br>
</li>
</ul>
</li>
<li>
<strong>DFFit:</strong> the change in the predicted value at the <span class="math inline">\(i^{th}\)</span> observation with and without the <span class="math inline">\(i^{th}\)</span> observation is included in the regression.<br>
</li>
<li>
<strong>DFbeta:</strong> the change in a specific coefficient with and without the <span class="math inline">\(i^{th}\)</span> observation is included in the regression.<br>
</li>
<li>
<strong>DFbetas:</strong> the change in a specific coefficient divided by the standard error, with and without the <span class="math inline">\(i^{th}\)</span> observation is included in the regression.<br>
</li>
<li>
<strong>COVRATIO:</strong> measures the effect of an observation on the covariance matrix of the parameter estimates. In simpler terms, it captures an observation’s influence on standard errors.</li>
</ul>
<p>You can get a whole bucket-load of these measures with the <code><a href="https://rdrr.io/r/stats/influence.measures.html">influence.measures()</a></code> function:</p>
<ul>
<li>
<code>influence.measures(my_model)</code> will give you out a dataframe of the various measures.</li>
<li>
<code>summary(influence.measures(my_model))</code> will provide a nice summary of what R deems to be the influential points.</li>
</ul>
</div>
<div class="green">
<p>For questions 8-12, we will be working with our <code>wb_mdl1</code> only. Feel free to apply the below to your <code>rv_mdl1</code> too as as extra practice.</p>
</div>
<div class="question-begin">
Question 7
</div>
<div class="question-body">
<p>Create a new tibble which contains:</p>
<ol type="1">
<li>The original variables from the model (Hint, what does <code>wb_mdl1$model</code> give you?)</li>
<li>The fitted values from the model <span class="math inline">\(\hat y\)</span><br>
</li>
<li>The residuals <span class="math inline">\(\hat \epsilon\)</span>
</li>
<li>The studentised residuals</li>
<li>The hat values</li>
<li>The Cook’s Distance values.</li>
</ol>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-8" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-8', 'sol-start-8')"> Solution </span>
</div>
<div id="sol-body-8" class="solution-body" style="display: none;">
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">mdl_diagnost</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  <span class="va">wb_mdl1</span><span class="op">$</span><span class="va">model</span>,</span>
<span>  fitted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span>,</span>
<span>  resid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span>,</span>
<span>  studres <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span>,</span>
<span>  hats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hatvalues</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span>,</span>
<span>  cooksd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 8
</div>
<div class="question-body">
<p>Looking at the studentised residuals, are there any outliers?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-9" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-9', 'sol-start-9')"> Solution </span>
</div>
<div id="sol-body-9" class="solution-body" style="display: none;">
<p>In a standard normal distribution, 95% of the values are roughly between -2 and 2.</p>
<p>Because of this, studentised residuals of <span class="math inline">\(&gt;2\)</span> or <span class="math inline">\(&lt; -2\)</span> indicate potential outlyingness.</p>
<p>We can ask R whether the <em>absolute</em> values are <span class="math inline">\(&gt;2\)</span>:</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">mdl_diagnost</span><span class="op">$</span><span class="va">studres</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8     9    10    11    12    13 
FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE 
   27    28    29    30    31    32 
FALSE FALSE FALSE FALSE FALSE FALSE </code></pre>
</div>
</div>
<p>We could <em>filter</em> our newly created tibble to these observations:</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">mdl_diagnost</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">studres</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 8
# … with 8 variables: wellbeing &lt;dbl&gt;, outdoor_time &lt;dbl&gt;, social_int &lt;dbl&gt;,
#   fitted &lt;dbl&gt;, resid &lt;dbl&gt;, studres &lt;dbl&gt;, hats &lt;dbl&gt;, cooksd &lt;dbl&gt;</code></pre>
</div>
</div>
<p>There are zero rows.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 9
</div>
<div class="question-body">
<p>Looking at the hat values, are there any observations with high leverage?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-10" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-10', 'sol-start-10')"> Solution </span>
</div>
<div id="sol-body-10" class="solution-body" style="display: none;">
<p>Recall from the lectures, hat values of more than <span class="math inline">\(2 \bar{h}\)</span> (2 times the average hat value) are considered high leverage.</p>
<p>The average hat value, <span class="math inline">\(\bar{h}\)</span> is calculated as <span class="math inline">\(\frac{k + 1}{n}\)</span>, where <span class="math inline">\(k\)</span> is the number of predictors, and <span class="math inline">\(n\)</span> is the sample size. For our model:</p>
<p><span class="math display">\[
\bar h = \frac{k+1}{n} = \frac{2+1}{32} = \frac{3}{32} = 0.094
\]</span></p>
<p>We can ask whether any of observations have hat values which are greater than <span class="math inline">\(2 \bar h\)</span>:</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">mdl_diagnost</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hats</span> <span class="op">&gt;</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fl">0.094</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 8
# … with 8 variables: wellbeing &lt;dbl&gt;, outdoor_time &lt;dbl&gt;, social_int &lt;dbl&gt;,
#   fitted &lt;dbl&gt;, resid &lt;dbl&gt;, studres &lt;dbl&gt;, hats &lt;dbl&gt;, cooksd &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Note that 0 observations have high leverage.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 10
</div>
<div class="question-body">
<p>Looking at the Cook’s Distance values, are there any highly influential points?<br>
You can also display these graphically using <code>plot(model, which = 4)</code> and <code>plot(model, which = 5)</code>.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-11" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-11', 'sol-start-11')"> Solution </span>
</div>
<div id="sol-body-11" class="solution-body" style="display: none;">
<p>Recall from the lectures that we have a Cook’s Distance cut-off of <span class="math inline">\(\frac{4}{n-k-1}\)</span>, where <span class="math inline">\(k\)</span> is the number of predictors, and <span class="math inline">\(n\)</span> is the sample size.<br>
For our model:</p>
<p><span class="math display">\[
D_{cutoff} = \frac{4}{n-k-1} = \frac{4}{32 - 2 - 1} = \frac{4}{29} = 0.138
\]</span></p>
<p>There are no observations which have a high influence on our model estimates:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">mdl_diagnost</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cooksd</span> <span class="op">&gt;</span> <span class="fl">0.138</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 8
# … with 8 variables: wellbeing &lt;dbl&gt;, outdoor_time &lt;dbl&gt;, social_int &lt;dbl&gt;,
#   fitted &lt;dbl&gt;, resid &lt;dbl&gt;, studres &lt;dbl&gt;, hats &lt;dbl&gt;, cooksd &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 11
</div>
<div class="question-body">
<p>Use the function <code><a href="https://rdrr.io/r/stats/influence.measures.html">influence.measures()</a></code> to extract these delete-1 measures of influence.</p>
<p>Try plotting the distributions of some of these measures.</p>
<p><strong>Tip:</strong> the function <code><a href="https://rdrr.io/r/stats/influence.measures.html">influence.measures()</a></code> returns an <code>infl</code>-type object. To plot this, we need to find a way to extract the actual numbers from it.<br>
What do you think <code>names(influence.measures(wb_mdl1))</code> shows you? How can we use <code>influence.measures(wb_mdl1)$&lt;insert name here&gt;</code> to extract the matrix of numbers?</p>
<!-- Cooks > qf(0.5, k + 1, n - k - 1) -->
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-12" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-12', 'sol-start-12')"> Solution </span>
</div>
<div id="sol-body-12" class="solution-body" style="display: none;">
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">influence.measures</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Influence measures of
     lm(formula = wellbeing ~ outdoor_time + social_int, data = wbdata) :

     dfb.1_ dfb.otd_ dfb.scl_   dffit cov.r   cook.d    hat inf
1   0.43653 -0.11116 -0.32167  0.4477 1.157 0.066470 0.1489    
2  -0.28160  0.03170  0.22954 -0.2917 1.225 0.028838 0.1414    
3   0.29581  0.07604 -0.29025  0.3540 1.088 0.041520 0.0967    
4  -0.26445 -0.13055  0.29341 -0.3508 1.117 0.040991 0.1071    
5  -0.27084  0.22733  0.10472 -0.3290 1.279 0.036700 0.1766    
6   0.12462 -0.02693 -0.08288  0.1460 1.141 0.007277 0.0604    
7  -0.17361 -0.03392  0.15313 -0.2235 1.087 0.016770 0.0597    
8  -0.02879 -0.07259  0.06069 -0.0918 1.309 0.002906 0.1556    
9   0.16925  0.08820 -0.17834  0.2477 1.088 0.020553 0.0668    
10 -0.24768  0.33112 -0.00551 -0.4267 1.027 0.059217 0.0956    
11 -0.02018 -0.02535  0.02534 -0.0492 1.166 0.000834 0.0518    
12  0.04644  0.38731 -0.22045  0.4474 1.164 0.066462 0.1517    
13 -0.15606  0.21587 -0.02477 -0.3135 1.017 0.032241 0.0626    
14  0.13390 -0.31537  0.10705  0.3905 1.039 0.049887 0.0899    
15  0.14774 -0.25595  0.08688  0.4273 0.815 0.055918 0.0487    
16 -0.11881  0.17855 -0.06061 -0.3502 0.873 0.038519 0.0422    
17  0.00121 -0.07684  0.02608 -0.1031 1.177 0.003653 0.0703    
18  0.00329  0.04637 -0.01574  0.0739 1.159 0.001877 0.0516    
19  0.04301 -0.15310  0.09227  0.2432 1.055 0.019693 0.0546    
20  0.05819 -0.10961 -0.03803 -0.2189 1.065 0.016025 0.0508    
21 -0.01498  0.00131  0.03428  0.0875 1.131 0.002622 0.0380    
22  0.12553 -0.15510 -0.09098 -0.3084 1.020 0.031247 0.0622    
23 -0.03324 -0.00580  0.05840  0.1049 1.138 0.003770 0.0466    
24  0.24606 -0.23731 -0.18568 -0.4783 0.911 0.071967 0.0774    
25  0.06123  0.10878 -0.16017 -0.2209 1.131 0.016498 0.0771    
26 -0.02732 -0.29363  0.23790  0.3643 1.243 0.044752 0.1666    
27 -0.30514  0.33726  0.20108  0.5966 0.830 0.108234 0.0858    
28  0.06176 -0.07036 -0.03455 -0.1080 1.263 0.004013 0.1280    
29 -0.15327 -0.04611  0.23001  0.3039 1.067 0.030646 0.0754    
30  0.11226  0.25745 -0.30386 -0.3826 1.238 0.049262 0.1686    
31 -0.07637 -0.05313  0.12879  0.1542 1.214 0.008153 0.1047    
32  0.10249 -0.07000 -0.07662 -0.1399 1.353 0.006736 0.1864   *</code></pre>
</div>
</div>
<p>Let’s plot the distribution of COVRATIO statistics.<br>
Recall that values which are <span class="math inline">\(&gt;1+\frac{3(k+1)}{n}\)</span> or <span class="math inline">\(&lt;1-\frac{3(k+1)}{n}\)</span> are considered as having strong influence.<br>
For our model:</p>
<p><span class="math display">\[
1 \pm \frac{3(k+1)}{n} \quad = \quad 1 \pm\frac{3(2+1)}{32} \quad = \quad 1\pm \frac{9}{32} \quad = \quad 1\pm0.28
\]</span></p>
<p>The “infmat” bit of an <code>infl</code>-type object contains the numbers. To use it with ggplot, we will need to turn it into a dataframe (<code><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame()</a></code>), or a tibble (<code><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble()</a></code>):</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">infdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">influence.measures</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span><span class="op">$</span><span class="va">infmat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">infdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cov.r</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.28</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">0.28</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It looks like a few observations may be having quite a high influence here. This is perhaps not that surprising as we only have 32 datapoints.</p>
</div>
<p class="solution-end">
</p>
<hr>
<hr></section></section><section id="less-guided-exercises---extra-practice" class="level1"><h1>Less guided exercises - extra practice</h1>
<div class="question-begin">
Question 12
</div>
<div class="question-body">
<p>Create a new section header in your Rmarkdown document, as we are moving onto a different dataset.</p>
<p>The code below loads the dataset of 656 participants’ scores on Big 5 Personality traits, perceptions of social ranks, and scores on a depression and anxiety scale.<br><br></p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">scs_study</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://uoepsy.github.io/data/scs_study.csv"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 656 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (7): zo, zc, ze, za, zn, scs, dass

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p><br></p>
<ol type="1">
<li>Fit the following interaction model:
<ul>
<li><span class="math inline">\(\text{DASS-21 Score} = \beta_0 + \beta_1 \cdot \text{SCS Score} + \beta_2 \cdot \text{Neuroticism} + \beta_3 \cdot \text{SCS score} \cdot \text{Neuroticism} + \epsilon\)</span></li>
</ul>
</li>
<li>Check that the model meets the assumptions of the linear model (<strong>Tip:</strong> to get a broad overview you can pass your model to the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function to get a series of plots).</li>
<li>If you notice any violated assumptions:
<ul>
<li>address the issues by, e.g., excluding observations from the analysis, or replacing outliers with the next most extreme value (<em>Winsorisation</em>).</li>
<li>after fitting a new model which you hope addresses violations, you need to check <strong>all</strong> of your assumptions again. It can be an iterative process, and the most important thing is that your <em>final</em> model (the one you plan to <strong>use</strong>) meets all the assumptions.</li>
</ul>
</li>
</ol>
<hr>
<p><strong>Tips:</strong></p>
<ul>
<li>When there is an interaction in the model, assessing linearity becomes difficult. In fact, <code><a href="https://rdrr.io/pkg/car/man/crPlots.html">crPlots()</a></code> will not work. To assess, you can create a residuals-vs-fitted plot like we saw in the guided exercises above.<br>
</li>
<li>Interaction terms often result in multicollinearity, because these terms are made up of the product of some ‘main effects’. Mean-centering the variables like we have here will reduce this source of structural multicollinearity (“structural” here refers to the fact that multicollinearity is due to our model specification, rather than the data itself)<br>
</li>
<li>You can fit a model and exclude specific observations. For instance, to remove the 3rd and 5th rows of the dataset: <code>lm(y ~ x1 + x2, data = dataset[-c(3,5),])</code>. Be careful to remember that these values remain in the dataset, they have simply been excluded from the model fit.</li>
</ul>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-13" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-13', 'sol-start-13')"> Solution </span>
</div>
<div id="sol-body-13" class="solution-body" style="display: none;">
<p>We’re going to mean-center the <code>scs</code> variable from the outset. ::: {.cell}</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">scs_study</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://uoepsy.github.io/data/scs_study.csv"</span><span class="op">)</span>  </span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 656 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (7): zo, zc, ze, za, zn, scs, dass

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">scs_study</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">scs_study</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    scs_mc <span class="op">=</span> <span class="va">scs</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">scs</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">dass_mdl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">dass</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">scs_mc</span> <span class="op">*</span> <span class="va">zn</span>, data <span class="op">=</span> <span class="va">scs_study</span><span class="op">)</span></span></code></pre></div>
<p>:::</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dass_mdl2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
<p>From quick visual inspection, it looks like there is at least one very influential point, which has been labelled for us as case number 35.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">scs_study</span><span class="op">[</span><span class="fl">35</span>, <span class="op">]</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
     zo    zc    ze     za    zn   scs  dass scs_mc
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 0.645 -1.49 0.970 -0.121  2.24    54    65   18.2</code></pre>
</div>
</div>
<p>The code below fits a new model and assigns it the name <code>dass_mdl3</code>. How is it different from the previous model?</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">dass_mdl3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">dass</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">scs_mc</span> <span class="op">*</span> <span class="va">zn</span>, data <span class="op">=</span> <span class="va">scs_study</span><span class="op">[</span><span class="op">-</span><span class="fl">35</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Does this new model meet the assumptions of multiple regression?</p>
<p><strong>Linearity</strong> ::: {.cell}</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dass_mdl3</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<p>:::</p>
<p><strong>Equal variances (Homoscedasticity)</strong> ::: {.cell}</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/residualPlots.html">residualPlots</a></span><span class="op">(</span><span class="va">dass_mdl3</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>           Test stat Pr(&gt;|Test stat|)
scs_mc        1.6260           0.1044
zn           -0.5074           0.6121
Tukey test   -1.3170           0.1878</code></pre>
</div>
<p>:::</p>
<p><strong>Independence of errors</strong> ::: {.cell}</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">dass_mdl3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">dass_mdl3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">dass_mdl3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>:::</p>
<p><strong>Normality</strong> ::: {.cell}</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">dass_mdl3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="1_10_assump_diag_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
<p>:::</p>
<p><strong>Check for multicollinearity</strong> ::: {.cell}</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">dass_mdl3</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>there are higher-order terms (interactions) in this model
consider setting type = 'predictor'; see ?vif</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   scs_mc        zn scs_mc:zn 
 1.010026  1.010174  1.000240 </code></pre>
</div>
<p>:::</p>
</div>
<p class="solution-end">
</p>


</section><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><!-- /content --><footer class="footer"><div class="nav-footer">
      <div class="nav-footer-center">© Copyright 2019-2022 <a href="https://www.ed.ac.uk/">The University of Edinburgh</a>. Site licensed under the <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">GNU AGPLv3</a> license.</div>
  </div>
</footer>


</body></html>