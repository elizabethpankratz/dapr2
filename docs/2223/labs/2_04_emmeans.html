<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>DAPR2 - Simple Effects, Pairwise Comparisons, Corrections</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-chevron-circle-right')) {
    f.classList.add('fa-chevron-circle-down')
    f.classList.remove('fa-chevron-circle-right')
} else {
    f.classList.add('fa-chevron-circle-right')
    f.classList.remove('fa-chevron-circle-down')
}
}
</script><script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DAPR2</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-intro-to-linear-models" role="button" data-bs-toggle="dropdown" aria-expanded="false">Intro to Linear Models</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-intro-to-linear-models">
<li>
    <a class="dropdown-item" href="./1_01_function.html">
 <span class="dropdown-text">1/1: Functions and Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_02_slr.html">
 <span class="dropdown-text">1/2: Intro to Linear Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_03_mlr.html">
 <span class="dropdown-text">1/3: Multiple Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_04_model_fit.html">
 <span class="dropdown-text">1/4: Model Fit and Standardization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_05_cat_recap.html">
 <span class="dropdown-text">1/5: Cat Predictors &amp; Recap</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-more-linear-models" role="button" data-bs-toggle="dropdown" aria-expanded="false">More Linear Models</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-more-linear-models">
<li>
    <a class="dropdown-item" href="./1_07_int1_nc.html">
 <span class="dropdown-text">1/7: Interactions I: Num x Cat</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_08_int2_nn.html">
 <span class="dropdown-text">1/8: Interactions II: Num x Num</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_09_int3_cc.html">
 <span class="dropdown-text">1/9: Interactions III: Cat x Cat</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_10_assump_diag.html">
 <span class="dropdown-text">1/10: Assumptions &amp; Diagnostics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_11_writeup_recap.html">
 <span class="dropdown-text">1/11: Write Up &amp; Recap</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analysing-experimental-studies" role="button" data-bs-toggle="dropdown" aria-expanded="false">Analysing Experimental Studies</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analysing-experimental-studies">
<li>
    <a class="dropdown-item" href="./2_01_model_comps.html">
 <span class="dropdown-text">2/1: Model Comparison</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./2_02_effects.html">
 <span class="dropdown-text">2/2: Effects Coding</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./2_03_contrasts.html">
 <span class="dropdown-text">2/3: Contrasts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./2_04_emmeans.html">
 <span class="dropdown-text">2/4: Simple Effects &amp; Pairwise Comparisons</span></a>
  </li>  
        <li class="dropdown-header">2/5: Write Up &amp; Recap</li>
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-advanced-topics-for-lm" role="button" data-bs-toggle="dropdown" aria-expanded="false">Advanced Topics for LM</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-advanced-topics-for-lm">
<li class="dropdown-header">2/6: Binary Logistic Regression</li>
        <li class="dropdown-header">2/7: More Logistic Regression</li>
        <li class="dropdown-header">2/8: Sample Size &amp; Power Analysis</li>
        <li class="dropdown-header">2/9: Write Up &amp; Recap</li>
        <li class="dropdown-header">2/10: Mock Exam</li>
    </ul>
</li>
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#study-overview" id="toc-study-overview" class="nav-link active" data-scroll-target="#study-overview">Study Overview</a></li>
  <li>
<a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a>
  <ul class="collapse">
<li><a href="#contrast-analysis" id="toc-contrast-analysis" class="nav-link" data-scroll-target="#contrast-analysis">Contrast analysis</a></li>
  <li><a href="#simple-effects" id="toc-simple-effects" class="nav-link" data-scroll-target="#simple-effects">Simple Effects</a></li>
  <li><a href="#pairwise-comparisons-multiple-corrections" id="toc-pairwise-comparisons-multiple-corrections" class="nav-link" data-scroll-target="#pairwise-comparisons-multiple-corrections">Pairwise Comparisons &amp; Multiple Corrections</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Simple Effects, Pairwise Comparisons, Corrections</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div class="lo">
<section id="learning-objectives" class="level3"><h3 class="anchored" data-anchor-id="learning-objectives">
<i class="fa fa-graduation-cap"></i> Learning Objectives</h3>
<p>At the end of this lab, you will:</p>
<ol type="1">
<li>Understand how to interpret simple effects for experimental designs</li>
<li>Understand how to conduct pairwise comparisons</li>
<li>Understand how to apply corrections available for multiple comparisons</li>
</ol></section><section id="what-you-need" class="level3"><h3 class="anchored" data-anchor-id="what-you-need">
<i class="fa fa-check-square-o fa-2"></i> What You Need</h3>
<ol type="1">
<li>Be up to date with lectures</li>
<li>Have completed previous lab exercises from <a href="https://uoepsy.github.io/dapr2/2223/labs/2_01_model_comps.html">Week 1</a>, <a href="https://uoepsy.github.io/dapr2/2223/labs/2_02_effects.html">Week 2</a>, and <a href="https://uoepsy.github.io/dapr2/2223/labs/2_03_contrasts.html">Week 3</a>
</li>
</ol></section><section id="required-r-packages" class="level3"><h3 class="anchored" data-anchor-id="required-r-packages">
<i class="fab fa-r-project"></i> Required R Packages</h3>
<p>Remember to load all packages within a code chunk at the start of your RMarkdown file using <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>. If you do not have a package and need to install, do so within the console using <code>install.packages(" ")</code>. For further guidance on installing/updating packages, see Section C <a href="https://uoepsy.github.io/files/install-update-r#update-pkgs">here</a>.</p>
<p>For this lab, you will need to load the following package(s):</p>
<ul>
<li><strong>tidyverse</strong></li>
<li><strong>psych</strong></li>
<li><strong>kableExtra</strong></li>
<li><strong>stargazer</strong></li>
<li><strong>patchwork</strong></li>
<li><strong>emmeans</strong></li>
</ul></section><section id="lab-data" class="level3"><h3 class="anchored" data-anchor-id="lab-data">
<i class="fa fa-file"></i> Lab Data</h3>
<p>You can download the data required for this lab <a href="https://uoepsy.github.io/data/cognitive_experiment.csv">here</a> or read it in via this link https://uoepsy.github.io/data/cognitive_experiment.csv. Note, you have already worked with <em>some</em> of this data before - see <a href="https://uoepsy.github.io/dapr2/labs/1_08_int_cc.html">Semester 1 week 8 lab</a>, but we now have a third Task condition - Classification.</p>
</section>
</div>
<section id="study-overview" class="level1"><h1>Study Overview</h1>
<blockquote class="blockquote">
<p><strong>Research Question</strong></p>
<p>Are there differences in types of memory deficits for those experiencing different cognitive impairment(s)?</p>
</blockquote>
<p>In this week’s exercises, we will further explore questions such as:</p>
<ul>
<li>Does level <span class="math inline">\(i\)</span> of the first factor have an effect on the response?</li>
<li>Does level <span class="math inline">\(j\)</span> of the second factor have an effect on the response?</li>
<li>Is there a combined effect of level <span class="math inline">\(i\)</span> of the first factor and level <span class="math inline">\(j\)</span> of the second factor on the response? In other words, is there interaction of the two factors so that the combined effect is not simply the additive effect of level <span class="math inline">\(i\)</span> of the first factor plus the effect of level <span class="math inline">\(j\)</span> of the second factor?</li>
</ul>
<div class="optional-begin">
<span id="opt-start-1" class="fa fa-chevron-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-1', 'opt-start-1')"> <span class="olab">Cognitive Exp 3x3 Codebook</span></span>
</div>
<div id="opt-body-1" class="optional-body" style="display: none;">
<p><strong>Description</strong></p>
<p>The researchers designed a study yielding a <span class="math inline">\(3 \times 3\)</span> factorial design to test whether there are differences in types of memory deficits for those experiencing different cognitive impairment(s).</p>
<p>The first factor, “Diagnosis”, classifies the three types of individuals:</p>
<ul>
<li>1 denotes amnesic patients;</li>
<li>2 denotes Huntingtons patients; and</li>
<li>3 denotes a control group of individuals with no known neurological disorder.</li>
</ul>
<p>The second factor, “Task”, tells us to which of two tasks each study participant was randomly assigned to:</p>
<ul>
<li>1 = grammar task, which consists of classifying letter sequences as either following or not following grammatical rules; and</li>
<li>2 = recognition task, which consists of recognising particular stimuli as stimuli that have previously been presented during the task.</li>
<li>3 = classification task, which consists of classifying stimuli into certain groupings, based on previously indicated information about the groups characteristics</li>
</ul>
<p>The tasks chosen by the researchers have been picked to map onto the theoretical differences between the three types of research participants. The Grammar and Classification tasks are known to reflect <em>implicit</em> memory processes, whereas the recognition task is known to reflect <em>explicit</em> memory processes. If the theory is correct, we would expect the difference in scores between the recognition and grammar/classification tasks to be relatively similar for the control and amnesiac groups, but relatively larger for the Huntingtons group compared to controls.</p>
<p><strong>Preview</strong></p>
<p>We have data from the 45 participants (15 amnesiacs, 15 Huntington individuals, and 15 controls). Recall that study involves two factors, now with three levels each. For each combination of factor levels we have 5 observations:</p>
<p>The first ten rows of the data are:</p>
<div class="cell">
<div class="cell-output-display">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1"></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Task</div></th>
</tr>
<tr>
<th style="text-align:left;"> Diagnosis </th>
   <th style="text-align:left;"> grammar </th>
   <th style="text-align:left;"> classification </th>
   <th style="text-align:left;"> recognition </th>
  </tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;"> amnesic </td>
   <td style="text-align:left;"> 44, 63, 76, 72, 45 </td>
   <td style="text-align:left;"> 72, 66, 55, 82, 75 </td>
   <td style="text-align:left;"> 70, 51, 82, 66, 56 </td>
  </tr>
<tr>
<td style="text-align:left;"> huntingtons </td>
   <td style="text-align:left;"> 24, 30, 51, 55, 40 </td>
   <td style="text-align:left;"> 53, 59, 33, 37, 43 </td>
   <td style="text-align:left;"> 107, 80, 98, 82, 108 </td>
  </tr>
<tr>
<td style="text-align:left;"> control </td>
   <td style="text-align:left;"> 76, 98, 71, 70, 85 </td>
   <td style="text-align:left;"> 92, 65, 86, 67, 90 </td>
   <td style="text-align:left;"> 107, 80, 101, 82, 105 </td>
  </tr>
</tbody>
</table>
</div>
</div>
<p>The five observations are assumed to come from a population having a specific mean. The population means corresponding to each combination of factor levels can be schematically written as:</p>
<p><span class="math display">\[
\begin{matrix}
                   &amp;         &amp;         &amp; \textbf{Task} &amp; \\
                   &amp;         &amp; (j=1)\text{ grammar} &amp; (j=2)\text{ classification} &amp; (j=3)\text{ recognition} \\
                   &amp; (i=1)\text{ control} &amp; \mu_{1,1} &amp; \mu_{1,2} &amp; \mu_{1,3} \\
\textbf{Diagnosis} &amp; (i=2)\text{ amnesic} &amp; \mu_{2,1} &amp; \mu_{2,2} &amp; \mu_{2,3} \\
                   &amp; (i=3)\text{ huntingtons} &amp; \mu_{3,1} &amp; \mu_{3,2} &amp; \mu_{3,3}
\end{matrix}
\]</span></p>
</div>
<p class="optional-end">
</p>
</section><section id="setup" class="level1"><h1>Setup</h1>
<div class="question-begin">
Setup
</div>
<div class="question-body">
<ol type="1">
<li>Create a new RMarkdown file</li>
<li>Load the required package(s)</li>
<li>Read the cognitive_experiment dataset into R, assigning it to an object named <code>cog</code>
</li>
</ol>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-2" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-2', 'sol-start-2')"> Solution </span>
</div>
<div id="sol-body-2" class="solution-body" style="display: none;">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="co">#load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans">emmeans</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stargazer</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#read in data</span></span>
<span><span class="va">cog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">'https://uoepsy.github.io/data/cognitive_experiment.csv'</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<p class="solution-end">
</p>
<p><br></p>
<div class="question-begin">
Question 1
</div>
<div class="question-body">
<p>Firstly, examine the dataset, and perform any necessary and appropriate data management steps.</p>
<p>Next, consider would be the most appropriate coding constraint to apply in order to best address the research question - i.e., are we interested in whether group X (e.g., Amnesic) differed from group Y (e.g., Huntingtons), or whether group X (e.g., Amnesic) differed from the global/grand mean?</p>
<p>Make any appropriate changes to reference levels if required based on your decision above.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-3" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-3', 'sol-start-3')"> Solution </span>
</div>
<div id="sol-body-3" class="solution-body" style="display: none;">
<p>First step is to always look at the data we are working with - <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> or <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> are a good place to start</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">cog</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spec_tbl_df [45 × 3] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Diagnosis: num [1:45] 1 1 1 1 1 1 1 1 1 1 ...
 $ Task     : num [1:45] 1 1 1 1 1 2 2 2 2 2 ...
 $ Y        : num [1:45] 44 63 76 72 45 72 66 55 82 75 ...
 - attr(*, "spec")=
  .. cols(
  ..   Diagnosis = col_double(),
  ..   Task = col_double(),
  ..   Y = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>Convert <code>Diagnosis</code> and <code>Task</code> into factors, making the labels of each factor level more meaningful.</p>
<p>According to the data description, the encoding of the factor <code>Diagnosis</code> is: 1 = amnesic patients, 2 = Huntingtons patients, and 3 are control patients. The encoding for the factor <code>Task</code> is: 1 = grammar task, 2 = classification task, and 3 = recognition task.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">cog</span><span class="op">$</span><span class="va">Diagnosis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cog</span><span class="op">$</span><span class="va">Diagnosis</span>, </span>
<span>                        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"amnesic"</span>, <span class="st">"huntingtons"</span>, <span class="st">"control"</span><span class="op">)</span>, </span>
<span>                        ordered <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">cog</span><span class="op">$</span><span class="va">Task</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cog</span><span class="op">$</span><span class="va">Task</span>, </span>
<span>                   labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grammar"</span>, <span class="st">"classification"</span>, <span class="st">"recognition"</span><span class="op">)</span>, </span>
<span>                   ordered <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Rename the response so that we have a more meaningful name than “Y”:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">cog</span> <span class="op">&lt;-</span> <span class="va">cog</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>Score <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Re-examine the data:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cog</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Diagnosis Task           Score
  &lt;fct&gt;     &lt;fct&gt;          &lt;dbl&gt;
1 amnesic   grammar           44
2 amnesic   grammar           63
3 amnesic   grammar           76
4 amnesic   grammar           72
5 amnesic   grammar           45
6 amnesic   classification    72</code></pre>
</div>
</div>
<p>Check for NAs:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="co">#check for NAs - there are none - all FALSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">cog</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE 
  135 </code></pre>
</div>
</div>
<p>Since we are interested in comparing groups, we should use dummy coding. By default, <code>R</code> uses dummy coding, so we do not need to make any changes to the coding constraint. However, if we’re going to have a reference group, we’re likely to want it to be the Control group. Likewise for the Tasks, the recognition task measures ‘explicity memory’ whereas the other two measure ‘implicit memory’, so it arguably makes sense to use that as the reference group.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">cog</span><span class="op">$</span><span class="va">Diagnosis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">cog</span><span class="op">$</span><span class="va">Diagnosis</span>, <span class="st">"control"</span><span class="op">)</span></span>
<span><span class="va">cog</span><span class="op">$</span><span class="va">Task</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">cog</span><span class="op">$</span><span class="va">Task</span>, <span class="st">"recognition"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Now, let’s summarise our data checks and cleaning:</p>
<div class="callout-important callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>All participant data was complete, and categorical variables were coded as factors. In terms of reference groups, we re-leveled the <code>Diagnosis</code> factor so that the reference group was Control (since the other two groups have some form of cognitive impairment), and the <code>Task</code> factor to have Recognition as the reference group (since it measures explicit memory whilst the other two task types implicit).</p>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<p><br></p>
<div class="question-begin">
Question 2
</div>
<div class="question-body">
<p>Provide a table of descriptive statistics and visualise your data.</p>
<p>Remember to interpret your plot in the context of the study (i.e., comment on any observed differences among treatment groups).</p>
<div class="callout-tip callout callout-style-simple callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>For your table of descriptive statistics, both the <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> functions will come in handy here.</li>
<li>Recall that when visualising a continuous outcome across several groups, <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code> may be most appropriate to use.</li>
<li>Make sure to comment on any observed differences among the sample means of the four treatment conditions.</li>
</ol>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-4" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-4', 'sol-start-4')"> Solution </span>
</div>
<div id="sol-body-4" class="solution-body" style="display: none;">
<p>Let’s first produce a descriptive statistics table:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">cog_stats</span> <span class="op">&lt;-</span> <span class="va">cog</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Diagnosis</span>, <span class="va">Task</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>        Avg_Score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Score</span><span class="op">)</span>, </span>
<span>        SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Score</span><span class="op">)</span>,</span>
<span>        SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Score</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Score</span><span class="op">)</span>,</span>
<span>        Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Score</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Descriptive Statistics"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cog_stats</span></span></code></pre></div>
<div class="cell-output-display">
<div id="tbl-cog-descript" class="anchored">

<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>Table 1:  Descriptive Statistics </caption>
 <thead><tr>
<th style="text-align:left;"> Diagnosis </th>
   <th style="text-align:left;"> Task </th>
   <th style="text-align:right;"> Avg_Score </th>
   <th style="text-align:right;"> SD </th>
   <th style="text-align:right;"> SE </th>
   <th style="text-align:right;"> Min </th>
   <th style="text-align:right;"> Max </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> control </td>
   <td style="text-align:left;"> recognition </td>
   <td style="text-align:right;"> 95 </td>
   <td style="text-align:right;"> 12.98 </td>
   <td style="text-align:right;"> 5.81 </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 107 </td>
  </tr>
<tr>
<td style="text-align:left;"> control </td>
   <td style="text-align:left;"> grammar </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 11.68 </td>
   <td style="text-align:right;"> 5.22 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 98 </td>
  </tr>
<tr>
<td style="text-align:left;"> control </td>
   <td style="text-align:left;"> classification </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 12.98 </td>
   <td style="text-align:right;"> 5.81 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:right;"> 92 </td>
  </tr>
<tr>
<td style="text-align:left;"> amnesic </td>
   <td style="text-align:left;"> recognition </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:right;"> 12.17 </td>
   <td style="text-align:right;"> 5.44 </td>
   <td style="text-align:right;"> 51 </td>
   <td style="text-align:right;"> 82 </td>
  </tr>
<tr>
<td style="text-align:left;"> amnesic </td>
   <td style="text-align:left;"> grammar </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 14.92 </td>
   <td style="text-align:right;"> 6.67 </td>
   <td style="text-align:right;"> 44 </td>
   <td style="text-align:right;"> 76 </td>
  </tr>
<tr>
<td style="text-align:left;"> amnesic </td>
   <td style="text-align:left;"> classification </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 10.17 </td>
   <td style="text-align:right;"> 4.55 </td>
   <td style="text-align:right;"> 55 </td>
   <td style="text-align:right;"> 82 </td>
  </tr>
<tr>
<td style="text-align:left;"> huntingtons </td>
   <td style="text-align:left;"> recognition </td>
   <td style="text-align:right;"> 95 </td>
   <td style="text-align:right;"> 13.38 </td>
   <td style="text-align:right;"> 5.98 </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 108 </td>
  </tr>
<tr>
<td style="text-align:left;"> huntingtons </td>
   <td style="text-align:left;"> grammar </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:right;"> 13.25 </td>
   <td style="text-align:right;"> 5.92 </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:right;"> 55 </td>
  </tr>
<tr>
<td style="text-align:left;"> huntingtons </td>
   <td style="text-align:left;"> classification </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:right;"> 10.86 </td>
   <td style="text-align:right;"> 4.86 </td>
   <td style="text-align:right;"> 33 </td>
   <td style="text-align:right;"> 59 </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Since we have a continuous outcome and 2 categorical predictors - a boxplot would be most appropriate for visualisations:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">cog_plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cog</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Diagnosis</span>, y <span class="op">=</span> <span class="va">Score</span>, color <span class="op">=</span> <span class="va">Task</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Diagnosis'</span>, y <span class="op">=</span> <span class="st">'Average Score'</span><span class="op">)</span></span>
<span><span class="va">cog_plt</span></span></code></pre></div>
<div class="cell-output-display">
<div id="fig-cog-desc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="2_04_emmeans_files/figure-html/fig-cog-desc-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 1: Association between Task Condition, Diagnosis, and Average Score</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="callout-important callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li><p>Control patients consistently perform best across all tasks. They don’t seem to differ substantially in their scores between grammar and classification tasks, but they clearly perform better in the recognition task than the grammar and classification ones.</p></li>
<li><p>Amnesic patients appear to perform better than Huntingtons patients in grammar an classification tasks (reflecting intrinsic memory processes) and perform worse than Huntingtons patients in the recognition task (reflecting extrinsic memory processes).</p></li>
</ul>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<p><br></p>
<div class="question-begin">
Question 3
</div>
<div class="question-body">
<p>Formally state:</p>
<ul>
<li>the linear model(s) to investigate whether there are differences in Score based on Diagnosis and Task conditions</li>
<li>your chosen significance level</li>
<li>the null and alternative hypotheses</li>
</ul>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-5" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-5', 'sol-start-5')"> Solution </span>
</div>
<div id="sol-body-5" class="solution-body" style="display: none;">
<p>Based on previous plotting, it does seem that there is a clear interaction between diagnosis and task. However, we have not <strong>statistically compared our interaction model to an additive model</strong> (same model but without the interaction). This is what the RQ warrants, and until we make this comparison, we cannot confidently progress on the <em>assumption</em> that the interaction model is the most suitable for answering the research question. Thus, we need to fit both models:</p>
<p><span class="math display">\[
\begin{aligned}
Additive Model: Score &amp;= \beta_0 \\
      &amp;+ \beta_1 D_\text{Amnseic} + \beta_2 D_\text{Huntingtons}   \\
      &amp;+ \beta_3 T_\text{Grammar}  + \beta_4 T_\text{Classification} \\
      &amp;+ \epsilon
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
Interaction Model: Score &amp;= \beta_0 \\
      &amp;+ \beta_1 D_\text{Amnseic} + \beta_2 D_\text{Huntingtons}   \\
      &amp;+ \beta_3 T_\text{Grammar}  + \beta_4 T_\text{Classification} \\
      &amp;+ \beta_5 (D_\text{Amnseic} * T_\text{Grammar}) + \beta_6 (D_\text{Huntingtons} * T_\text{Grammar})  \\
      &amp;+ \beta_7 (D_\text{Amnseic} * T_\text{Classification}) + \beta_8 (D_\text{Huntingtons} * T_\text{Classification})  \\
      &amp;+ \epsilon
\end{aligned}
\]</span></p>
<p>Effects will be considered statistically significant at <span class="math inline">\(\alpha=.05\)</span></p>
<p>Our hypotheses are:</p>
<p><span class="math inline">\(H_0:\)</span> All <span class="math inline">\(\beta_j = 0\)</span> (for <span class="math inline">\(j = 5, 6, 7, 8\)</span>)</p>
<p>There are no significant differences in performance between explicit and implicit memory tasks for patients different cognitive impairment(s).</p>
<p><span class="math inline">\(H_1:\)</span> At least one <span class="math inline">\(\beta_j \neq 0\)</span> (for <span class="math inline">\(j = 5, 6, 7, 8\)</span>)</p>
<p>There are significant differences in performance between explicit and implicit memory tasks for patients different cognitive impairment(s).</p>
<p>We will statistically compare the additive and interaction model using <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> in order to determine which model best explains our data (i.e., the assocation between memory deficits and different cognitive impairments)</p>
</div>
<p class="solution-end">
</p>
<p><br></p>
<div class="question-begin">
Question 4
</div>
<div class="question-body">
<p>Fit the specified models, and assign them the names “mdl_add” and “mdl_int” as appropriate.</p>
<p>Provide key model results from the two models in a single formatted table, and report the results of the model comparison in APA format.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-6" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-6', 'sol-start-6')"> Solution </span>
</div>
<div id="sol-body-6" class="solution-body" style="display: none;">
<p>Let’s first fit our two models, and compare via <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="co">#Additive Model</span></span>
<span><span class="va">mdl_add</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Score</span> <span class="op">~</span> <span class="va">Diagnosis</span> <span class="op">+</span> <span class="va">Task</span>, data <span class="op">=</span> <span class="va">cog</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mdl_add</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Score ~ Diagnosis + Task, data = cog)

Residuals:
   Min     1Q Median     3Q    Max 
   -29    -12      1     10     33 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           100.000      5.447  18.360  &lt; 2e-16 ***
Diagnosisamnesic      -20.000      5.967  -3.352 0.001762 ** 
Diagnosishuntingtons  -25.000      5.967  -4.190 0.000149 ***
Taskgrammar           -25.000      5.967  -4.190 0.000149 ***
Taskclassification    -20.000      5.967  -3.352 0.001762 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 16.34 on 40 degrees of freedom
Multiple R-squared:  0.4958,    Adjusted R-squared:  0.4453 
F-statistic: 9.831 on 4 and 40 DF,  p-value: 1.233e-05</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="co">#Interaction Model</span></span>
<span><span class="va">mdl_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Score</span> <span class="op">~</span> <span class="va">Diagnosis</span> <span class="op">*</span> <span class="va">Task</span>, data <span class="op">=</span> <span class="va">cog</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mdl_int</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Score ~ Diagnosis * Task, data = cog)

Residuals:
   Min     1Q Median     3Q    Max 
   -16    -12      2     11     18 

Coefficients:
                                          Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                              9.500e+01  5.617e+00  16.912  &lt; 2e-16
Diagnosisamnesic                        -3.000e+01  7.944e+00  -3.776 0.000576
Diagnosishuntingtons                     2.605e-15  7.944e+00   0.000 1.000000
Taskgrammar                             -1.500e+01  7.944e+00  -1.888 0.067085
Taskclassification                      -1.500e+01  7.944e+00  -1.888 0.067085
Diagnosisamnesic:Taskgrammar             1.000e+01  1.123e+01   0.890 0.379329
Diagnosishuntingtons:Taskgrammar        -4.000e+01  1.123e+01  -3.560 0.001063
Diagnosisamnesic:Taskclassification      2.000e+01  1.123e+01   1.780 0.083490
Diagnosishuntingtons:Taskclassification -3.500e+01  1.123e+01  -3.115 0.003597
                                           
(Intercept)                             ***
Diagnosisamnesic                        ***
Diagnosishuntingtons                       
Taskgrammar                             .  
Taskclassification                      .  
Diagnosisamnesic:Taskgrammar               
Diagnosishuntingtons:Taskgrammar        ** 
Diagnosisamnesic:Taskclassification     .  
Diagnosishuntingtons:Taskclassification ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.56 on 36 degrees of freedom
Multiple R-squared:  0.7318,    Adjusted R-squared:  0.6722 
F-statistic: 12.28 on 8 and 36 DF,  p-value: 2.844e-08</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="co">#Compare models using anova</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mdl_add</span>, <span class="va">mdl_int</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Score ~ Diagnosis + Task
Model 2: Score ~ Diagnosis * Task
  Res.Df   RSS Df Sum of Sq      F    Pr(&gt;F)    
1     40 10680                                  
2     36  5680  4      5000 7.9225 0.0001092 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Use the <strong>stargazer</strong> package to create table (note, you can also use <code>tab_model()</code> if you prefer:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html">stargazer</a></span><span class="op">(</span><span class="va">mdl_add</span>, <span class="va">mdl_int</span>,</span>
<span>          title<span class="op">=</span><span class="st">"Regression Model Results for RQ1"</span>,</span>
<span>          dep.var.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Wellbeing Score"</span><span class="op">)</span>,</span>
<span>          covariate.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"Number of Social Interactions"</span><span class="op">)</span>, </span>
<span>          type <span class="op">=</span> <span class="st">"html"</span>, </span>
<span>          digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>          single.row<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>          align<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>          intercept.bottom <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>

<table style="text-align:center">
<caption>
<strong>Regression Model Results for RQ1</strong>
</caption>
<tbody><tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
Wellbeing Score
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Intercept
</td>
<td>
100.00<sup>***</sup> (5.45)
</td>
<td>
95.00<sup>***</sup> (5.62)
</td>
</tr>
<tr>
<td style="text-align:left">
Number of Social Interactions
</td>
<td>
-20.00<sup>***</sup> (5.97)
</td>
<td>
-30.00<sup>***</sup> (7.94)
</td>
</tr>
<tr>
<td style="text-align:left">
Diagnosishuntingtons
</td>
<td>
-25.00<sup>***</sup> (5.97)
</td>
<td>
0.00 (7.94)
</td>
</tr>
<tr>
<td style="text-align:left">
Taskgrammar
</td>
<td>
-25.00<sup>***</sup> (5.97)
</td>
<td>
-15.00<sup>*</sup> (7.94)
</td>
</tr>
<tr>
<td style="text-align:left">
Taskclassification
</td>
<td>
-20.00<sup>***</sup> (5.97)
</td>
<td>
-15.00<sup>*</sup> (7.94)
</td>
</tr>
<tr>
<td style="text-align:left">
Diagnosisamnesic:Taskgrammar
</td>
<td>
</td>
<td>
10.00 (11.23)
</td>
</tr>
<tr>
<td style="text-align:left">
Diagnosishuntingtons:Taskgrammar
</td>
<td>
</td>
<td>
-40.00<sup>***</sup> (11.23)
</td>
</tr>
<tr>
<td style="text-align:left">
Diagnosisamnesic:Taskclassification
</td>
<td>
</td>
<td>
20.00<sup>*</sup> (11.23)
</td>
</tr>
<tr>
<td style="text-align:left">
Diagnosishuntingtons:Taskclassification
</td>
<td>
</td>
<td>
-35.00<sup>***</sup> (11.23)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
45
</td>
<td>
45
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.50
</td>
<td>
0.73
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.45
</td>
<td>
0.67
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
16.34 (df = 40)
</td>
<td>
12.56 (df = 36)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
9.83<sup>***</sup> (df = 4; 40)
</td>
<td>
12.28<sup>***</sup> (df = 8; 36)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</tbody></table>
<div class="callout-important callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>We performed an <span class="math inline">\(F\)</span>-test to compare two nested models: an additive two-factor model against a two-factor model with interaction. The test results are <span class="math inline">\(F(4, 36) = 7.92, p &lt; .001\)</span>.</p>
<p>At the 5% significance level, the probability of obtaining an <span class="math inline">\(F\)</span>-statistic as large as 7.92 or larger is &lt;.001.</p>
<p>Hence, the comparison of nested models provided evidence against the additive effects model, suggesting that we should use the interaction model as each factor has a different effect on the response depending the level of the other factor.</p>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<section id="contrast-analysis" class="level2"><h2 class="anchored" data-anchor-id="contrast-analysis">Contrast analysis</h2>
<p>We will now begin by looking at each factor separately.</p>
<div class="question-begin">
Question 5
</div>
<div class="question-body">
<p>In terms of the diagnostic groups, we want to compare the amnesiacs to the Huntington individuals. This corresponds to a contrast with coefficients of 0, 1, and −1, for control, amnesic, and Huntingtons, respectively.</p>
<p>Similarly, in terms of the tasks, we want to compare the average of the two implicit memory tasks with the explicit memory task. This corresponds to a contrast with coefficients of 0.5, 0.5, and −1 for the three tasks.</p>
<p>When we are in presence of a significant interaction, the coefficients for a contrast between the means are found by multiplying each row coefficient with all column coefficients as shown below:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="images/contr_interaction.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Specify the contrast weights in <code>R</code>, and state the null hypothesis of your contrast analysis.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-7" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-7', 'sol-start-7')"> Solution </span>
</div>
<div id="sol-body-7" class="solution-body" style="display: none;">
<p>This can be done in <code>R</code> using:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Option 1</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Option 2</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">diag_coef</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'control'</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">'amnesic'</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">'huntingtons'</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">task_coef</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'grammar'</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">'classification'</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">'recognition'</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">contr_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">diag_coef</span>, <span class="va">task_coef</span><span class="op">)</span></span>
<span><span class="va">contr_coef</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            grammar classification recognition
control         0.0            0.0           0
amnesic         0.5            0.5          -1
huntingtons    -0.5           -0.5           1</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">diag_coef</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'control'</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">'amnesic'</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">'huntingtons'</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">task_coef</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'grammar'</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">'classification'</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">'recognition'</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">contr_coef</span> <span class="op">&lt;-</span> <span class="va">diag_coef</span> <span class="op"><a href="https://rdrr.io/r/base/outer.html">%o%</a></span> <span class="va">task_coef</span></span>
<span><span class="va">contr_coef</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            grammar classification recognition
control         0.0            0.0           0
amnesic         0.5            0.5          -1
huntingtons    -0.5           -0.5           1</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The above coefficients correspond to testing the null hypothesis</p>
<p><span class="math display">\[
H_0 : \frac{\mu_{2,1} + \mu_{2,2}}{2} - \mu_{2,3} - \left( \frac{\mu_{3,1} + \mu_{3,2}}{2} - \mu_{3,3} \right) = 0
\]</span></p>
<p>or, equivalently,</p>
<p><span class="math display">\[
H_0 : \frac{\mu_{2,1} + \mu_{2,2}}{2} - \mu_{2,3} = \frac{\mu_{3,1} + \mu_{3,2}}{2} - \mu_{3,3}
\]</span></p>
<p>which says that, in the population, the difference between the mean implicit memory and the explicit memory score is the same for amnesic patients and Huntingtons individuals. Note that the scores for the grammar and classification tasks have been averaged to obtain a single measure of ‘implicit memory’ score.</p>
</div>
<p class="solution-end">
</p>
<p><br></p>
<div class="question-begin">
Question 6
</div>
<div class="question-body">
<p>Run the contrast analysis, and interpret your output in the context of the research question.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-8" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-8', 'sol-start-8')"> Solution </span>
</div>
<div id="sol-body-8" class="solution-body" style="display: none;">
<p>Now that we have the coefficients, let’s firstly call the <code>emmeans</code> function (this is helpful to look at the ordering of the groups):</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">emm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mdl_int</span>, <span class="op">~</span> <span class="va">Diagnosis</span><span class="op">*</span><span class="va">Task</span><span class="op">)</span></span>
<span><span class="va">emm</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Diagnosis   Task           emmean   SE df lower.CL upper.CL
 control     recognition        95 5.62 36     83.6    106.4
 amnesic     recognition        65 5.62 36     53.6     76.4
 huntingtons recognition        95 5.62 36     83.6    106.4
 control     grammar            80 5.62 36     68.6     91.4
 amnesic     grammar            60 5.62 36     48.6     71.4
 huntingtons grammar            40 5.62 36     28.6     51.4
 control     classification     80 5.62 36     68.6     91.4
 amnesic     classification     70 5.62 36     58.6     81.4
 huntingtons classification     45 5.62 36     33.6     56.4

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Next, from <code>contr_coef</code>, insert the coefficients <strong>following the order specified by the rows of</strong> <code>emm</code> above. That is, the first one should be for <code>control</code> <code>recognition</code> and have a value of 0, the second for <code>amnesic</code> <code>recognition</code> with a value of -1, and so on…</p>
<p>We also give a name to this contrast, such as ‘Research Hyp’.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">comp_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/contrast.html">contrast</a></span><span class="op">(</span><span class="va">emm</span>, </span>
<span>                     method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'Research Hyp'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span>                     <span class="op">)</span></span></code></pre></div>
</div>
<p>Next, let’s look at the output via one of two ways:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Option 1</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Option 2</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">comp_res</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast     estimate   SE df t.ratio p.value
 Research Hyp     52.5 9.73 36   5.396  &lt;.0001</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">comp_res</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast     estimate   SE df lower.CL upper.CL
 Research Hyp     52.5 9.73 36     32.8     72.2

Confidence level used: 0.95 </code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">comp_res</span>, infer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast     estimate   SE df lower.CL upper.CL t.ratio p.value
 Research Hyp     52.5 9.73 36     32.8     72.2   5.396  &lt;.0001

Confidence level used: 0.95 </code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout-important callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>The contrast analysis yielded a <span class="math inline">\(t\)</span>-value of 5.4 and a corresponding <span class="math inline">\(p\)</span>-value &lt; .001. Thus, there is evidence that the contrast is not zero in the population. In other words, Amnesics and Huntingtons patients differ in the difference between implicit and explicit recognition memory tasks.</p>
<p>The contrast analysis shows that the 95% confidence interval for our contrast stretches from 32.8 to 72.2. This interval does not contain zero. Thus, we can be 95% confident that the task difference is not the same for amnesiacs as for Huntingtons, and therefore can reject the null hypothesis that the difference in differences is equal to zero.</p>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
</section><section id="simple-effects" class="level2"><h2 class="anchored" data-anchor-id="simple-effects">Simple Effects</h2>
<p>By considering the simple effects<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, we can identify at which levels of the interacting condition we see different effects.</p>
<div class="question-begin">
Question 7
</div>
<div class="question-body">
<p>Examine the simple effects for Task at each level of Diagnosis; and then the simple effects for Diagnosis at each level of Task.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-9" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-9', 'sol-start-9')"> Solution </span>
</div>
<div id="sol-body-9" class="solution-body" style="display: none;">
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">mdl_int_simple1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">emm</span>, simple <span class="op">=</span> <span class="st">"Task"</span><span class="op">)</span></span>
<span><span class="va">mdl_int_simple1</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Diagnosis = control:
 contrast                     estimate   SE df t.ratio p.value
 recognition - grammar              15 7.94 36   1.888  0.1567
 recognition - classification       15 7.94 36   1.888  0.1567
 grammar - classification            0 7.94 36   0.000  1.0000

Diagnosis = amnesic:
 contrast                     estimate   SE df t.ratio p.value
 recognition - grammar               5 7.94 36   0.629  0.8050
 recognition - classification       -5 7.94 36  -0.629  0.8050
 grammar - classification          -10 7.94 36  -1.259  0.4273

Diagnosis = huntingtons:
 contrast                     estimate   SE df t.ratio p.value
 recognition - grammar              55 7.94 36   6.923  &lt;.0001
 recognition - classification       50 7.94 36   6.294  &lt;.0001
 grammar - classification           -5 7.94 36  -0.629  0.8050

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">mdl_int_simple2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">emm</span>, simple <span class="op">=</span> <span class="st">"Diagnosis"</span><span class="op">)</span></span>
<span><span class="va">mdl_int_simple2</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Task = recognition:
 contrast              estimate   SE df t.ratio p.value
 control - amnesic           30 7.94 36   3.776  0.0016
 control - huntingtons        0 7.94 36   0.000  1.0000
 amnesic - huntingtons      -30 7.94 36  -3.776  0.0016

Task = grammar:
 contrast              estimate   SE df t.ratio p.value
 control - amnesic           20 7.94 36   2.518  0.0424
 control - huntingtons       40 7.94 36   5.035  &lt;.0001
 amnesic - huntingtons       20 7.94 36   2.518  0.0424

Task = classification:
 contrast              estimate   SE df t.ratio p.value
 control - amnesic           10 7.94 36   1.259  0.4273
 control - huntingtons       35 7.94 36   4.406  0.0003
 amnesic - huntingtons       25 7.94 36   3.147  0.0091

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>From <code>mdl_int_simple1</code> we can see the differences between between tasks for each diagnosis group, and from <code>mdl_int_simple2</code> the differences between diagnoses for each task group.</p>
</div>
<p class="solution-end">
</p>
<p><br></p>
<div class="question-begin">
Question 8
</div>
<div class="question-body">
<p>Visualise the interaction, displaying two plots - one with Diagnosis on the x-axis, and the other with Task on the x-axis.</p>
<p>Considering the simple effects that we noted above, identify the significant effects and match them to the parts of your interaction plot.</p>
<div class="callout-tip callout callout-style-simple callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To visualise the interaction, you can use <code><a href="https://rdrr.io/pkg/emmeans/man/emmip.html">emmip()</a></code>.</p>
<p>Recall that the <strong>patchwork</strong> package allows us to arrange multiple plots using either <code>/</code> or <code>|</code> or <code>+</code></p>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-10" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-10', 'sol-start-10')"> Solution </span>
</div>
<div id="sol-body-10" class="solution-body" style="display: none;">
<p>First create our plots:</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">plt_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmip.html">emmip</a></span><span class="op">(</span><span class="va">mdl_int</span>, <span class="va">Diagnosis</span> <span class="op">~</span> <span class="va">Task</span>, CIs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">plt_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmip.html">emmip</a></span><span class="op">(</span><span class="va">mdl_int</span>, <span class="va">Task</span> <span class="op">~</span> <span class="va">Diagnosis</span>, CIs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">plt_1</span> <span class="op">/</span> <span class="va">plt_2</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="2_04_emmeans_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Simple Effects of Task</li>
</ul>
<p>For the simple effects of task (see <code>plt_1</code>), we saw the significant differences (those for which <span class="math inline">\(p&lt;.05\)</span>):</p>
<ul>
<li><p>Only in the Huntingtons group, between recognition &amp; grammar and recognition &amp; classification tasks (top plot: left-most blue point compared to the middle blue point, and then compared to the right-most blue point)</p></li>
<li><p>Simple Effects of Diagnosis</p></li>
</ul>
<p>For the simple effects of Diagnosis (see <code>plt_2</code>), we saw significant differences:</p>
<ul>
<li>in the recognition task, between control &amp; amnesic<br>
(bottom plot: left-most red point to middle red-point)<br>
</li>
<li>in the recognition task, between amnesic &amp; huntingtons<br>
(bottom plot: middle red-point to right-most red point)<br>
</li>
<li>in the grammar task, between control &amp; huntingtons<br>
(bottom plot: left-most green point to right-most green point)</li>
<li>in the classification task, between control &amp; huntingtons<br>
(bottom plot: left-most blue point to right-most blue point)</li>
</ul>
</div>
<p class="solution-end">
</p>
</section><section id="pairwise-comparisons-multiple-corrections" class="level2"><h2 class="anchored" data-anchor-id="pairwise-comparisons-multiple-corrections">Pairwise Comparisons &amp; Multiple Corrections</h2>
<div class="question-begin">
Question 9
</div>
<div class="question-body">
<p>Conduct exploratory pairwise comparisons to compare all levels of Diagnosis with all levels of Task, applying no correction (note that Tukey will be automatically applied since we are comparing groups of means, so you will need to overwrite this).</p>
<p>Without adjusting our <span class="math inline">\(\alpha\)</span> (or <span class="math inline">\(p\)</span>-value), why might any inferences drawn from your output be problematic?</p>
<div class="callout-tip callout callout-style-simple callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You can specify the adjustment using <code>adjust = "</code>. Possible options include:</p>
<ul>
<li><code>adjust = "none"</code></li>
<li><code>adjust =  "bonferroni"</code></li>
<li><code>adjust = "sidak"</code></li>
<li><code>adjust = "Tukey"</code></li>
<li><code>adjust = scheffe"</code></li>
</ul>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-11" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-11', 'sol-start-11')"> Solution </span>
</div>
<div id="sol-body-11" class="solution-body" style="display: none;">
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="va">pairs_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">emm</span>, adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">pairs_res</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                                             estimate   SE df t.ratio
 control recognition - amnesic recognition                  30 7.94 36   3.776
 control recognition - huntingtons recognition               0 7.94 36   0.000
 control recognition - control grammar                      15 7.94 36   1.888
 control recognition - amnesic grammar                      35 7.94 36   4.406
 control recognition - huntingtons grammar                  55 7.94 36   6.923
 control recognition - control classification               15 7.94 36   1.888
 control recognition - amnesic classification               25 7.94 36   3.147
 control recognition - huntingtons classification           50 7.94 36   6.294
 amnesic recognition - huntingtons recognition             -30 7.94 36  -3.776
 amnesic recognition - control grammar                     -15 7.94 36  -1.888
 amnesic recognition - amnesic grammar                       5 7.94 36   0.629
 amnesic recognition - huntingtons grammar                  25 7.94 36   3.147
 amnesic recognition - control classification              -15 7.94 36  -1.888
 amnesic recognition - amnesic classification               -5 7.94 36  -0.629
 amnesic recognition - huntingtons classification           20 7.94 36   2.518
 huntingtons recognition - control grammar                  15 7.94 36   1.888
 huntingtons recognition - amnesic grammar                  35 7.94 36   4.406
 huntingtons recognition - huntingtons grammar              55 7.94 36   6.923
 huntingtons recognition - control classification           15 7.94 36   1.888
 huntingtons recognition - amnesic classification           25 7.94 36   3.147
 huntingtons recognition - huntingtons classification       50 7.94 36   6.294
 control grammar - amnesic grammar                          20 7.94 36   2.518
 control grammar - huntingtons grammar                      40 7.94 36   5.035
 control grammar - control classification                    0 7.94 36   0.000
 control grammar - amnesic classification                   10 7.94 36   1.259
 control grammar - huntingtons classification               35 7.94 36   4.406
 amnesic grammar - huntingtons grammar                      20 7.94 36   2.518
 amnesic grammar - control classification                  -20 7.94 36  -2.518
 amnesic grammar - amnesic classification                  -10 7.94 36  -1.259
 amnesic grammar - huntingtons classification               15 7.94 36   1.888
 huntingtons grammar - control classification              -40 7.94 36  -5.035
 huntingtons grammar - amnesic classification              -30 7.94 36  -3.776
 huntingtons grammar - huntingtons classification           -5 7.94 36  -0.629
 control classification - amnesic classification            10 7.94 36   1.259
 control classification - huntingtons classification        35 7.94 36   4.406
 amnesic classification - huntingtons classification        25 7.94 36   3.147
 p.value
  0.0006
  1.0000
  0.0671
  0.0001
  &lt;.0001
  0.0671
  0.0033
  &lt;.0001
  0.0006
  0.0671
  0.5331
  0.0033
  0.0671
  0.5331
  0.0164
  0.0671
  0.0001
  &lt;.0001
  0.0671
  0.0033
  &lt;.0001
  0.0164
  &lt;.0001
  1.0000
  0.2162
  0.0001
  0.0164
  0.0164
  0.2162
  0.0671
  &lt;.0001
  0.0006
  0.5331
  0.2162
  0.0001
  0.0033</code></pre>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="co">#can also plot if you'd like:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pairs_res</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="2_04_emmeans_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above, we can see comparisons for all different possible pairs of diagnosis-task combinations.</p>
<p>In total, there are 9 different estimates, but comparing them all means that we have 36 comparisons being tested! By not adjusting our <span class="math inline">\(p\)</span>-value, we are increasing the experimentwise Type I error rate - we could wrongly reject the null hypothesis at a much higher rate than 5/100 (or 1/20 as is assumed when <span class="math inline">\(\alpha = .05\)</span>). To overcome this, we might adjust and determine a result to be statistically significant if <span class="math inline">\(p &lt; .005\)</span>, as opposed to <span class="math inline">\(p &lt; .05\)</span>, depending on how many tests are in our family of tests).</p>
</div>
<p class="solution-end">
</p>
<p><br></p>
<div class="question-begin">
Question 10
</div>
<div class="question-body">
<p>Select an appropriate method to adjust for multiple comparisons, and then obtain confidence intervals.</p>
<p>Comment on how these <span class="math inline">\(p\)</span>-values differ from your raw (i.e., unadjusted) <span class="math inline">\(p\)</span>-values.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-12" class="fa-solid fa-circle-arrow-right solution-icon clickable" onclick="toggle_visibility('sol-body-12', 'sol-start-12')"> Solution </span>
</div>
<div id="sol-body-12" class="solution-body" style="display: none;">
<p>Note what the functions in <code>R</code> do is adjust the <span class="math inline">\(p\)</span>-value, rather than the <span class="math inline">\(\alpha\)</span>.</p>
<p>Since we’re interested in all pairwise comparisons of means, the Tukey adjustment might be a sensible approach. However, we’ll also show the Bonferroni to show how it differs (note, in practice you would only apply one correction and justify this choice based on your design - we are only applying two to note how they differ!)</p>
<p>Let’s start with Tukey:</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/contrast.html">contrast</a></span><span class="op">(</span><span class="va">emm</span>, method <span class="op">=</span> <span class="st">"pairwise"</span>, adjust<span class="op">=</span><span class="st">"Tukey"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                                             estimate   SE df t.ratio
 control recognition - amnesic recognition                  30 7.94 36   3.776
 control recognition - huntingtons recognition               0 7.94 36   0.000
 control recognition - control grammar                      15 7.94 36   1.888
 control recognition - amnesic grammar                      35 7.94 36   4.406
 control recognition - huntingtons grammar                  55 7.94 36   6.923
 control recognition - control classification               15 7.94 36   1.888
 control recognition - amnesic classification               25 7.94 36   3.147
 control recognition - huntingtons classification           50 7.94 36   6.294
 amnesic recognition - huntingtons recognition             -30 7.94 36  -3.776
 amnesic recognition - control grammar                     -15 7.94 36  -1.888
 amnesic recognition - amnesic grammar                       5 7.94 36   0.629
 amnesic recognition - huntingtons grammar                  25 7.94 36   3.147
 amnesic recognition - control classification              -15 7.94 36  -1.888
 amnesic recognition - amnesic classification               -5 7.94 36  -0.629
 amnesic recognition - huntingtons classification           20 7.94 36   2.518
 huntingtons recognition - control grammar                  15 7.94 36   1.888
 huntingtons recognition - amnesic grammar                  35 7.94 36   4.406
 huntingtons recognition - huntingtons grammar              55 7.94 36   6.923
 huntingtons recognition - control classification           15 7.94 36   1.888
 huntingtons recognition - amnesic classification           25 7.94 36   3.147
 huntingtons recognition - huntingtons classification       50 7.94 36   6.294
 control grammar - amnesic grammar                          20 7.94 36   2.518
 control grammar - huntingtons grammar                      40 7.94 36   5.035
 control grammar - control classification                    0 7.94 36   0.000
 control grammar - amnesic classification                   10 7.94 36   1.259
 control grammar - huntingtons classification               35 7.94 36   4.406
 amnesic grammar - huntingtons grammar                      20 7.94 36   2.518
 amnesic grammar - control classification                  -20 7.94 36  -2.518
 amnesic grammar - amnesic classification                  -10 7.94 36  -1.259
 amnesic grammar - huntingtons classification               15 7.94 36   1.888
 huntingtons grammar - control classification              -40 7.94 36  -5.035
 huntingtons grammar - amnesic classification              -30 7.94 36  -3.776
 huntingtons grammar - huntingtons classification           -5 7.94 36  -0.629
 control classification - amnesic classification            10 7.94 36   1.259
 control classification - huntingtons classification        35 7.94 36   4.406
 amnesic classification - huntingtons classification        25 7.94 36   3.147
 p.value
  0.0149
  1.0000
  0.6257
  0.0026
  &lt;.0001
  0.6257
  0.0711
  &lt;.0001
  0.0149
  0.6257
  0.9993
  0.0711
  0.6257
  0.9993
  0.2575
  0.6257
  0.0026
  &lt;.0001
  0.6257
  0.0711
  &lt;.0001
  0.2575
  0.0004
  1.0000
  0.9367
  0.0026
  0.2575
  0.2575
  0.9367
  0.6257
  0.0004
  0.0149
  0.9993
  0.9367
  0.0026
  0.0711

P value adjustment: tukey method for comparing a family of 9 estimates </code></pre>
</div>
</div>
<p>Note that 8 of the comparisons are no longer significant when using Tukey’s adjustment, suggesting that these might have (when using no adjustment) been Type I errors!</p>
<p>Next, lets look at Bonferroni:</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/contrast.html">contrast</a></span><span class="op">(</span><span class="va">emm</span>, method <span class="op">=</span> <span class="st">"pairwise"</span>, adjust<span class="op">=</span><span class="st">"bonferroni"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                                             estimate   SE df t.ratio
 control recognition - amnesic recognition                  30 7.94 36   3.776
 control recognition - huntingtons recognition               0 7.94 36   0.000
 control recognition - control grammar                      15 7.94 36   1.888
 control recognition - amnesic grammar                      35 7.94 36   4.406
 control recognition - huntingtons grammar                  55 7.94 36   6.923
 control recognition - control classification               15 7.94 36   1.888
 control recognition - amnesic classification               25 7.94 36   3.147
 control recognition - huntingtons classification           50 7.94 36   6.294
 amnesic recognition - huntingtons recognition             -30 7.94 36  -3.776
 amnesic recognition - control grammar                     -15 7.94 36  -1.888
 amnesic recognition - amnesic grammar                       5 7.94 36   0.629
 amnesic recognition - huntingtons grammar                  25 7.94 36   3.147
 amnesic recognition - control classification              -15 7.94 36  -1.888
 amnesic recognition - amnesic classification               -5 7.94 36  -0.629
 amnesic recognition - huntingtons classification           20 7.94 36   2.518
 huntingtons recognition - control grammar                  15 7.94 36   1.888
 huntingtons recognition - amnesic grammar                  35 7.94 36   4.406
 huntingtons recognition - huntingtons grammar              55 7.94 36   6.923
 huntingtons recognition - control classification           15 7.94 36   1.888
 huntingtons recognition - amnesic classification           25 7.94 36   3.147
 huntingtons recognition - huntingtons classification       50 7.94 36   6.294
 control grammar - amnesic grammar                          20 7.94 36   2.518
 control grammar - huntingtons grammar                      40 7.94 36   5.035
 control grammar - control classification                    0 7.94 36   0.000
 control grammar - amnesic classification                   10 7.94 36   1.259
 control grammar - huntingtons classification               35 7.94 36   4.406
 amnesic grammar - huntingtons grammar                      20 7.94 36   2.518
 amnesic grammar - control classification                  -20 7.94 36  -2.518
 amnesic grammar - amnesic classification                  -10 7.94 36  -1.259
 amnesic grammar - huntingtons classification               15 7.94 36   1.888
 huntingtons grammar - control classification              -40 7.94 36  -5.035
 huntingtons grammar - amnesic classification              -30 7.94 36  -3.776
 huntingtons grammar - huntingtons classification           -5 7.94 36  -0.629
 control classification - amnesic classification            10 7.94 36   1.259
 control classification - huntingtons classification        35 7.94 36   4.406
 amnesic classification - huntingtons classification        25 7.94 36   3.147
 p.value
  0.0207
  1.0000
  1.0000
  0.0033
  &lt;.0001
  1.0000
  0.1190
  &lt;.0001
  0.0207
  1.0000
  1.0000
  0.1190
  1.0000
  1.0000
  0.5907
  1.0000
  0.0033
  &lt;.0001
  1.0000
  0.1190
  &lt;.0001
  0.5907
  0.0005
  1.0000
  1.0000
  0.0033
  0.5907
  0.5907
  1.0000
  1.0000
  0.0005
  0.0207
  1.0000
  1.0000
  0.0033
  0.1190

P value adjustment: bonferroni method for 36 tests </code></pre>
</div>
</div>
<p>The first Bonferroni adjusted <span class="math inline">\(p\)</span>-value is 0.0207. The raw (unadjusted) <span class="math inline">\(p\)</span>-value from the previous question was 0.0005759265. The Bonferroni method simply multiplies the ‘raw’ <span class="math inline">\(p\)</span>-value by the number of the tests, which we know is 36.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r"><code class="sourceCode R"><span><span class="fl">0.0005759265</span> <span class="op">*</span> <span class="fl">36</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02073335</code></pre>
</div>
</div>
<p>In terms of differences in Bonferroni to raw <span class="math inline">\(p\)</span>-values, they are thus 36 times the size.</p>
<p>One benefit of Bonferroni is that it can be applied to any set of <span class="math inline">\(p\)</span>-values, whereas Tukey only applies when comparing the means of levels of a factor. The downside, however, is that it may be overly conservative (i.e.&nbsp;reduce our power to detect an effect that is truly there).</p>
</div>
<p class="solution-end">
</p>


</section></section><div id="quarto-appendix" class="default"><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1" role="doc-endnote"><p>simple effects are the effects of one variable <em>at a specific level of another variable</em><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
      <div class="nav-footer-center">© Copyright 2019-2022 <a href="https://www.ed.ac.uk/">The University of Edinburgh</a>. Site licensed under the <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">GNU AGPLv3</a> license.</div>
  </div>
</footer>


</body></html>